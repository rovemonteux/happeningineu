-#   Copyright (c) 2010-2011, Diaspora Inc.  This file is
-#   licensed under the Affero General Public License version 3 or later.  See
-#   the COPYRIGHT file.

- if user_signed_in?
  #global_search
    = form_tag(people_path, :method => 'get') do
      = text_field_tag 'q', params[:q], :placeholder => t('find_people'), :type => 'search', :results => 10, :style => "border-style: dotted; border-width: 1px; transition: all 0.25s ease-in-out; -webkit-transition: all 0.25s ease-in-out; -moz-transition: all 0.25s ease-in-out; margin-top: 5px; width: 150px; font-family: Arial, sans-serif; font-size: 10px; -webkit-border-radius: 1em; -moz-border-radius: 1em; border-radius: 1em;"
  %br

%ul.left_nav
  %li
    %b=link_to t('tags.show.follow', :tag => 'trends'), tag_followings_path, :class => 'home_selector'

    %ul.sub_nav
      - ActiveRecord::Base.connection.select_values('select name, count(name) as counter from tags LEFT JOIN taggings ON taggings.tag_id = tags.id WHERE created_at > DATE_SUB(CONCAT(CURDATE(), \' 00:00:00\'), INTERVAL 8 HOUR) GROUP BY name ORDER BY counter DESC, name ASC LIMIT 0,30').each do |tagname|
        %li
          = link_to "#"+"#{tagname}", tag_path(:name => tagname), :class => "tag_selector"

- if user_signed_in?
  %ul.left_nav
    %li
      %b=link_to t('streams.followed_tag.title'), tag_followings_path, :class => 'home_selector'

      %ul.sub_nav
        - if tags.size > 0
          - for tg in tags
            %li.unfollow{:id => "tag-following-#{tg.name}"}
              .unfollow_icon.hidden
                = link_to image_tag("icons/monotone_close_exit_delete.png", :height => 16, :title => t('aspects.index.unfollow_tag', :tag => tg.name)), tag_tag_followings_path(:name => tg.name, :remote => true), :confirm => t('are_you_sure'), :method => :delete, :remote => true, :id => "unfollow_" + tg.name
              = link_to "##{tg.name}", tag_path(:name => tg.name), :class => "tag_selector"
        %li
          = form_for TagFollowing.new do |tg|
            = text_field_tag :name, "", :class => "tag_input", :placeholder => t('streams.followed_tag.add_a_tag'),  :style => "border-style: dotted; border-width: 1px; transition: all 0.25s ease-in-out; -webkit-transition: all 0.25s ease-in-out; -moz-transition: all 0.25s ease-in-out; margin-top: 5px; width: 150px; font-family: Arial, sans-serif; font-size: 10px; -webkit-border-radius: 1em; -moz-border-radius: 1em; border-radius: 1em;"
            = tg.submit t('streams.followed_tag.follow'), :class => "button hidden"
