/*!
 * Rails 3 Client Side Validations - v3.1.0
 * https://github.com/bcardarlela/client_side_validations
 *
 * Copyright (c) 2011 Brian Cardarella
 * Licensed under the MIT license
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(c){c.fn.validate=function(){return this.filter("form[data-validate]").each(function(){var g=c(this);var f=window[g.attr("id")];g.submit(function(){return g.isValid(f.validators)}).bind("ajax:beforeSend",function(){return g.isValid(f.validators)}).bind("form:validate:after",function(h){clientSideValidations.callbacks.form.after(g,h)}).bind("form:validate:before",function(h){clientSideValidations.callbacks.form.before(g,h)}).bind("form:validate:fail",function(h){clientSideValidations.callbacks.form.fail(g,h)}).bind("form:validate:pass",function(h){clientSideValidations.callbacks.form.pass(g,h)}).find("[data-validate]:input:not(:radio)").live("focusout",function(){c(this).isValid(f.validators)}).live("change",function(){c(this).data("changed",true)}).live("element:validate:after",function(h){clientSideValidations.callbacks.element.after(c(this),h)}).live("element:validate:before",function(h){clientSideValidations.callbacks.element.before(c(this),h)}).live("element:validate:fail",function(j,i){var h=c(this);clientSideValidations.callbacks.element.fail(h,i,function(){d(h,i)},j)}).live("element:validate:pass",function(i){var h=c(this);clientSideValidations.callbacks.element.pass(h,function(){e(h)},i)}).end().find("[data-validate]:checkbox").live("click",function(){c(this).isValid(f.validators)}).end().find("[id*=_confirmation]").each(function(){var i=c(this),h=g.find("#"+this.id.match(/(.+)_confirmation/)[1]+"[data-validate]:input");if(h[0]){c("#"+i.attr("id")).live("focusout",function(){h.data("changed",true).isValid(f.validators)}).live("keyup",function(){h.data("changed",true).isValid(f.validators)})}});var d=function(h,i){clientSideValidations.formBuilders[f.type].add(h,f,i)};var e=function(h){clientSideValidations.formBuilders[f.type].remove(h,f)}})};c.fn.isValid=function(d){if(c(this[0]).is("form")){return b(c(this[0]),d)}else{return a(c(this[0]),d[this[0].name])}};var b=function(f,d){var e=true;f.trigger("form:validate:before").find("[data-validate]:input").each(function(){if(!c(this).isValid(d)){e=false}});if(e){f.trigger("form:validate:pass")}else{f.trigger("form:validate:fail")}f.trigger("form:validate:after");return e};var a=function(e,d){e.trigger("element:validate:before");if(e.data("changed")!==false){var f=true;e.data("changed",false);for(kind in clientSideValidations.validators.all()){if(d[kind]&&(message=clientSideValidations.validators.all()[kind](e,d[kind]))){e.trigger("element:validate:fail",message).data("valid",false);f=false;break}}if(f){e.data("valid",null);e.trigger("element:validate:pass")}}e.trigger("element:validate:after");return e.data("valid")===false?false:true};c(function(){c("form[data-validate]").validate()})})(jQuery);var clientSideValidations={validators:{all:function(){return jQuery.extend({},clientSideValidations.validators.local,clientSideValidations.validators.remote)},local:{presence:function(b,a){if(/^\s*$/.test(b.val()||"")){return a.message}},acceptance:function(b,a){switch(b.attr("type")){case"checkbox":if(!b.attr("checked")){return a.message}break;case"text":if(b.val()!=(a.accept||"1")){return a.message}break}},format:function(b,a){if((message=this.presence(b,a))&&a.allow_blank==true){return}else{if(message){return message}else{if(a["with"]&&!a["with"].test(b.val())){return a.message}else{if(a.without&&a.without.test(b.val())){return a.message}}}}},numericality:function(d,c){if(!/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d*)?$/.test(d.val())){return c.messages.numericality}if(c.only_integer&&!/^\d+$/.test(d.val())){return c.messages.only_integer}var a={greater_than:">",greater_than_or_equal_to:">=",equal_to:"==",less_than:"<",less_than_or_equal_to:"<="};for(var b in a){if(c[b]!=undefined&&!(new Function("return "+d.val()+a[b]+c[b])())){return c.messages[b]}}if(c.odd&&!(parseInt(d.val())%2)){return c.messages.odd}if(c.even&&(parseInt(d.val())%2)){return c.messages.even}},length:function(e,d){var c={};if(d.is){c.message=d.messages.is}else{if(d.minimum){c.message=d.messages.minimum}}if((message=this.presence(e,c))&&d.allow_blank==true){return}else{if(message){return message}else{var a={is:"==",minimum:">=",maximum:"<="};var f=d.js_tokenizer||"split('')";var g=new Function("element","return (element.val()."+f+" || '').length;")(e);for(var b in a){if(d[b]&&!(new Function("return "+g+a[b]+d[b])())){return d.messages[b]}}}}},exclusion:function(d,b){if((message=this.presence(d,b))&&b.allow_blank==true){return}else{if(message){return message}else{if(b["in"]){for(var c=0;c<b["in"].length;c++){if(b["in"][c]==d.val()){return b.message}}}else{if(b.range){var a=b.range[0],e=b.range[1];if(d.val()>=a&&d.val()<=e){return b.message}}}}}},inclusion:function(d,b){if((message=this.presence(d,b))&&b.allow_blank==true){return}else{if(message){return message}else{if(b["in"]){for(var c=0;c<b["in"].length;c++){if(b["in"][c]==d.val()){return}}return b.message}else{if(b.range){var a=b.range[0],e=b.range[1];if(d.val()>=a&&d.val()<=e){return}else{return b.message}}}}}},confirmation:function(b,a){if(b.val()!=jQuery("#"+b.attr("id")+"_confirmation").val()){return a.message}}},remote:{uniqueness:function(c,b){var e={};e.case_sensitive=!!b.case_sensitive;if(b.id){e.id=b.id}if(b.scope){e.scope={};for(key in b.scope){var d=jQuery('[name="'+c.attr("name").replace(/\[\w+]$/,"["+key+']"]'));if(d[0]&&d.val()!=b.scope[key]){e.scope[key]=d.val();d.unbind("change."+c.id).bind("change."+c.id,function(){c.trigger("change");c.trigger("focusout")})}else{e.scope[key]=b.scope[key]}}}if(/_attributes]/.test(c.attr("name"))){var a=c.attr("name").match(/\[\w+_attributes]/g).pop().match(/\[(\w+)_attributes]/).pop();a+=/(\[\w+])$/.exec(c.attr("name"))[1]}else{var a=c.attr("name")}if(b["class"]){a=b["class"]+"["+a.split("[")[1]}e[a]=c.val();if(jQuery.ajax({url:"/validators/uniqueness",data:e,async:false}).status==200){return b.message}}}},formBuilders:{"ActionView::Helpers::FormBuilder":{add:function(c,d,e){if(c.data("valid")!==false&&jQuery('label.message[for="'+c.attr("id")+'"]')[0]==undefined){var a=jQuery(d.input_tag),f=jQuery(d.label_tag),b=jQuery('label[for="'+c.attr("id")+'"]:not(.message)');if(c.attr("autofocus")){c.attr("autofocus",false)}c.before(a);a.find("span#input_tag").replaceWith(c);a.find("label.message").attr("for",c.attr("id"));f.find("label.message").attr("for",c.attr("id"));b.replaceWith(f);f.find("label#label_tag").replaceWith(b)}jQuery('label.message[for="'+c.attr("id")+'"]').text(e)},remove:function(d,e){var a=jQuery(e.input_tag).attr("class"),b=d.closest("."+a),c=jQuery('label[for="'+d.attr("id")+'"]:not(.message)'),f=c.closest("."+a);if(b[0]){b.find("#"+d.attr("id")).detach();b.replaceWith(d);c.detach();f.replaceWith(c)}}},"SimpleForm::FormBuilder":{add:function(b,c,d){if(b.data("valid")!==false){var e=b.closest(c.wrapper_tag);e.addClass(c.wrapper_error_class);var a=$("<"+c.error_tag+' class="'+c.error_class+'">'+d+"</"+c.error_tag+">");e.append(a)}else{b.parent().find(c.error_tag+"."+c.error_class).text(d)}},remove:function(b,c){var d=b.closest(c.wrapper_tag+"."+c.wrapper_error_class);d.removeClass(c.wrapper_error_class);var a=d.find(c.error_tag+"."+c.error_class);a.remove()}},"Formtastic::FormBuilder":{add:function(b,c,d){if(b.data("valid")!==false){var e=b.closest("li");e.addClass("error");var a=$('<p class="'+c.inline_error_class+'">'+d+"</p>");e.append(a)}else{b.parent().find("p."+c.inline_error_class).text(d)}},remove:function(b,c){var d=b.closest("li.error");d.removeClass("error");var a=d.find("p."+c.inline_error_class);a.remove()}},"NestedForm::Builder":{add:function(a,b,c){clientSideValidations.formBuilders["ActionView::Helpers::FormBuilder"].add(a,b,c)},remove:function(a,b,c){clientSideValidations.formBuilders["ActionView::Helpers::FormBuilder"].remove(a,b,c)}}},callbacks:{element:{after:function(a,b){},before:function(a,b){},fail:function(b,d,a,c){a()},pass:function(a,b,c){b()}},form:{after:function(b,a){},before:function(b,a){},fail:function(b,a){},pass:function(b,a){}}}};$.fn.clearForm=function(){return this.each(function(){if($(this).is("form")){return $(":input",this).clearForm()}if($(this).hasClass("clear_on_submit")||$(this).is(":text")||$(this).is(":password")||$(this).is("textarea")){$(this).val("")}else{if($(this).is(":checkbox")||$(this).is(":radio")){$(this).attr("checked",false)}else{if($(this).is("select")){this.selectedIndex=-1}else{if($(this).attr("name")=="photos[]"){$(this).val("")}}}}$(this).blur()})};(function(d){function b(l){var k=d('meta[name="csrf-token"]').attr("content");if(k){l(function(m){m.setRequestHeader("X-CSRF-Token",k)})}}if(d().jquery=="1.5"){var e=d.ajaxSettings.xhr;d.ajaxSettings.xhr=function(){var k=e();b(function(l){var m=k.open;k.open=function(){m.apply(this,arguments);l(this)}});return k}}else{d(document).ajaxSend(function(k,l){b(function(m){m(l)})})}function c(n,k,m){var l=new d.Event(k);n.trigger(l,m);return l.result!==false}function j(n){var p,l,o,k=n.attr("data-type")||(d.ajaxSettings&&d.ajaxSettings.dataType);if(n.is("form")){p=n.attr("method");l=n.attr("action");o=n.serializeArray();var m=n.data("ujs:submit-button");if(m){o.push(m);n.data("ujs:submit-button",null)}}else{p=n.attr("data-method");l=n.attr("href");o=null}d.ajax({url:l,type:p||"GET",data:o,dataType:k,beforeSend:function(r,q){if(q.dataType===undefined){r.setRequestHeader("accept","*/*;q=0.5, "+q.accepts.script)}return c(n,"ajax:beforeSend",[r,q])},success:function(r,q,s){n.trigger("ajax:success",[r,q,s])},complete:function(r,q){n.trigger("ajax:complete",[r,q])},error:function(s,q,r){n.trigger("ajax:error",[s,q,r])}})}function g(q){var l=q.attr("href"),k=q.attr("data-method"),s=d("meta[name=csrf-token]").attr("content"),r=d("meta[name=csrf-param]").attr("content"),m=d('<form method="post" action="'+l+'"></form>'),p='<input name="_method" value="'+k+'" type="hidden" />',o=q.data("form-params");if(r!==undefined&&s!==undefined){p+='<input name="'+r+'" value="'+s+'" type="hidden" />'}if(o!=undefined){var n=d.parseJSON(o);for(key in n){m.append(d("<input>").attr({type:"hidden",name:key,value:n[key]}))}}m.hide().append(p).appendTo("body");m.submit()}function h(k){k.find("input[data-disable-with]").each(function(){var l=d(this);l.data("ujs:enable-with",l.val()).val(l.attr("data-disable-with")).attr("disabled","disabled")})}function a(k){k.find("input[data-disable-with]").each(function(){var l=d(this);l.val(l.data("ujs:enable-with")).removeAttr("disabled")})}function i(k){var l=k.attr("data-confirm");return !l||(c(k,"confirm")&&confirm(l))}function f(l){var k=false;l.find("input[name][required]").each(function(){if(!d(this).val()){k=true}});return k}d("a[data-confirm], a[data-method], a[data-remote]").live("click.rails",function(l){var k=d(this);if(!i(k)){return false}if(k.attr("data-remote")!=undefined){j(k);return false}else{if(k.attr("data-method")){g(k);return false}}});d("form").live("submit.rails",function(m){var k=d(this),l=k.attr("data-remote")!=undefined;if(!i(k)){return false}if(f(k)){return !l}if(l){j(k);return false}else{setTimeout(function(){h(k)},13)}});d("form input[type=submit], form button[type=submit], form button:not([type])").live("click.rails",function(){var l=d(this);if(!i(l)){return false}var k=l.attr("name"),m=k?{name:k,value:l.val()}:null;l.closest("form").data("ujs:submit-button",m)});d("form").live("ajax:beforeSend.rails",function(k){if(this==k.target){h(d(this))}});d("form").live("ajax:complete.rails",function(k){if(this==k.target){a(d(this))}})})(jQuery);(function(b){b.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};function a(d){if(typeof d.data!=="string"){return}var c=d.handler,e=d.data.toLowerCase().split(" ");d.handler=function(n){if(this!==n.target&&(/textarea|select/i.test(n.target.nodeName)||n.target.type==="text")){return}var h=n.type!=="keypress"&&b.hotkeys.specialKeys[n.which],o=String.fromCharCode(n.which).toLowerCase(),k,m="",g={};if(n.altKey&&h!=="alt"){m+="alt+"}if(n.ctrlKey&&h!=="ctrl"){m+="ctrl+"}if(n.metaKey&&!n.ctrlKey&&h!=="meta"){m+="meta+"}if(n.shiftKey&&h!=="shift"){m+="shift+"}if(h){g[m+h]=true}else{g[m+o]=true;g[m+b.hotkeys.shiftNums[o]]=true;if(m==="shift+"){g[b.hotkeys.shiftNums[o]]=true}}for(var j=0,f=e.length;j<f;j++){if(g[e[j]]){return c.apply(this,arguments)}}}}b.each(["keydown","keyup","keypress"],function(){b.event.special[this]={add:a}})})(jQuery);(function(b){b.fn.autoResize=function(c){var a=b.extend({onResize:function(){},animate:true,animateDuration:150,animateCallback:function(){},extraSpace:20,limit:1000},c);this.filter("textarea").each(function(){var l=b(this).css({resize:"none"}),d=l.height(),j=(function(){var f=["height","width","lineHeight","textDecoration","letterSpacing"],g={};b.each(f,function(k,i){g[i]=l.css(i)});return l.clone().removeAttr("id").removeAttr("name").css({position:"absolute",top:0,left:-9999}).css(g).attr("tabIndex","-1").insertBefore(l)})(),e=null,h=function(){j.height(0).val(b(this).val()).scrollTop(10000);var g=Math.max(j.scrollTop(),d)+a.extraSpace,f=b(this).add(j);if(e===g){return}e=g;if(g>=a.limit){return}a.onResize.call(this);a.animate&&l.css("display")==="block"?f.stop().animate({height:g},a.animateDuration,a.animateCallback):f.height(g)};l.unbind(".dynSiz").bind("keyup.dynSiz",h).bind("keydown.dynSiz",h).bind("change.dynSiz",h)});return this}})(jQuery);
/*!
 * jQuery UI 1.8.9
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
(function(d,b){function a(c){return !d(c).parents().andSelf().filter(function(){return d.curCSS(this,"visibility")==="hidden"||d.expr.filters.hidden(this)}).length}d.ui=d.ui||{};if(!d.ui.version){d.extend(d.ui,{version:"1.8.9",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});d.fn.extend({_focus:d.fn.focus,focus:function(e,c){return typeof e==="number"?this.each(function(){var f=this;setTimeout(function(){d(f).focus();c&&c.call(f)},e)}):this._focus.apply(this,arguments)},scrollParent:function(){var c;c=d.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(d.curCSS(this,"position",1))&&/(auto|scroll)/.test(d.curCSS(this,"overflow",1)+d.curCSS(this,"overflow-y",1)+d.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(d.curCSS(this,"overflow",1)+d.curCSS(this,"overflow-y",1)+d.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!c.length?d(document):c},zIndex:function(e){if(e!==b){return this.css("zIndex",e)}if(this.length){e=d(this[0]);for(var c;e.length&&e[0]!==document;){c=e.css("position");if(c==="absolute"||c==="relative"||c==="fixed"){c=parseInt(e.css("zIndex"),10);if(!isNaN(c)&&c!==0){return c}}e=e.parent()}}return 0},disableSelection:function(){return this.bind((d.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(c){c.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});d.each(["Width","Height"],function(f,c){function l(n,i,h,e){d.each(k,function(){i-=parseFloat(d.curCSS(n,"padding"+this,true))||0;if(h){i-=parseFloat(d.curCSS(n,"border"+this+"Width",true))||0}if(e){i-=parseFloat(d.curCSS(n,"margin"+this,true))||0}});return i}var k=c==="Width"?["Left","Right"]:["Top","Bottom"],j=c.toLowerCase(),g={innerWidth:d.fn.innerWidth,innerHeight:d.fn.innerHeight,outerWidth:d.fn.outerWidth,outerHeight:d.fn.outerHeight};d.fn["inner"+c]=function(e){if(e===b){return g["inner"+c].call(this)}return this.each(function(){d(this).css(j,l(this,e)+"px")})};d.fn["outer"+c]=function(h,e){if(typeof h!=="number"){return g["outer"+c].call(this,h)}return this.each(function(){d(this).css(j,l(this,h,true,e)+"px")})}});d.extend(d.expr[":"],{data:function(e,c,f){return !!d.data(e,f[3])},focusable:function(e){var c=e.nodeName.toLowerCase(),f=d.attr(e,"tabindex");if("area"===c){c=e.parentNode;f=c.name;if(!e.href||!f||c.nodeName.toLowerCase()!=="map"){return false}e=d("img[usemap=#"+f+"]")[0];return !!e&&a(e)}return(/input|select|textarea|button|object/.test(c)?!e.disabled:"a"==c?e.href||!isNaN(f):!isNaN(f))&&a(e)},tabbable:function(e){var c=d.attr(e,"tabindex");return(isNaN(c)||c>=0)&&d(e).is(":focusable")}});d(function(){var e=document.body,c=e.appendChild(c=document.createElement("div"));d.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});d.support.minHeight=c.offsetHeight===100;d.support.selectstart="onselectstart" in c;e.removeChild(c).style.display="none"});d.extend(d.ui,{plugin:{add:function(f,c,h){f=d.ui[f].prototype;for(var g in h){f.plugins[g]=f.plugins[g]||[];f.plugins[g].push([c,h[g]])}},call:function(f,c,h){if((c=f.plugins[c])&&f.element[0].parentNode){for(var g=0;g<c.length;g++){f.options[c[g][0]]&&c[g][1].apply(f.element,h)}}}},contains:function(e,c){return document.compareDocumentPosition?e.compareDocumentPosition(c)&16:e!==c&&e.contains(c)},hasScroll:function(e,c){if(d(e).css("overflow")==="hidden"){return false}c=c&&c==="left"?"scrollLeft":"scrollTop";var f=false;if(e[c]>0){return true}e[c]=1;f=e[c]>0;e[c]=0;return f},isOverAxis:function(e,c,f){return e>c&&e<c+f},isOver:function(f,c,l,k,j,g){return d.ui.isOverAxis(f,l,j)&&d.ui.isOverAxis(c,k,g)}})}})(jQuery);
/*!
 * jQuery UI Widget 1.8.9
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
(function(a,e){if(a.cleanData){var d=a.cleanData;a.cleanData=function(b){for(var g=0,f;(f=b[g])!=null;g++){a(f).triggerHandler("remove")}d(b)}}else{var c=a.fn.remove;a.fn.remove=function(b,f){return this.each(function(){if(!f){if(!b||a.filter(b,[this]).length){a("*",this).add([this]).each(function(){a(this).triggerHandler("remove")})}}return c.call(a(this),b,f)})}}a.widget=function(b,j,i){var h=b.split(".")[0],g;b=b.split(".")[1];g=h+"-"+b;if(!i){i=j;j=a.Widget}a.expr[":"][g]=function(f){return !!a.data(f,b)};a[h]=a[h]||{};a[h][b]=function(f,k){arguments.length&&this._createWidget(f,k)};j=new j;j.options=a.extend(true,{},j.options);a[h][b].prototype=a.extend(true,j,{namespace:h,widgetName:b,widgetEventPrefix:a[h][b].prototype.widgetEventPrefix||b,widgetBaseClass:g},i);a.widget.bridge(b,a[h][b])};a.widget.bridge=function(b,f){a.fn[b]=function(k){var j=typeof k==="string",i=Array.prototype.slice.call(arguments,1),g=this;k=!j&&i.length?a.extend.apply(null,[true,k].concat(i)):k;if(j&&k.charAt(0)==="_"){return g}j?this.each(function(){var l=a.data(this,b),h=l&&a.isFunction(l[k])?l[k].apply(l,i):l;if(h!==l&&h!==e){g=h;return false}}):this.each(function(){var h=a.data(this,b);h?h.option(k||{})._init():a.data(this,b,new f(k,this))});return g}};a.Widget=function(b,f){arguments.length&&this._createWidget(b,f)};a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(b,g){a.data(g,this.widgetName,this);this.element=a(g);this.options=a.extend(true,{},this.options,this._getCreateOptions(),b);var f=this;this.element.bind("remove."+this.widgetName,function(){f.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(b,g){var f=b;if(arguments.length===0){return a.extend({},this.options)}if(typeof b==="string"){if(g===e){return this.options[b]}f={};f[b]=g}this._setOptions(f);return this},_setOptions:function(b){var f=this;a.each(b,function(h,g){f._setOption(h,g)});return this},_setOption:function(b,f){this.options[b]=f;if(b==="disabled"){this.widget()[f?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",f)}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(b,j,i){var h=this.options[b];j=a.Event(j);j.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase();i=i||{};if(j.originalEvent){b=a.event.props.length;for(var g;b;){g=a.event.props[--b];j[g]=j.originalEvent[g]}}this.element.trigger(j,i);return !(a.isFunction(h)&&h.call(this.element[0],j,i)===false||j.isDefaultPrevented())}}})(jQuery);
/*!
 * jQuery UI Mouse 1.8.9
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *	jquery.ui.widget.js
 */
(function(a){a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(c){return b._mouseDown(c)}).bind("click."+this.widgetName,function(c){if(true===a.data(c.target,b.widgetName+".preventClickEvent")){a.removeData(c.target,b.widgetName+".preventClickEvent");c.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(d){d.originalEvent=d.originalEvent||{};if(!d.originalEvent.mouseHandled){this._mouseStarted&&this._mouseUp(d);this._mouseDownEvent=d;var c=this,h=d.which==1,g=typeof this.options.cancel=="string"?a(d.target).parents().add(d.target).filter(this.options.cancel).length:false;if(!h||g||!this._mouseCapture(d)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(d)&&this._mouseDelayMet(d)){this._mouseStarted=this._mouseStart(d)!==false;if(!this._mouseStarted){d.preventDefault();return true}}this._mouseMoveDelegate=function(b){return c._mouseMove(b)};this._mouseUpDelegate=function(b){return c._mouseUp(b)};a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);d.preventDefault();return d.originalEvent.mouseHandled=true}},_mouseMove:function(b){if(a.browser.msie&&!(document.documentMode>=9)&&!b.button){return this._mouseUp(b)}if(this._mouseStarted){this._mouseDrag(b);return b.preventDefault()}if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)){(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==false)?this._mouseDrag(b):this._mouseUp(b)}return !this._mouseStarted},_mouseUp:function(b){a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;b.target==this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",true);this._mouseStop(b)}return false},_mouseDistanceMet:function(b){return Math.max(Math.abs(this._mouseDownEvent.pageX-b.pageX),Math.abs(this._mouseDownEvent.pageY-b.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);(function(a){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))){this.element[0].style.position="relative"}this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this}},_mouseCapture:function(d){var c=this.options;if(this.helper||c.disabled||a(d.target).is(".ui-resizable-handle")){return false}this.handle=this._getHandle(d);if(!this.handle){return false}return true},_mouseStart:function(d){var c=this.options;this.helper=this._createHelper(d);this._cacheHelperProportions();if(a.ui.ddmanager){a.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:d.pageX-this.offset.left,top:d.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(d);this.originalPageX=d.pageX;this.originalPageY=d.pageY;c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt);c.containment&&this._setContainment();if(this._trigger("start",d)===false){this._clear();return false}this._cacheHelperProportions();a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,d);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(d,true);return true},_mouseDrag:function(d,c){this.position=this._generatePosition(d);this.positionAbs=this._convertPositionTo("absolute");if(!c){c=this._uiHash();if(this._trigger("drag",d,c)===false){this._mouseUp({});return false}this.position=c.position}if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}a.ui.ddmanager&&a.ui.ddmanager.drag(this,d);return false},_mouseStop:function(e){var d=false;if(a.ui.ddmanager&&!this.options.dropBehaviour){d=a.ui.ddmanager.drop(this,e)}if(this.dropped){d=this.dropped;this.dropped=false}if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original"){return false}if(this.options.revert=="invalid"&&!d||this.options.revert=="valid"&&d||this.options.revert===true||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)){var f=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){f._trigger("stop",e)!==false&&f._clear()})}else{this._trigger("stop",e)!==false&&this._clear()}return false},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(d){var c=!this.options.handle||!a(this.options.handle,this.element).length?true:false;a(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==d.target){c=true}});return c},_createHelper:function(d){var c=this.options;d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[d])):c.helper=="clone"?this.element.clone():this.element;d.parents("body").length||d.appendTo(c.appendTo=="parent"?this.element[0].parentNode:c.appendTo);d[0]!=this.element[0]&&!/(fixed|absolute)/.test(d.css("position"))&&d.css("position","absolute");return d},_adjustOffsetFromHelper:function(b){if(typeof b=="string"){b=b.split(" ")}if(a.isArray(b)){b={left:+b[0],top:+b[1]||0}}if("left" in b){this.offset.click.left=b.left+this.margins.left}if("right" in b){this.offset.click.left=this.helperProportions.width-b.right+this.margins.left}if("top" in b){this.offset.click.top=b.top+this.margins.top}if("bottom" in b){this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])){b.left+=this.scrollParent.scrollLeft();b.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie){b={top:0,left:0}}return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var b=this.element.position();return{top:b.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:b.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e=this.options;if(e.containment=="parent"){e.containment=this.helper[0].parentNode}if(e.containment=="document"||e.containment=="window"){this.containment=[(e.containment=="document"?0:a(window).scrollLeft())-this.offset.relative.left-this.offset.parent.left,(e.containment=="document"?0:a(window).scrollTop())-this.offset.relative.top-this.offset.parent.top,(e.containment=="document"?0:a(window).scrollLeft())+a(e.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(e.containment=="document"?0:a(window).scrollTop())+(a(e.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!/^(document|window|parent)$/.test(e.containment)&&e.containment.constructor!=Array){var d=a(e.containment)[0];if(d){e=a(e.containment).offset();var f=a(d).css("overflow")!="hidden";this.containment=[e.left+(parseInt(a(d).css("borderLeftWidth"),10)||0)+(parseInt(a(d).css("paddingLeft"),10)||0)-this.margins.left,e.top+(parseInt(a(d).css("borderTopWidth"),10)||0)+(parseInt(a(d).css("paddingTop"),10)||0)-this.margins.top,e.left+(f?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(a(d).css("borderLeftWidth"),10)||0)-(parseInt(a(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,e.top+(f?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(a(d).css("borderTopWidth"),10)||0)-(parseInt(a(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}}else{if(e.containment.constructor==Array){this.containment=e.containment}}},_convertPositionTo:function(e,d){if(!d){d=this.position}e=e=="absolute"?1:-1;var h=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(h[0].tagName);return{top:d.top+this.offset.relative.top*e+this.offset.parent.top*e-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:h.scrollTop())*e),left:d.left+this.offset.relative.left*e+this.offset.parent.left*e-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:h.scrollLeft())*e)}},_generatePosition:function(h){var d=this.options,l=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,j=/(html|body)/i.test(l[0].tagName),k=h.pageX,i=h.pageY;if(this.originalPosition){if(this.containment){if(h.pageX-this.offset.click.left<this.containment[0]){k=this.containment[0]+this.offset.click.left}if(h.pageY-this.offset.click.top<this.containment[1]){i=this.containment[1]+this.offset.click.top}if(h.pageX-this.offset.click.left>this.containment[2]){k=this.containment[2]+this.offset.click.left}if(h.pageY-this.offset.click.top>this.containment[3]){i=this.containment[3]+this.offset.click.top}}if(d.grid){i=this.originalPageY+Math.round((i-this.originalPageY)/d.grid[1])*d.grid[1];i=this.containment?!(i-this.offset.click.top<this.containment[1]||i-this.offset.click.top>this.containment[3])?i:!(i-this.offset.click.top<this.containment[1])?i-d.grid[1]:i+d.grid[1]:i;k=this.originalPageX+Math.round((k-this.originalPageX)/d.grid[0])*d.grid[0];k=this.containment?!(k-this.offset.click.left<this.containment[0]||k-this.offset.click.left>this.containment[2])?k:!(k-this.offset.click.left<this.containment[0])?k-d.grid[0]:k+d.grid[0]:k}}return{top:i-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():j?0:l.scrollTop()),left:k-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():j?0:l.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=false},_trigger:function(e,d,f){f=f||this._uiHash();a.ui.plugin.call(this,e,[d,f]);if(e=="drag"){this.positionAbs=this._convertPositionTo("absolute")}return a.Widget.prototype._trigger.call(this,e,d,f)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.extend(a.ui.draggable,{version:"1.8.9"});a.ui.plugin.add("draggable","connectToSortable",{start:function(g,d){var j=a(this).data("draggable"),h=j.options,i=a.extend({},d,{item:j.element});j.sortables=[];a(h.connectToSortable).each(function(){var b=a.data(this,"sortable");if(b&&!b.options.disabled){j.sortables.push({instance:b,shouldRevert:b.options.revert});b._refreshItems();b._trigger("activate",g,i)}})},stop:function(e,d){var h=a(this).data("draggable"),g=a.extend({},d,{item:h.element});a.each(h.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;h.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=true}this.instance._mouseStop(e);this.instance.options.helper=this.instance.options._helper;h.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",e,g)}})},drag:function(e,d){var h=a(this).data("draggable"),g=this;a.each(h.sortables,function(){this.instance.positionAbs=h.positionAbs;this.instance.helperProportions=h.helperProportions;this.instance.offset.click=h.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=a(g).clone().appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return d.helper[0]};e.target=this.instance.currentItem[0];this.instance._mouseCapture(e,true);this.instance._mouseStart(e,true,true);this.instance.offset.click.top=h.offset.click.top;this.instance.offset.click.left=h.offset.click.left;this.instance.offset.parent.left-=h.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=h.offset.parent.top-this.instance.offset.parent.top;h._trigger("toSortable",e);h.dropped=this.instance.element;h.currentItem=h.element;this.instance.fromOutside=h}this.instance.currentItem&&this.instance._mouseDrag(e)}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",e,this.instance._uiHash(this.instance));this.instance._mouseStop(e,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();this.instance.placeholder&&this.instance.placeholder.remove();h._trigger("fromSortable",e);h.dropped=false}}})}});a.ui.plugin.add("draggable","cursor",{start:function(){var d=a("body"),c=a(this).data("draggable").options;if(d.css("cursor")){c._cursor=d.css("cursor")}d.css("cursor",c.cursor)},stop:function(){var b=a(this).data("draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}});a.ui.plugin.add("draggable","iframeFix",{start:function(){var b=a(this).data("draggable").options;a(b.iframeFix===true?"iframe":b.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(a(this).offset()).appendTo("body")})},stop:function(){a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}});a.ui.plugin.add("draggable","opacity",{start:function(d,c){d=a(c.helper);c=a(this).data("draggable").options;if(d.css("opacity")){c._opacity=d.css("opacity")}d.css("opacity",c.opacity)},stop:function(d,c){d=a(this).data("draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}});a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("draggable");if(b.scrollParent[0]!=document&&b.scrollParent[0].tagName!="HTML"){b.overflowOffset=b.scrollParent.offset()}},drag:function(e){var d=a(this).data("draggable"),h=d.options,g=false;if(d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"){if(!h.axis||h.axis!="x"){if(d.overflowOffset.top+d.scrollParent[0].offsetHeight-e.pageY<h.scrollSensitivity){d.scrollParent[0].scrollTop=g=d.scrollParent[0].scrollTop+h.scrollSpeed}else{if(e.pageY-d.overflowOffset.top<h.scrollSensitivity){d.scrollParent[0].scrollTop=g=d.scrollParent[0].scrollTop-h.scrollSpeed}}}if(!h.axis||h.axis!="y"){if(d.overflowOffset.left+d.scrollParent[0].offsetWidth-e.pageX<h.scrollSensitivity){d.scrollParent[0].scrollLeft=g=d.scrollParent[0].scrollLeft+h.scrollSpeed}else{if(e.pageX-d.overflowOffset.left<h.scrollSensitivity){d.scrollParent[0].scrollLeft=g=d.scrollParent[0].scrollLeft-h.scrollSpeed}}}}else{if(!h.axis||h.axis!="x"){if(e.pageY-a(document).scrollTop()<h.scrollSensitivity){g=a(document).scrollTop(a(document).scrollTop()-h.scrollSpeed)}else{if(a(window).height()-(e.pageY-a(document).scrollTop())<h.scrollSensitivity){g=a(document).scrollTop(a(document).scrollTop()+h.scrollSpeed)}}}if(!h.axis||h.axis!="y"){if(e.pageX-a(document).scrollLeft()<h.scrollSensitivity){g=a(document).scrollLeft(a(document).scrollLeft()-h.scrollSpeed)}else{if(a(window).width()-(e.pageX-a(document).scrollLeft())<h.scrollSensitivity){g=a(document).scrollLeft(a(document).scrollLeft()+h.scrollSpeed)}}}}g!==false&&a.ui.ddmanager&&!h.dropBehaviour&&a.ui.ddmanager.prepareOffsets(d,e)}});a.ui.plugin.add("draggable","snap",{start:function(){var d=a(this).data("draggable"),c=d.options;d.snapElements=[];a(c.snap.constructor!=String?c.snap.items||":data(draggable)":c.snap).each(function(){var e=a(this),b=e.offset();this!=d.element[0]&&d.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:b.top,left:b.left})})},drag:function(L,K){for(var J=a(this).data("draggable"),H=J.options,I=H.snapTolerance,G=K.offset.left,z=G+J.helperProportions.width,A=K.offset.top,y=A+J.helperProportions.height,F=J.snapElements.length-1;F>=0;F--){var E=J.snapElements[F].left,C=E+J.snapElements[F].width,D=J.snapElements[F].top,B=D+J.snapElements[F].height;if(E-I<G&&G<C+I&&D-I<A&&A<B+I||E-I<G&&G<C+I&&D-I<y&&y<B+I||E-I<z&&z<C+I&&D-I<A&&A<B+I||E-I<z&&z<C+I&&D-I<y&&y<B+I){if(H.snapMode!="inner"){var x=Math.abs(D-y)<=I,w=Math.abs(B-A)<=I,v=Math.abs(E-z)<=I,u=Math.abs(C-G)<=I;if(x){K.position.top=J._convertPositionTo("relative",{top:D-J.helperProportions.height,left:0}).top-J.margins.top}if(w){K.position.top=J._convertPositionTo("relative",{top:B,left:0}).top-J.margins.top}if(v){K.position.left=J._convertPositionTo("relative",{top:0,left:E-J.helperProportions.width}).left-J.margins.left}if(u){K.position.left=J._convertPositionTo("relative",{top:0,left:C}).left-J.margins.left}}var d=x||w||v||u;if(H.snapMode!="outer"){x=Math.abs(D-A)<=I;w=Math.abs(B-y)<=I;v=Math.abs(E-G)<=I;u=Math.abs(C-z)<=I;if(x){K.position.top=J._convertPositionTo("relative",{top:D,left:0}).top-J.margins.top}if(w){K.position.top=J._convertPositionTo("relative",{top:B-J.helperProportions.height,left:0}).top-J.margins.top}if(v){K.position.left=J._convertPositionTo("relative",{top:0,left:E}).left-J.margins.left}if(u){K.position.left=J._convertPositionTo("relative",{top:0,left:C-J.helperProportions.width}).left-J.margins.left}}if(!J.snapElements[F].snapping&&(x||w||v||u||d)){J.options.snap.snap&&J.options.snap.snap.call(J.element,L,a.extend(J._uiHash(),{snapItem:J.snapElements[F].item}))}J.snapElements[F].snapping=x||w||v||u||d}else{J.snapElements[F].snapping&&J.options.snap.release&&J.options.snap.release.call(J.element,L,a.extend(J._uiHash(),{snapItem:J.snapElements[F].item}));J.snapElements[F].snapping=false}}}});a.ui.plugin.add("draggable","stack",{start:function(){var d=a(this).data("draggable").options;d=a.makeArray(a(d.stack)).sort(function(e,b){return(parseInt(a(e).css("zIndex"),10)||0)-(parseInt(a(b).css("zIndex"),10)||0)});if(d.length){var c=parseInt(d[0].style.zIndex)||0;a(d).each(function(b){this.style.zIndex=c+b});this[0].style.zIndex=c+d.length}}});a.ui.plugin.add("draggable","zIndex",{start:function(d,c){d=a(c.helper);c=a(this).data("draggable").options;if(d.css("zIndex")){c._zIndex=d.css("zIndex")}d.css("zIndex",c.zIndex)},stop:function(d,c){d=a(this).data("draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})})(jQuery);(function(a){a.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect"},_create:function(){var d=this.options,c=d.accept;this.isover=0;this.isout=1;this.accept=a.isFunction(c)?c:function(b){return b.is(c)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};a.ui.ddmanager.droppables[d.scope]=a.ui.ddmanager.droppables[d.scope]||[];a.ui.ddmanager.droppables[d.scope].push(this);d.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){for(var d=a.ui.ddmanager.droppables[this.options.scope],c=0;c<d.length;c++){d[c]==this&&d.splice(c,1)}this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(d,c){if(d=="accept"){this.accept=a.isFunction(c)?c:function(b){return b.is(c)}}a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(d){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass);c&&this._trigger("activate",d,this.ui(c))},_deactivate:function(d){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);c&&this._trigger("deactivate",d,this.ui(c))},_over:function(d){var c=a.ui.ddmanager.current;if(!(!c||(c.currentItem||c.element)[0]==this.element[0])){if(this.accept.call(this.element[0],c.currentItem||c.element)){this.options.hoverClass&&this.element.addClass(this.options.hoverClass);this._trigger("over",d,this.ui(c))}}},_out:function(d){var c=a.ui.ddmanager.current;if(!(!c||(c.currentItem||c.element)[0]==this.element[0])){if(this.accept.call(this.element[0],c.currentItem||c.element)){this.options.hoverClass&&this.element.removeClass(this.options.hoverClass);this._trigger("out",d,this.ui(c))}}},_drop:function(f,d){var h=d||a.ui.ddmanager.current;if(!h||(h.currentItem||h.element)[0]==this.element[0]){return false}var g=false;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"droppable");if(b.options.greedy&&!b.options.disabled&&b.options.scope==h.options.scope&&b.accept.call(b.element[0],h.currentItem||h.element)&&a.ui.intersect(h,a.extend(b,{offset:b.element.offset()}),b.options.tolerance)){g=true;return false}});if(g){return false}if(this.accept.call(this.element[0],h.currentItem||h.element)){this.options.activeClass&&this.element.removeClass(this.options.activeClass);this.options.hoverClass&&this.element.removeClass(this.options.hoverClass);this._trigger("drop",f,this.ui(h));return this.element}return false},ui:function(b){return{draggable:b.currentItem||b.element,helper:b.helper,position:b.position,offset:b.positionAbs}}});a.extend(a.ui.droppable,{version:"1.8.9"});a.ui.intersect=function(v,u,t){if(!u.offset){return false}var s=(v.positionAbs||v.position.absolute).left,q=s+v.helperProportions.width,r=(v.positionAbs||v.position.absolute).top,p=r+v.helperProportions.height,o=u.offset.left,m=o+u.proportions.width,n=u.offset.top,d=n+u.proportions.height;switch(t){case"fit":return o<=s&&q<=m&&n<=r&&p<=d;case"intersect":return o<s+v.helperProportions.width/2&&q-v.helperProportions.width/2<m&&n<r+v.helperProportions.height/2&&p-v.helperProportions.height/2<d;case"pointer":return a.ui.isOver((v.positionAbs||v.position.absolute).top+(v.clickOffset||v.offset.click).top,(v.positionAbs||v.position.absolute).left+(v.clickOffset||v.offset.click).left,n,o,u.proportions.height,u.proportions.width);case"touch":return(r>=n&&r<=d||p>=n&&p<=d||r<n&&p>d)&&(s>=o&&s<=m||q>=o&&q<=m||s<o&&q>m);default:return false}};a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(i,d){var n=a.ui.ddmanager.droppables[i.options.scope]||[],m=d?d.type:null,k=(i.currentItem||i.element).find(":data(droppable)").andSelf(),l=0;i:for(;l<n.length;l++){if(!(n[l].options.disabled||i&&!n[l].accept.call(n[l].element[0],i.currentItem||i.element))){for(var j=0;j<k.length;j++){if(k[j]==n[l].element[0]){n[l].proportions.height=0;continue i}}n[l].visible=n[l].element.css("display")!="none";if(n[l].visible){n[l].offset=n[l].element.offset();n[l].proportions={width:n[l].element[0].offsetWidth,height:n[l].element[0].offsetHeight};m=="mousedown"&&n[l]._activate.call(n[l],d)}}}},drop:function(e,d){var f=false;a.each(a.ui.ddmanager.droppables[e.options.scope]||[],function(){if(this.options){if(!this.options.disabled&&this.visible&&a.ui.intersect(e,this,this.options.tolerance)){f=f||this._drop.call(this,d)}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)){this.isout=1;this.isover=0;this._deactivate.call(this,d)}}});return f},drag:function(d,c){d.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(d,c);a.each(a.ui.ddmanager.droppables[d.options.scope]||[],function(){if(!(this.options.disabled||this.greedyChild||!this.visible)){var h=a.ui.intersect(d,this,this.options.tolerance);if(h=!h&&this.isover==1?"isout":h&&this.isover==0?"isover":null){var f;if(this.options.greedy){var b=this.element.parents(":data(droppable):eq(0)");if(b.length){f=a.data(b[0],"droppable");f.greedyChild=h=="isover"?1:0}}if(f&&h=="isover"){f.isover=0;f.isout=1;f._out.call(f,c)}this[h]=1;this[h=="isout"?"isover":"isout"]=0;this[h=="isover"?"_over":"_out"].call(this,c);if(f&&h=="isout"){f.isout=0;f.isover=1;f._over.call(f,c)}}}})}}})(jQuery);jQuery.effects||function(l,i){function e(j){var f;if(j&&j.constructor==Array&&j.length==3){return j}if(f=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(j)){return[parseInt(f[1],10),parseInt(f[2],10),parseInt(f[3],10)]}if(f=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(j)){return[parseFloat(f[1])*2.55,parseFloat(f[2])*2.55,parseFloat(f[3])*2.55]}if(f=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(j)){return[parseInt(f[1],16),parseInt(f[2],16),parseInt(f[3],16)]}if(f=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(j)){return[parseInt(f[1]+f[1],16),parseInt(f[2]+f[2],16),parseInt(f[3]+f[3],16)]}if(/rgba\(0, 0, 0, 0\)/.exec(j)){return d.transparent}return d[l.trim(j).toLowerCase()]}function x(k,j){var f;do{f=l.curCSS(k,j);if(f!=""&&f!="transparent"||l.nodeName(k,"body")){break}j="backgroundColor"}while(k=k.parentNode);return e(f)}function c(){var n=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,j={},f,m;if(n&&n.length&&n[0]&&n[n[0]]){for(var k=n.length;k--;){f=n[k];if(typeof n[f]=="string"){m=f.replace(/\-(\w)/g,function(p,o){return o.toUpperCase()});j[m]=n[f]}}}else{for(f in n){if(typeof n[f]==="string"){j[f]=n[f]}}}return j}function b(k){var j,f;for(j in k){f=k[j];if(f==null||l.isFunction(f)||j in w||/scrollbar/.test(j)||!/color/i.test(j)&&isNaN(parseFloat(f))){delete k[j]}}return k}function v(m,j){var f={_:0},k;for(k in j){if(m[k]!=j[k]){f[k]=j[k]}}return f}function h(m,j,f,k){if(typeof m=="object"){k=j;f=null;j=m;m=j.effect}if(l.isFunction(j)){k=j;f=null;j={}}if(typeof j=="number"||l.fx.speeds[j]){k=f;f=j;j={}}if(l.isFunction(f)){k=f;f=null}j=j||{};f=f||j.duration;f=l.fx.off?0:typeof f=="number"?f:f in l.fx.speeds?l.fx.speeds[f]:l.fx.speeds._default;k=k||j.complete;return[m,j,f,k]}function g(f){if(!f||typeof f==="number"||l.fx.speeds[f]){return true}if(typeof f==="string"&&!l.effects[f]){return true}return false}l.effects={};l.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(j,f){l.fx.step[f]=function(k){if(!k.colorInit){k.start=x(k.elem,f);k.end=e(k.end);k.colorInit=true}k.elem.style[f]="rgb("+Math.max(Math.min(parseInt(k.pos*(k.end[0]-k.start[0])+k.start[0],10),255),0)+","+Math.max(Math.min(parseInt(k.pos*(k.end[1]-k.start[1])+k.start[1],10),255),0)+","+Math.max(Math.min(parseInt(k.pos*(k.end[2]-k.start[2])+k.start[2],10),255),0)+")"}});var d={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},a=["add","remove","toggle"],w={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};l.effects.animateClass=function(m,j,f,k){if(l.isFunction(f)){k=f;f=null}return this.queue("fx",function(){var r=l(this),q=r.attr("style")||" ",p=b(c.call(this)),n,o=r.attr("className");l.each(a,function(s,t){m[t]&&r[t+"Class"](m[t])});n=b(c.call(this));r.attr("className",o);r.animate(v(p,n),j,f,function(){l.each(a,function(s,t){m[t]&&r[t+"Class"](m[t])});if(typeof r.attr("style")=="object"){r.attr("style").cssText="";r.attr("style").cssText=q}else{r.attr("style",q)}k&&k.apply(this,arguments)});p=l.queue(this);n=p.splice(p.length-1,1)[0];p.splice(1,0,n);l.dequeue(this)})};l.fn.extend({_addClass:l.fn.addClass,addClass:function(m,j,f,k){return j?l.effects.animateClass.apply(this,[{add:m},j,f,k]):this._addClass(m)},_removeClass:l.fn.removeClass,removeClass:function(m,j,f,k){return j?l.effects.animateClass.apply(this,[{remove:m},j,f,k]):this._removeClass(m)},_toggleClass:l.fn.toggleClass,toggleClass:function(n,j,f,m,k){return typeof j=="boolean"||j===i?f?l.effects.animateClass.apply(this,[j?{add:n}:{remove:n},f,m,k]):this._toggleClass(n,j):l.effects.animateClass.apply(this,[{toggle:n},j,f,m])},switchClass:function(n,j,f,m,k){return l.effects.animateClass.apply(this,[{add:j,remove:n},f,m,k])}});l.extend(l.effects,{version:"1.8.9",save:function(k,j){for(var f=0;f<j.length;f++){j[f]!==null&&k.data("ec.storage."+j[f],k[0].style[j[f]])}},restore:function(k,j){for(var f=0;f<j.length;f++){j[f]!==null&&k.css(j[f],k.data("ec.storage."+j[f]))}},setMode:function(j,f){if(f=="toggle"){f=j.is(":hidden")?"show":"hide"}return f},getBaseline:function(k,j){var f;switch(k[0]){case"top":f=0;break;case"middle":f=0.5;break;case"bottom":f=1;break;default:f=k[0]/j.height}switch(k[1]){case"left":k=0;break;case"center":k=0.5;break;case"right":k=1;break;default:k=k[1]/j.width}return{x:k,y:f}},createWrapper:function(k){if(k.parent().is(".ui-effects-wrapper")){return k.parent()}var j={width:k.outerWidth(true),height:k.outerHeight(true),"float":k.css("float")},f=l("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0});k.wrap(f);f=k.parent();if(k.css("position")=="static"){f.css({position:"relative"});k.css({position:"relative"})}else{l.extend(j,{position:k.css("position"),zIndex:k.css("z-index")});l.each(["top","left","bottom","right"],function(n,m){j[m]=k.css(m);if(isNaN(parseInt(j[m],10))){j[m]="auto"}});k.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}return f.css(j).show()},removeWrapper:function(f){if(f.parent().is(".ui-effects-wrapper")){return f.parent().replaceWith(f)}return f},setTransition:function(m,j,f,k){k=k||{};l.each(j,function(o,n){unit=m.cssUnit(n);if(unit[0]>0){k[n]=unit[0]*f+unit[1]}});return k}});l.fn.extend({effect:function(m){var j=h.apply(this,arguments),f={options:j[1],duration:j[2],callback:j[3]};j=f.options.mode;var k=l.effects[m];if(l.fx.off||!k){return j?this[j](f.duration,f.callback):this.each(function(){f.callback&&f.callback.call(this)})}return k.call(this,f)},_show:l.fn.show,show:function(j){if(g(j)){return this._show.apply(this,arguments)}else{var f=h.apply(this,arguments);f[1].mode="show";return this.effect.apply(this,f)}},_hide:l.fn.hide,hide:function(j){if(g(j)){return this._hide.apply(this,arguments)}else{var f=h.apply(this,arguments);f[1].mode="hide";return this.effect.apply(this,f)}},__toggle:l.fn.toggle,toggle:function(j){if(g(j)||typeof j==="boolean"||l.isFunction(j)){return this.__toggle.apply(this,arguments)}else{var f=h.apply(this,arguments);f[1].mode="toggle";return this.effect.apply(this,f)}},cssUnit:function(k){var j=this.css(k),f=[];l.each(["em","px","%","pt"],function(n,m){if(j.indexOf(m)>0){f=[parseFloat(j),m]}});return f}});l.easing.jswing=l.easing.swing;l.extend(l.easing,{def:"easeOutQuad",swing:function(n,j,f,m,k){return l.easing[l.easing.def](n,j,f,m,k)},easeInQuad:function(n,j,f,m,k){return m*(j/=k)*j+f},easeOutQuad:function(n,j,f,m,k){return -m*(j/=k)*(j-2)+f},easeInOutQuad:function(n,j,f,m,k){if((j/=k/2)<1){return m/2*j*j+f}return -m/2*(--j*(j-2)-1)+f},easeInCubic:function(n,j,f,m,k){return m*(j/=k)*j*j+f},easeOutCubic:function(n,j,f,m,k){return m*((j=j/k-1)*j*j+1)+f},easeInOutCubic:function(n,j,f,m,k){if((j/=k/2)<1){return m/2*j*j*j+f}return m/2*((j-=2)*j*j+2)+f},easeInQuart:function(n,j,f,m,k){return m*(j/=k)*j*j*j+f},easeOutQuart:function(n,j,f,m,k){return -m*((j=j/k-1)*j*j*j-1)+f},easeInOutQuart:function(n,j,f,m,k){if((j/=k/2)<1){return m/2*j*j*j*j+f}return -m/2*((j-=2)*j*j*j-2)+f},easeInQuint:function(n,j,f,m,k){return m*(j/=k)*j*j*j*j+f},easeOutQuint:function(n,j,f,m,k){return m*((j=j/k-1)*j*j*j*j+1)+f},easeInOutQuint:function(n,j,f,m,k){if((j/=k/2)<1){return m/2*j*j*j*j*j+f}return m/2*((j-=2)*j*j*j*j+2)+f},easeInSine:function(n,j,f,m,k){return -m*Math.cos(j/k*(Math.PI/2))+m+f},easeOutSine:function(n,j,f,m,k){return m*Math.sin(j/k*(Math.PI/2))+f},easeInOutSine:function(n,j,f,m,k){return -m/2*(Math.cos(Math.PI*j/k)-1)+f},easeInExpo:function(n,j,f,m,k){return j==0?f:m*Math.pow(2,10*(j/k-1))+f},easeOutExpo:function(n,j,f,m,k){return j==k?f+m:m*(-Math.pow(2,-10*j/k)+1)+f},easeInOutExpo:function(n,j,f,m,k){if(j==0){return f}if(j==k){return f+m}if((j/=k/2)<1){return m/2*Math.pow(2,10*(j-1))+f}return m/2*(-Math.pow(2,-10*--j)+2)+f},easeInCirc:function(n,j,f,m,k){return -m*(Math.sqrt(1-(j/=k)*j)-1)+f},easeOutCirc:function(n,j,f,m,k){return m*Math.sqrt(1-(j=j/k-1)*j)+f},easeInOutCirc:function(n,j,f,m,k){if((j/=k/2)<1){return -m/2*(Math.sqrt(1-j*j)-1)+f}return m/2*(Math.sqrt(1-(j-=2)*j)+1)+f},easeInElastic:function(p,j,f,o,n){p=1.70158;var m=0,k=o;if(j==0){return f}if((j/=n)==1){return f+o}m||(m=n*0.3);if(k<Math.abs(o)){k=o;p=m/4}else{p=m/(2*Math.PI)*Math.asin(o/k)}return -(k*Math.pow(2,10*(j-=1))*Math.sin((j*n-p)*2*Math.PI/m))+f},easeOutElastic:function(p,j,f,o,n){p=1.70158;var m=0,k=o;if(j==0){return f}if((j/=n)==1){return f+o}m||(m=n*0.3);if(k<Math.abs(o)){k=o;p=m/4}else{p=m/(2*Math.PI)*Math.asin(o/k)}return k*Math.pow(2,-10*j)*Math.sin((j*n-p)*2*Math.PI/m)+o+f},easeInOutElastic:function(p,j,f,o,n){p=1.70158;var m=0,k=o;if(j==0){return f}if((j/=n/2)==2){return f+o}m||(m=n*0.3*1.5);if(k<Math.abs(o)){k=o;p=m/4}else{p=m/(2*Math.PI)*Math.asin(o/k)}if(j<1){return -0.5*k*Math.pow(2,10*(j-=1))*Math.sin((j*n-p)*2*Math.PI/m)+f}return k*Math.pow(2,-10*(j-=1))*Math.sin((j*n-p)*2*Math.PI/m)*0.5+o+f},easeInBack:function(o,j,f,n,m,k){if(k==i){k=1.70158}return n*(j/=m)*j*((k+1)*j-k)+f},easeOutBack:function(o,j,f,n,m,k){if(k==i){k=1.70158}return n*((j=j/m-1)*j*((k+1)*j+k)+1)+f},easeInOutBack:function(o,j,f,n,m,k){if(k==i){k=1.70158}if((j/=m/2)<1){return n/2*j*j*(((k*=1.525)+1)*j-k)+f}return n/2*((j-=2)*j*(((k*=1.525)+1)*j+k)+2)+f},easeInBounce:function(n,j,f,m,k){return m-l.easing.easeOutBounce(n,k-j,0,m,k)+f},easeOutBounce:function(n,j,f,m,k){return(j/=k)<1/2.75?m*7.5625*j*j+f:j<2/2.75?m*(7.5625*(j-=1.5/2.75)*j+0.75)+f:j<2.5/2.75?m*(7.5625*(j-=2.25/2.75)*j+0.9375)+f:m*(7.5625*(j-=2.625/2.75)*j+0.984375)+f},easeInOutBounce:function(n,j,f,m,k){if(j<k/2){return l.easing.easeInBounce(n,j*2,0,m,k)*0.5+f}return l.easing.easeOutBounce(n,j*2-k,0,m,k)*0.5+m*0.5+f}})}(jQuery);(function(a){a.effects.blind=function(b){return this.queue(function(){var c=a(this),l=["position","top","bottom","left","right"],m=a.effects.setMode(c,b.options.mode||"hide"),o=b.options.direction||"vertical";a.effects.save(c,l);c.show();var n=a.effects.createWrapper(c).css({overflow:"hidden"}),k=o=="vertical"?"height":"width";o=o=="vertical"?n.height():n.width();m=="show"&&n.css(k,0);var j={};j[k]=m=="show"?o:0;n.animate(j,b.duration,b.options.easing,function(){m=="hide"&&c.hide();a.effects.restore(c,l);a.effects.removeWrapper(c);b.callback&&b.callback.apply(c[0],arguments);c.dequeue()})})}})(jQuery);(function(a){a.effects.bounce=function(c){return this.queue(function(){var v=a(this),e=["position","top","bottom","left","right"],q=a.effects.setMode(v,c.options.mode||"effect"),t=c.options.direction||"up",u=c.options.distance||20,b=c.options.times||5,p=c.duration||250;/show|hide/.test(q)&&e.push("opacity");a.effects.save(v,e);v.show();a.effects.createWrapper(v);var s=t=="up"||t=="down"?"top":"left";t=t=="up"||t=="left"?"pos":"neg";u=c.options.distance||(s=="top"?v.outerHeight({margin:true})/3:v.outerWidth({margin:true})/3);if(q=="show"){v.css("opacity",0).css(s,t=="pos"?-u:u)}if(q=="hide"){u/=b*2}q!="hide"&&b--;if(q=="show"){var r={opacity:1};r[s]=(t=="pos"?"+=":"-=")+u;v.animate(r,p/2,c.options.easing);u/=2;b--}for(r=0;r<b;r++){var o={},n={};o[s]=(t=="pos"?"-=":"+=")+u;n[s]=(t=="pos"?"+=":"-=")+u;v.animate(o,p/2,c.options.easing).animate(n,p/2,c.options.easing);u=q=="hide"?u*2:u/2}if(q=="hide"){r={opacity:0};r[s]=(t=="pos"?"-=":"+=")+u;v.animate(r,p/2,c.options.easing,function(){v.hide();a.effects.restore(v,e);a.effects.removeWrapper(v);c.callback&&c.callback.apply(this,arguments)})}else{o={};n={};o[s]=(t=="pos"?"-=":"+=")+u;n[s]=(t=="pos"?"+=":"-=")+u;v.animate(o,p/2,c.options.easing).animate(n,p/2,c.options.easing,function(){a.effects.restore(v,e);a.effects.removeWrapper(v);c.callback&&c.callback.apply(this,arguments)})}v.queue("fx",function(){v.dequeue()});v.dequeue()})}})(jQuery);(function(a){a.effects.clip=function(b){return this.queue(function(){var e=a(this),j=["position","top","bottom","left","right","height","width"],m=a.effects.setMode(e,b.options.mode||"hide"),o=b.options.direction||"vertical";a.effects.save(e,j);e.show();var n=a.effects.createWrapper(e).css({overflow:"hidden"});n=e[0].tagName=="IMG"?n:e;var l={size:o=="vertical"?"height":"width",position:o=="vertical"?"top":"left"};o=o=="vertical"?n.height():n.width();if(m=="show"){n.css(l.size,0);n.css(l.position,o/2)}var k={};k[l.size]=m=="show"?o:0;k[l.position]=m=="show"?0:o/2;n.animate(k,{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){m=="hide"&&e.hide();a.effects.restore(e,j);a.effects.removeWrapper(e);b.callback&&b.callback.apply(e[0],arguments);e.dequeue()}})})}})(jQuery);(function(a){a.effects.drop=function(b){return this.queue(function(){var d=a(this),k=["position","top","bottom","left","right","opacity"],n=a.effects.setMode(d,b.options.mode||"hide"),c=b.options.direction||"left";a.effects.save(d,k);d.show();a.effects.createWrapper(d);var m=c=="up"||c=="down"?"top":"left";c=c=="up"||c=="left"?"pos":"neg";var l=b.options.distance||(m=="top"?d.outerHeight({margin:true})/2:d.outerWidth({margin:true})/2);if(n=="show"){d.css("opacity",0).css(m,c=="pos"?-l:l)}var j={opacity:n=="show"?1:0};j[m]=(n=="show"?c=="pos"?"+=":"-=":c=="pos"?"-=":"+=")+l;d.animate(j,{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){n=="hide"&&d.hide();a.effects.restore(d,k);a.effects.removeWrapper(d);b.callback&&b.callback.apply(this,arguments);d.dequeue()}})})}})(jQuery);(function(a){a.effects.explode=function(b){return this.queue(function(){var q=b.options.pieces?Math.round(Math.sqrt(b.options.pieces)):3,p=b.options.pieces?Math.round(Math.sqrt(b.options.pieces)):3;b.options.mode=b.options.mode=="toggle"?a(this).is(":visible")?"hide":"show":b.options.mode;var j=a(this).show().css("visibility","hidden"),m=j.offset();m.top-=parseInt(j.css("marginTop"),10)||0;m.left-=parseInt(j.css("marginLeft"),10)||0;for(var l=j.outerWidth(true),k=j.outerHeight(true),o=0;o<q;o++){for(var n=0;n<p;n++){j.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-n*(l/p),top:-o*(k/q)}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:l/p,height:k/q,left:m.left+n*(l/p)+(b.options.mode=="show"?(n-Math.floor(p/2))*(l/p):0),top:m.top+o*(k/q)+(b.options.mode=="show"?(o-Math.floor(q/2))*(k/q):0),opacity:b.options.mode=="show"?0:1}).animate({left:m.left+n*(l/p)+(b.options.mode=="show"?0:(n-Math.floor(p/2))*(l/p)),top:m.top+o*(k/q)+(b.options.mode=="show"?0:(o-Math.floor(q/2))*(k/q)),opacity:b.options.mode=="show"?1:0},b.duration||500)}}setTimeout(function(){b.options.mode=="show"?j.css({visibility:"visible"}):j.css({visibility:"visible"}).hide();b.callback&&b.callback.apply(j[0]);j.dequeue();a("div.ui-effects-explode").remove()},b.duration||500)})}})(jQuery);(function(a){a.effects.fade=function(b){return this.queue(function(){var f=a(this),e=a.effects.setMode(f,b.options.mode||"hide");f.animate({opacity:e},{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){b.callback&&b.callback.apply(this,arguments);f.dequeue()}})})}})(jQuery);(function(a){a.effects.fold=function(b){return this.queue(function(){var u=a(this),n=["position","top","bottom","left","right"],t=a.effects.setMode(u,b.options.mode||"hide"),q=b.options.size||15,p=!!b.options.horizFirst,m=b.duration?b.duration/2:a.fx.speeds._default/2;a.effects.save(u,n);u.show();var s=a.effects.createWrapper(u).css({overflow:"hidden"}),r=t=="show"!=p,c=r?["width","height"]:["height","width"];r=r?[s.width(),s.height()]:[s.height(),s.width()];var o=/([0-9]+)%/.exec(q);if(o){q=parseInt(o[1],10)/100*r[t=="hide"?0:1]}if(t=="show"){s.css(p?{height:0,width:q}:{height:q,width:0})}p={};o={};p[c[0]]=t=="show"?r[0]:q;o[c[1]]=t=="show"?r[1]:0;s.animate(p,m,b.options.easing).animate(o,m,b.options.easing,function(){t=="hide"&&u.hide();a.effects.restore(u,n);a.effects.removeWrapper(u);b.callback&&b.callback.apply(u[0],arguments);u.dequeue()})})}})(jQuery);(function(a){a.effects.highlight=function(b){return this.queue(function(){var c=a(this),h=["backgroundImage","backgroundColor","opacity"],i=a.effects.setMode(c,b.options.mode||"show"),g={backgroundColor:c.css("backgroundColor")};if(i=="hide"){g.opacity=0}a.effects.save(c,h);c.show().css({backgroundImage:"none",backgroundColor:b.options.color||"#ffff99"}).animate(g,{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){i=="hide"&&c.hide();a.effects.restore(c,h);i=="show"&&!a.support.opacity&&this.style.removeAttribute("filter");b.callback&&b.callback.apply(this,arguments);c.dequeue()}})})}})(jQuery);(function(a){a.effects.pulsate=function(b){return this.queue(function(){var d=a(this),e=a.effects.setMode(d,b.options.mode||"show");times=(b.options.times||5)*2-1;duration=b.duration?b.duration/2:a.fx.speeds._default/2;isVisible=d.is(":visible");animateTo=0;if(!isVisible){d.css("opacity",0).show();animateTo=1}if(e=="hide"&&isVisible||e=="show"&&!isVisible){times--}for(e=0;e<times;e++){d.animate({opacity:animateTo},duration,b.options.easing);animateTo=(animateTo+1)%2}d.animate({opacity:animateTo},duration,b.options.easing,function(){animateTo==0&&d.hide();b.callback&&b.callback.apply(this,arguments)});d.queue("fx",function(){d.dequeue()}).dequeue()})}})(jQuery);(function(a){a.effects.puff=function(c){return this.queue(function(){var b=a(this),k=a.effects.setMode(b,c.options.mode||"hide"),j=parseInt(c.options.percent,10)||150,f=j/100,d={height:b.height(),width:b.width()};a.extend(c.options,{fade:true,mode:k,percent:k=="hide"?j:100,from:k=="hide"?d:{height:d.height*f,width:d.width*f}});b.effect("scale",c.options,c.duration,c.callback);b.dequeue()})};a.effects.scale=function(c){return this.queue(function(){var b=a(this),m=a.extend(true,{},c.options),k=a.effects.setMode(b,c.options.mode||"effect"),j=parseInt(c.options.percent,10)||(parseInt(c.options.percent,10)==0?0:k=="hide"?0:100),d=c.options.direction||"both",l=c.options.origin;if(k!="effect"){m.origin=l||["middle","center"];m.restore=true}l={height:b.height(),width:b.width()};b.from=c.options.from||(k=="show"?{height:0,width:0}:l);j={y:d!="horizontal"?j/100:1,x:d!="vertical"?j/100:1};b.to={height:l.height*j.y,width:l.width*j.x};if(c.options.fade){if(k=="show"){b.from.opacity=0;b.to.opacity=1}if(k=="hide"){b.from.opacity=1;b.to.opacity=0}}m.from=b.from;m.to=b.to;m.mode=k;b.effect("size",m,c.duration,c.callback);b.dequeue()})};a.effects.size=function(c){return this.queue(function(){var A=a(this),y=["position","top","bottom","left","right","width","height","overflow","opacity"],w=["position","top","bottom","left","right","overflow","opacity"],v=["width","height","overflow"],u=["fontSize"],x=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],s=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],b=a.effects.setMode(A,c.options.mode||"effect"),o=c.options.restore||false,q=c.options.scale||"both",r=c.options.origin,t={height:A.height(),width:A.width()};A.from=c.options.from||t;A.to=c.options.to||t;if(r){r=a.effects.getBaseline(r,t);A.from.top=(t.height-A.from.height)*r.y;A.from.left=(t.width-A.from.width)*r.x;A.to.top=(t.height-A.to.height)*r.y;A.to.left=(t.width-A.to.width)*r.x}var z={from:{y:A.from.height/t.height,x:A.from.width/t.width},to:{y:A.to.height/t.height,x:A.to.width/t.width}};if(q=="box"||q=="both"){if(z.from.y!=z.to.y){y=y.concat(x);A.from=a.effects.setTransition(A,x,z.from.y,A.from);A.to=a.effects.setTransition(A,x,z.to.y,A.to)}if(z.from.x!=z.to.x){y=y.concat(s);A.from=a.effects.setTransition(A,s,z.from.x,A.from);A.to=a.effects.setTransition(A,s,z.to.x,A.to)}}if(q=="content"||q=="both"){if(z.from.y!=z.to.y){y=y.concat(u);A.from=a.effects.setTransition(A,u,z.from.y,A.from);A.to=a.effects.setTransition(A,u,z.to.y,A.to)}}a.effects.save(A,o?y:w);A.show();a.effects.createWrapper(A);A.css("overflow","hidden").css(A.from);if(q=="content"||q=="both"){x=x.concat(["marginTop","marginBottom"]).concat(u);s=s.concat(["marginLeft","marginRight"]);v=y.concat(x).concat(s);A.find("*[width]").each(function(){child=a(this);o&&a.effects.save(child,v);var d={height:child.height(),width:child.width()};child.from={height:d.height*z.from.y,width:d.width*z.from.x};child.to={height:d.height*z.to.y,width:d.width*z.to.x};if(z.from.y!=z.to.y){child.from=a.effects.setTransition(child,x,z.from.y,child.from);child.to=a.effects.setTransition(child,x,z.to.y,child.to)}if(z.from.x!=z.to.x){child.from=a.effects.setTransition(child,s,z.from.x,child.from);child.to=a.effects.setTransition(child,s,z.to.x,child.to)}child.css(child.from);child.animate(child.to,c.duration,c.options.easing,function(){o&&a.effects.restore(child,v)})})}A.animate(A.to,{queue:false,duration:c.duration,easing:c.options.easing,complete:function(){A.to.opacity===0&&A.css("opacity",A.from.opacity);b=="hide"&&A.hide();a.effects.restore(A,o?y:w);a.effects.removeWrapper(A);c.callback&&c.callback.apply(this,arguments);A.dequeue()}})})}})(jQuery);(function(a){a.effects.shake=function(b){return this.queue(function(){var u=a(this),n=["position","top","bottom","left","right"];a.effects.setMode(u,b.options.mode||"effect");var t=b.options.direction||"left",s=b.options.distance||20,d=b.options.times||3,r=b.duration||b.options.duration||140;a.effects.save(u,n);u.show();a.effects.createWrapper(u);var q=t=="up"||t=="down"?"top":"left",p=t=="up"||t=="left"?"pos":"neg";t={};var o={},m={};t[q]=(p=="pos"?"-=":"+=")+s;o[q]=(p=="pos"?"+=":"-=")+s*2;m[q]=(p=="pos"?"-=":"+=")+s*2;u.animate(t,r,b.options.easing);for(s=1;s<d;s++){u.animate(o,r,b.options.easing).animate(m,r,b.options.easing)}u.animate(o,r,b.options.easing).animate(t,r/2,b.options.easing,function(){a.effects.restore(u,n);a.effects.removeWrapper(u);b.callback&&b.callback.apply(this,arguments)});u.queue("fx",function(){u.dequeue()});u.dequeue()})}})(jQuery);(function(a){a.effects.slide=function(b){return this.queue(function(){var d=a(this),k=["position","top","bottom","left","right"],m=a.effects.setMode(d,b.options.mode||"show"),c=b.options.direction||"left";a.effects.save(d,k);d.show();a.effects.createWrapper(d).css({overflow:"hidden"});var l=c=="up"||c=="down"?"top":"left";c=c=="up"||c=="left"?"pos":"neg";var n=b.options.distance||(l=="top"?d.outerHeight({margin:true}):d.outerWidth({margin:true}));if(m=="show"){d.css(l,c=="pos"?isNaN(n)?"-"+n:-n:n)}var j={};j[l]=(m=="show"?c=="pos"?"+=":"-=":c=="pos"?"-=":"+=")+n;d.animate(j,{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){m=="hide"&&d.hide();a.effects.restore(d,k);a.effects.removeWrapper(d);b.callback&&b.callback.apply(this,arguments);d.dequeue()}})})}})(jQuery);(function(a){a.effects.transfer=function(b){return this.queue(function(){var e=a(this),i=a(b.options.to),h=i.offset();i={top:h.top,left:h.left,height:i.innerHeight(),width:i.innerWidth()};h=e.offset();var g=a('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(b.options.className).css({top:h.top,left:h.left,height:e.innerHeight(),width:e.innerWidth(),position:"absolute"}).animate(i,b.duration,b.options.easing,function(){g.remove();b.callback&&b.callback.apply(e[0],arguments);e.dequeue()})})}})(jQuery);(function(a,b){a.widget("ui.sortable",a.ui.mouse,{widgetEventPrefix:"sort",options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000},_create:function(){var c=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?(/left|right/).test(this.items[0].item.css("float")):false;this.offset=this.element.offset();this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable");this._mouseDestroy();for(var c=this.items.length-1;c>=0;c--){this.items[c].item.removeData("sortable-item")}return this},_setOption:function(c,d){if(c==="disabled"){this.options[c]=d;this.widget()[d?"addClass":"removeClass"]("ui-sortable-disabled")}else{a.Widget.prototype._setOption.apply(this,arguments)}},_mouseCapture:function(f,g){if(this.reverting){return false}if(this.options.disabled||this.options.type=="static"){return false}this._refreshItems(f);var e=null,d=this,c=a(f.target).parents().each(function(){if(a.data(this,"sortable-item")==d){e=a(this);return false}});if(a.data(f.target,"sortable-item")==d){e=a(f.target)}if(!e){return false}if(this.options.handle&&!g){var h=false;a(this.options.handle,e).find("*").andSelf().each(function(){if(this==f.target){h=true}});if(!h){return false}}this.currentItem=e;this._removeCurrentsFromItems();return true},_mouseStart:function(f,g,c){var h=this.options,d=this;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(f);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");a.extend(this.offset,{click:{left:f.pageX-this.offset.left,top:f.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this._generatePosition(f);this.originalPageX=f.pageX;this.originalPageY=f.pageY;(h.cursorAt&&this._adjustOffsetFromHelper(h.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!=this.currentItem[0]){this.currentItem.hide()}this._createPlaceholder();if(h.containment){this._setContainment()}if(h.cursor){if(a("body").css("cursor")){this._storedCursor=a("body").css("cursor")}a("body").css("cursor",h.cursor)}if(h.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity")}this.helper.css("opacity",h.opacity)}if(h.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex")}this.helper.css("zIndex",h.zIndex)}if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){this.overflowOffset=this.scrollParent.offset()}this._trigger("start",f,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions()}if(!c){for(var e=this.containers.length-1;e>=0;e--){this.containers[e]._trigger("activate",f,d._uiHash(this))}}if(a.ui.ddmanager){a.ui.ddmanager.current=this}if(a.ui.ddmanager&&!h.dropBehaviour){a.ui.ddmanager.prepareOffsets(this,f)}this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(f);return true},_mouseDrag:function(g){this.position=this._generatePosition(g);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs}if(this.options.scroll){var h=this.options,c=false;if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-g.pageY<h.scrollSensitivity){this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop+h.scrollSpeed}else{if(g.pageY-this.overflowOffset.top<h.scrollSensitivity){this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop-h.scrollSpeed}}if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-g.pageX<h.scrollSensitivity){this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft+h.scrollSpeed}else{if(g.pageX-this.overflowOffset.left<h.scrollSensitivity){this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft-h.scrollSpeed}}}else{if(g.pageY-a(document).scrollTop()<h.scrollSensitivity){c=a(document).scrollTop(a(document).scrollTop()-h.scrollSpeed)}else{if(a(window).height()-(g.pageY-a(document).scrollTop())<h.scrollSensitivity){c=a(document).scrollTop(a(document).scrollTop()+h.scrollSpeed)}}if(g.pageX-a(document).scrollLeft()<h.scrollSensitivity){c=a(document).scrollLeft(a(document).scrollLeft()-h.scrollSpeed)}else{if(a(window).width()-(g.pageX-a(document).scrollLeft())<h.scrollSensitivity){c=a(document).scrollLeft(a(document).scrollLeft()+h.scrollSpeed)}}}if(c!==false&&a.ui.ddmanager&&!h.dropBehaviour){a.ui.ddmanager.prepareOffsets(this,g)}}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}for(var e=this.items.length-1;e>=0;e--){var f=this.items[e],d=f.item[0],j=this._intersectsWithPointer(f);if(!j){continue}if(d!=this.currentItem[0]&&this.placeholder[j==1?"next":"prev"]()[0]!=d&&!a.ui.contains(this.placeholder[0],d)&&(this.options.type=="semi-dynamic"?!a.ui.contains(this.element[0],d):true)){this.direction=j==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(f)){this._rearrange(g,f)}else{break}this._trigger("change",g,this._uiHash());break}}this._contactContainers(g);if(a.ui.ddmanager){a.ui.ddmanager.drag(this,g)}this._trigger("sort",g,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(d,e){if(!d){return}if(a.ui.ddmanager&&!this.options.dropBehaviour){a.ui.ddmanager.drop(this,d)}if(this.options.revert){var c=this;var f=c.placeholder.offset();c.reverting=true;a(this.helper).animate({left:f.left-this.offset.parent.left-c.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:f.top-this.offset.parent.top-c.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){c._clear(d)})}else{this._clear(d,e)}return false},cancel:function(){var c=this;if(this.dragging){this._mouseUp({target:null});if(this.options.helper=="original"){this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}for(var d=this.containers.length-1;d>=0;d--){this.containers[d]._trigger("deactivate",null,c._uiHash(this));if(this.containers[d].containerCache.over){this.containers[d]._trigger("out",null,c._uiHash(this));this.containers[d].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0])}if(this.options.helper!="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove()}a.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){a(this.domPosition.prev).after(this.currentItem)}else{a(this.domPosition.parent).prepend(this.currentItem)}}return this},serialize:function(e){var c=this._getItemsAsjQuery(e&&e.connected);var d=[];e=e||{};a(c).each(function(){var f=(a(e.item||this).attr(e.attribute||"id")||"").match(e.expression||(/(.+)[-=_](.+)/));if(f){d.push((e.key||f[1]+"[]")+"="+(e.key&&e.expression?f[1]:f[2]))}});if(!d.length&&e.key){d.push(e.key+"=")}return d.join("&")},toArray:function(e){var c=this._getItemsAsjQuery(e&&e.connected);var d=[];e=e||{};c.each(function(){d.push(a(e.item||this).attr(e.attribute||"id")||"")});return d},_intersectsWith:function(m){var e=this.positionAbs.left,d=e+this.helperProportions.width,k=this.positionAbs.top,j=k+this.helperProportions.height;var f=m.left,c=f+m.width,n=m.top,i=n+m.height;var o=this.offset.click.top,h=this.offset.click.left;var g=(k+o)>n&&(k+o)<i&&(e+h)>f&&(e+h)<c;if(this.options.tolerance=="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>m[this.floating?"width":"height"])){return g}else{return(f<e+(this.helperProportions.width/2)&&d-(this.helperProportions.width/2)<c&&n<k+(this.helperProportions.height/2)&&j-(this.helperProportions.height/2)<i)}},_intersectsWithPointer:function(e){var f=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),d=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),h=f&&d,c=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();if(!h){return false}return this.floating?(((g&&g=="right")||c=="down")?2:1):(c&&(c=="down"?2:1))},_intersectsWithSides:function(f){var d=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,f.top+(f.height/2),f.height),e=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,f.left+(f.width/2),f.width),c=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();if(this.floating&&g){return((g=="right"&&e)||(g=="left"&&!e))}else{return c&&((c=="down"&&d)||(c=="up"&&!d))}},_getDragVerticalDirection:function(){var c=this.positionAbs.top-this.lastPositionAbs.top;return c!=0&&(c>0?"down":"up")},_getDragHorizontalDirection:function(){var c=this.positionAbs.left-this.lastPositionAbs.left;return c!=0&&(c>0?"right":"left")},refresh:function(c){this._refreshItems(c);this.refreshPositions();return this},_connectWith:function(){var c=this.options;return c.connectWith.constructor==String?[c.connectWith]:c.connectWith},_getItemsAsjQuery:function(c){var m=this;var h=[];var f=[];var k=this._connectWith();if(k&&c){for(var e=k.length-1;e>=0;e--){var l=a(k[e]);for(var d=l.length-1;d>=0;d--){var g=a.data(l[d],"sortable");if(g&&g!=this&&!g.options.disabled){f.push([a.isFunction(g.options.items)?g.options.items.call(g.element):a(g.options.items,g.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),g])}}}}f.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var e=f.length-1;e>=0;e--){f[e][0].each(function(){h.push(this)})}return a(h)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data(sortable-item)");for(var d=0;d<this.items.length;d++){for(var c=0;c<e.length;c++){if(e[c]==this.items[d].item[0]){this.items.splice(d,1)}}}},_refreshItems:function(c){this.items=[];this.containers=[this];var k=this.items;var q=this;var g=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],c,{item:this.currentItem}):a(this.options.items,this.element),this]];var m=this._connectWith();if(m){for(var f=m.length-1;f>=0;f--){var n=a(m[f]);for(var e=n.length-1;e>=0;e--){var h=a.data(n[e],"sortable");if(h&&h!=this&&!h.options.disabled){g.push([a.isFunction(h.options.items)?h.options.items.call(h.element[0],c,{item:this.currentItem}):a(h.options.items,h.element),h]);this.containers.push(h)}}}}for(var f=g.length-1;f>=0;f--){var l=g[f][1];var d=g[f][0];for(var e=0,o=d.length;e<o;e++){var p=a(d[e]);p.data("sortable-item",l);k.push({item:p,instance:l,width:0,height:0,left:0,top:0})}}},refreshPositions:function(c){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}for(var e=this.items.length-1;e>=0;e--){var f=this.items[e];var d=this.options.toleranceElement?a(this.options.toleranceElement,f.item):f.item;if(!c){f.width=d.outerWidth();f.height=d.outerHeight()}var g=d.offset();f.left=g.left;f.top=g.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(var e=this.containers.length-1;e>=0;e--){var g=this.containers[e].element.offset();this.containers[e].containerCache.left=g.left;this.containers[e].containerCache.top=g.top;this.containers[e].containerCache.width=this.containers[e].element.outerWidth();this.containers[e].containerCache.height=this.containers[e].element.outerHeight()}}return this},_createPlaceholder:function(e){var c=e||this,f=c.options;if(!f.placeholder||f.placeholder.constructor==String){var d=f.placeholder;f.placeholder={element:function(){var g=a(document.createElement(c.currentItem[0].nodeName)).addClass(d||c.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];if(!d){g.style.visibility="hidden"}return g},update:function(g,h){if(d&&!f.forcePlaceholderSize){return}if(!h.height()){h.height(c.currentItem.innerHeight()-parseInt(c.currentItem.css("paddingTop")||0,10)-parseInt(c.currentItem.css("paddingBottom")||0,10))}if(!h.width()){h.width(c.currentItem.innerWidth()-parseInt(c.currentItem.css("paddingLeft")||0,10)-parseInt(c.currentItem.css("paddingRight")||0,10))}}}}c.placeholder=a(f.placeholder.element.call(c.element,c.currentItem));c.currentItem.after(c.placeholder);f.placeholder.update(c,c.placeholder)},_contactContainers:function(c){var e=null,l=null;for(var g=this.containers.length-1;g>=0;g--){if(a.ui.contains(this.currentItem[0],this.containers[g].element[0])){continue}if(this._intersectsWith(this.containers[g].containerCache)){if(e&&a.ui.contains(this.containers[g].element[0],e.element[0])){continue}e=this.containers[g];l=g}else{if(this.containers[g].containerCache.over){this.containers[g]._trigger("out",c,this._uiHash(this));this.containers[g].containerCache.over=0}}}if(!e){return}if(this.containers.length===1){this.containers[l]._trigger("over",c,this._uiHash(this));this.containers[l].containerCache.over=1}else{if(this.currentContainer!=this.containers[l]){var k=10000;var h=null;var d=this.positionAbs[this.containers[l].floating?"left":"top"];for(var f=this.items.length-1;f>=0;f--){if(!a.ui.contains(this.containers[l].element[0],this.items[f].item[0])){continue}var m=this.items[f][this.containers[l].floating?"left":"top"];if(Math.abs(m-d)<k){k=Math.abs(m-d);h=this.items[f]}}if(!h&&!this.options.dropOnEmpty){return}this.currentContainer=this.containers[l];h?this._rearrange(c,h,null,true):this._rearrange(c,null,this.containers[l].element,true);this._trigger("change",c,this._uiHash());this.containers[l]._trigger("change",c,this._uiHash(this));this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[l]._trigger("over",c,this._uiHash(this));this.containers[l].containerCache.over=1}}},_createHelper:function(d){var e=this.options;var c=a.isFunction(e.helper)?a(e.helper.apply(this.element[0],[d,this.currentItem])):(e.helper=="clone"?this.currentItem.clone():this.currentItem);if(!c.parents("body").length){a(e.appendTo!="parent"?e.appendTo:this.currentItem[0].parentNode)[0].appendChild(c[0])}if(c[0]==this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}}if(c[0].style.width==""||e.forceHelperSize){c.width(this.currentItem.width())}if(c[0].style.height==""||e.forceHelperSize){c.height(this.currentItem.height())}return c},_adjustOffsetFromHelper:function(c){if(typeof c=="string"){c=c.split(" ")}if(a.isArray(c)){c={left:+c[0],top:+c[1]||0}}if("left" in c){this.offset.click.left=c.left+this.margins.left}if("right" in c){this.offset.click.left=this.helperProportions.width-c.right+this.margins.left}if("top" in c){this.offset.click.top=c.top+this.margins.top}if("bottom" in c){this.offset.click.top=this.helperProportions.height-c.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var c=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])){c.left+=this.scrollParent.scrollLeft();c.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)){c={top:0,left:0}}return{top:c.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:c.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var c=this.currentItem.position();return{top:c.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:c.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var f=this.options;if(f.containment=="parent"){f.containment=this.helper[0].parentNode}if(f.containment=="document"||f.containment=="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a(f.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a(f.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(f.containment)){var d=a(f.containment)[0];var e=a(f.containment).offset();var c=(a(d).css("overflow")!="hidden");this.containment=[e.left+(parseInt(a(d).css("borderLeftWidth"),10)||0)+(parseInt(a(d).css("paddingLeft"),10)||0)-this.margins.left,e.top+(parseInt(a(d).css("borderTopWidth"),10)||0)+(parseInt(a(d).css("paddingTop"),10)||0)-this.margins.top,e.left+(c?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(a(d).css("borderLeftWidth"),10)||0)-(parseInt(a(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,e.top+(c?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(a(d).css("borderTopWidth"),10)||0)-(parseInt(a(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(g,i){if(!i){i=this.position}var e=g=="absolute"?1:-1;var f=this.options,c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,h=(/(html|body)/i).test(c[0].tagName);return{top:(i.top+this.offset.relative.top*e+this.offset.parent.top*e-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(h?0:c.scrollTop()))*e)),left:(i.left+this.offset.relative.left*e+this.offset.parent.left*e-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():h?0:c.scrollLeft())*e))}},_generatePosition:function(f){var i=this.options,c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,j=(/(html|body)/i).test(c[0].tagName);if(this.cssPosition=="relative"&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}var e=f.pageX;var d=f.pageY;if(this.originalPosition){if(this.containment){if(f.pageX-this.offset.click.left<this.containment[0]){e=this.containment[0]+this.offset.click.left}if(f.pageY-this.offset.click.top<this.containment[1]){d=this.containment[1]+this.offset.click.top}if(f.pageX-this.offset.click.left>this.containment[2]){e=this.containment[2]+this.offset.click.left}if(f.pageY-this.offset.click.top>this.containment[3]){d=this.containment[3]+this.offset.click.top}}if(i.grid){var h=this.originalPageY+Math.round((d-this.originalPageY)/i.grid[1])*i.grid[1];d=this.containment?(!(h-this.offset.click.top<this.containment[1]||h-this.offset.click.top>this.containment[3])?h:(!(h-this.offset.click.top<this.containment[1])?h-i.grid[1]:h+i.grid[1])):h;var g=this.originalPageX+Math.round((e-this.originalPageX)/i.grid[0])*i.grid[0];e=this.containment?(!(g-this.offset.click.left<this.containment[0]||g-this.offset.click.left>this.containment[2])?g:(!(g-this.offset.click.left<this.containment[0])?g-i.grid[0]:g+i.grid[0])):g}}return{top:(d-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(j?0:c.scrollTop())))),left:(e-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():j?0:c.scrollLeft())))}},_rearrange:function(h,g,d,f){d?d[0].appendChild(this.placeholder[0]):g.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction=="down"?g.item[0]:g.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var e=this,c=this.counter;window.setTimeout(function(){if(c==e.counter){e.refreshPositions(!f)}},0)},_clear:function(e,f){this.reverting=false;var g=[],c=this;if(!this._noFinalSort&&this.currentItem[0].parentNode){this.placeholder.before(this.currentItem)}this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var d in this._storedCSS){if(this._storedCSS[d]=="auto"||this._storedCSS[d]=="static"){this._storedCSS[d]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!f){g.push(function(h){this._trigger("receive",h,this._uiHash(this.fromOutside))})}if((this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!f){g.push(function(h){this._trigger("update",h,this._uiHash())})}if(!a.ui.contains(this.element[0],this.currentItem[0])){if(!f){g.push(function(h){this._trigger("remove",h,this._uiHash())})}for(var d=this.containers.length-1;d>=0;d--){if(a.ui.contains(this.containers[d].element[0],this.currentItem[0])&&!f){g.push((function(h){return function(i){h._trigger("receive",i,this._uiHash(this))}}).call(this,this.containers[d]));g.push((function(h){return function(i){h._trigger("update",i,this._uiHash(this))}}).call(this,this.containers[d]))}}}for(var d=this.containers.length-1;d>=0;d--){if(!f){g.push((function(h){return function(i){h._trigger("deactivate",i,this._uiHash(this))}}).call(this,this.containers[d]))}if(this.containers[d].containerCache.over){g.push((function(h){return function(i){h._trigger("out",i,this._uiHash(this))}}).call(this,this.containers[d]));this.containers[d].containerCache.over=0}}if(this._storedCursor){a("body").css("cursor",this._storedCursor)}if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity)}if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex)}this.dragging=false;if(this.cancelHelperRemoval){if(!f){this._trigger("beforeStop",e,this._uiHash());for(var d=0;d<g.length;d++){g[d].call(this,e)}this._trigger("stop",e,this._uiHash())}return false}if(!f){this._trigger("beforeStop",e,this._uiHash())}this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(this.helper[0]!=this.currentItem[0]){this.helper.remove()}this.helper=null;if(!f){for(var d=0;d<g.length;d++){g[d].call(this,e)}this._trigger("stop",e,this._uiHash())}this.fromOutside=false;return true},_trigger:function(){if(a.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel()}},_uiHash:function(d){var c=d||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:d?d.element:null}}});a.extend(a.ui.sortable,{version:"1.8.9"})})(jQuery);(function(a){a.fn.charCount=function(b){var d={allowed:140,warning:25,css:"counter",counterElement:"span",cssWarning:"warning",cssExceeded:"exceeded",counterText:""};var b=a.extend(d,b);function c(g){var e=a(g).val().length;var f=b.allowed-e;if(f<=b.warning&&f>=0){a(g).next().addClass(b.cssWarning)}else{a(g).next().removeClass(b.cssWarning)}if(f<0){a(g).next().addClass(b.cssExceeded)}else{a(g).next().removeClass(b.cssExceeded)}a(g).next().html(b.counterText+f)}this.each(function(){a(this).after("<"+b.counterElement+' class="'+b.css+'">'+b.counterText+"</"+b.counterElement+">");c(this);a(this).keyup(function(){c(this)});a(this).change(function(){c(this)})})}})(jQuery);(function(b){function a(g,d){var c=this,f,e;return function(){e=Array.prototype.slice.call(arguments,0),f=clearTimeout(f,e),f=setTimeout(function(){g.apply(c,e);f=0},d);return this}}b.extend(b.fn,{debounce:function(d,e,c){this.bind(d,a.apply(this,[e,c]))}})})(jQuery);
/*!
 * jQuery Expander Plugin v1.3
 *
 * Date: Sat Sep 17 00:37:34 2011 EDT
 * Requires: jQuery v1.3+
 *
 * Copyright 2011, Karl Swedberg
 * Dual licensed under the MIT and GPL licenses (just like jQuery):
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 *
 *
 *
*/
(function(a){a.expander={version:"1.3",defaults:{slicePoint:100,preserveWords:true,widow:4,expandText:"read more",expandPrefix:"&hellip; ",summaryClass:"summary",detailClass:"details",moreClass:"read-more",lessClass:"read-less",collapseTimer:0,expandEffect:"fadeIn",expandSpeed:250,collapseEffect:"fadeOut",collapseSpeed:200,userCollapse:true,userCollapseText:"read less",userCollapsePrefix:" ",onSlice:null,beforeExpand:null,afterExpand:null,onCollapse:null}};a.fn.expander=function(o){var b=a.extend({},a.expander.defaults,o),d=/^<(?:area|br|col|embed|hr|img|input|link|meta|param).*>$/i,j=/(&(?:[^;]+;)?|\w+)$/,i=/<\/?(\w+)[^>]*>/g,f=/<(\w+)[^>]*>/g,k=/<\/(\w+)>/g,l=/^<[^>]+>.?/,m;this.each(function(){var L,K,P,w,N,G,r,Q,I,M,u=[],E=[],v={},O=this,z=a(this),x=a([]),J=a.meta?a.extend({},b,z.data()):b,q=!!z.find("."+J.detailClass).length,A=!!z.find("*").filter(function(){var R=a(this).css("display");return(/^block|table|list/).test(R)}).length,t=A?"div":"span",C=t+"."+J.detailClass,H="span."+J.moreClass,p=J.expandSpeed||0,y=a.trim(z.html()),B=a.trim(z.text()),D=y.slice(0,J.slicePoint);if(a.data(this,"expander")){return}a.data(this,"expander",true);a.each(["onSlice","beforeExpand","afterExpand","onCollapse"],function(R,S){v[S]=a.isFunction(J[S])});D=h(D);summTagless=D.replace(i,"").length;while(summTagless<J.slicePoint){newChar=y.charAt(D.length);if(newChar=="<"){newChar=y.slice(D.length).match(l)[0]}D+=newChar;summTagless++}D=h(D,J.preserveWords);N=D.match(f)||[];G=D.match(k)||[];P=[];a.each(N,function(R,S){if(!d.test(S)){P.push(S)}});N=P;K=G.length;for(L=0;L<K;L++){G[L]=G[L].replace(k,"$1")}a.each(N,function(R,U){var S=U.replace(f,"$1");var T=a.inArray(S,G);if(T===-1){u.push(U);E.push("</"+S+">")}else{G.splice(T,1)}});E.reverse();if(!q){Q=y.slice(D.length);if(Q.split(/\s+/).length<J.widow&&!q){return}r=E.pop()||"";D+=E.join("");Q=u.join("")+Q}else{Q=z.find(C).remove().html();D=z.html();y=D+Q;r=""}J.moreLabel=z.find(H).length?"":n(J);if(A){Q=y}D+=r;J.summary=D;J.details=Q;J.lastCloseTag=r;if(v.onSlice){P=J.onSlice.call(O,J);J=P&&P.details?P:J}var F=e(J,A);z.html(F);I=z.find(C);M=z.find(H);I.hide();M.find("a").unbind("click.expander").bind("click.expander",s);x=z.find("div."+J.summaryClass);if(J.userCollapse&&!z.find("span."+J.lessClass).length){z.find(C).append('<span class="'+J.lessClass+'">'+J.userCollapsePrefix+'<a href="#">'+J.userCollapseText+"</a></span>")}z.find("span."+J.lessClass+" a").unbind("click.expander").bind("click.expander",function(R){R.preventDefault();clearTimeout(m);var S=a(this).closest(C);c(J,S);if(v.onCollapse){J.onCollapse.call(O,true)}});function s(R){R.preventDefault();M.hide();x.hide();if(v.beforeExpand){J.beforeExpand.call(O)}I.stop(false,true)[J.expandEffect](p,function(){I.css({zoom:""});if(v.afterExpand){J.afterExpand.call(O)}g(J,I,O)})}});function e(s,r){var q="span",p=s.summary;if(r){q="div";p=p.replace(/(<\/[^>]+>)\s*$/,s.moreLabel+"$1");p='<div class="'+s.summaryClass+'">'+p+"</div>"}else{p+=s.moreLabel}return[p,"<",q+' class="'+s.detailClass+'"',">",s.details,"</"+q+">"].join("")}function n(q){var p='<span class="'+q.moreClass+'">'+q.expandPrefix;p+='<a href="#">'+q.expandText+"</a></span>";return p}function h(p,q){if(p.lastIndexOf("<")>p.lastIndexOf(">")){p=p.slice(0,p.lastIndexOf("<"))}if(q){p=p.replace(j,"")}return p}function c(q,p){p.stop(true,true)[q.collapseEffect](q.collapseSpeed,function(){var r=p.prev("span."+q.moreClass).show();if(!r.length){p.parent().children("div."+q.summaryClass).show().find("span."+q.moreClass).show()}})}function g(q,p,r){if(q.collapseTimer){m=setTimeout(function(){c(q,p);if(a.isFunction(q.onCollapse)){q.onCollapse.call(r,false)}},q.collapseTimer)}}return this};a.fn.expander.defaults=a.expander.defaults})(jQuery);(function(d){d.timeago=function(g){if(g instanceof Date){return a(g)}else{if(typeof g=="string"){return a(d.timeago.parse(g))}else{return a(d.timeago.datetime(g))}}};var f=d.timeago;d.extend(d.timeago,{settings:{refreshMillis:60000,allowFuture:false,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",numbers:[]}},inWords:function(l){var m=this.settings.strings;var i=m.prefixAgo;var q=m.suffixAgo;if(this.settings.allowFuture){if(l<0){i=m.prefixFromNow;q=m.suffixFromNow}l=Math.abs(l)}var o=l/1000;var g=o/60;var n=g/60;var p=n/24;var j=p/365;function h(r,t){var s=d.isFunction(r)?r(t,l):r;var u=(m.numbers&&m.numbers[t])||t;return s.replace(/%d/i,u)}var k=o<45&&h(m.seconds,Math.round(o))||o<90&&h(m.minute,1)||g<45&&h(m.minutes,Math.round(g))||g<90&&h(m.hour,1)||n<24&&h(m.hours,Math.round(n))||n<48&&h(m.day,1)||p<30&&h(m.days,Math.floor(p))||p<60&&h(m.month,1)||p<365&&h(m.months,Math.floor(p/30))||j<2&&h(m.year,1)||h(m.years,Math.floor(j));return d.trim([i,k,q].join(" "))},parse:function(h){var g=d.trim(h);g=g.replace(/\.\d\d\d+/,"");g=g.replace(/-/,"/").replace(/-/,"/");g=g.replace(/T/," ").replace(/Z/," UTC");g=g.replace(/([\+-]\d\d)\:?(\d\d)/," $1$2");return new Date(g)},datetime:function(h){var i=d(h).get(0).tagName.toLowerCase()=="time";var g=i?d(h).attr("datetime"):d(h).attr("title");return f.parse(g)}});d.fn.timeago=function(){var h=this;h.each(c);var g=f.settings;if(g.refreshMillis>0){setInterval(function(){h.each(c)},g.refreshMillis)}return h};function c(){var g=b(this);if(!isNaN(g.datetime)){d(this).text(a(g.datetime))}return this}function b(g){g=d(g);if(!g.data("timeago")){g.data("timeago",{datetime:f.datetime(g)});var h=d.trim(g.text());if(h.length>0){g.attr("title",h)}}return g.data("timeago")}function a(g){return f.inWords(e(g))}function e(g){return(new Date().getTime()-g.getTime())}document.createElement("abbr");document.createElement("time")})(jQuery);(function(){var a=function(){var b=function(){};b.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true},context:{},render:function(f,e,d,g){if(!g){this.context=e;this.buffer=[]}if(!this.includes("",f)){if(g){return f}else{this.send(f);return}}f=this.render_pragmas(f);var c=this.render_section(f,e,d);if(g){return this.render_tags(c,e,d,g)}this.render_tags(c,e,d,g)},send:function(c){if(c!=""){this.buffer.push(c)}},render_pragmas:function(c){if(!this.includes("%",c)){return c}var e=this;var d=new RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag);return c.replace(d,function(h,f,g){if(!e.pragmas_implemented[f]){throw ({message:"This implementation of mustache doesn't understand the '"+f+"' pragma"})}e.pragmas[f]={};if(g){var i=g.split("=");e.pragmas[f][i[0]]=i[1]}return""})},render_partial:function(c,e,d){c=this.trim(c);if(!d||d[c]===undefined){throw ({message:"unknown_partial '"+c+"'"})}if(typeof(e[c])!="object"){return this.render(d[c],e,d,true)}return this.render(d[c],e[c],d,true)},render_section:function(e,d,c){if(!this.includes("#",e)&&!this.includes("^",e)){return e}var g=this;var f=new RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg");return e.replace(f,function(i,j,h,k){var l=g.find(h,d);if(j=="^"){if(!l||g.is_array(l)&&l.length===0){return g.render(k,d,c,true)}else{return""}}else{if(j=="#"){if(g.is_array(l)){return g.map(l,function(m){return g.render(k,g.create_context(m),c,true)}).join("")}else{if(g.is_object(l)){return g.render(k,g.create_context(l),c,true)}else{if(typeof l==="function"){return l.call(d,k,function(m){return g.render(m,d,c,true)})}else{if(l){return g.render(k,d,c,true)}else{return""}}}}}}})},render_tags:function(l,c,e,g){var f=this;var k=function(){return new RegExp(f.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+f.ctag+"+","g")};var h=k();var j=function(o,i,n){switch(i){case"!":return"";case"=":f.set_delimiters(n);h=k();return"";case">":return f.render_partial(n,c,e);case"{":return f.find(n,c);default:return f.escape(f.find(n,c))}};var m=l.split("\n");for(var d=0;d<m.length;d++){m[d]=m[d].replace(h,j,this);if(!g){this.send(m[d])}}if(g){return m.join("\n")}},set_delimiters:function(d){var c=d.split(" ");this.otag=this.escape_regex(c[0]);this.ctag=this.escape_regex(c[1])},escape_regex:function(d){if(!arguments.callee.sRE){var c=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+c.join("|\\")+")","g")}return d.replace(arguments.callee.sRE,"\\$1")},find:function(d,e){d=this.trim(d);function c(g){return g===false||g===0||g}var f;if(c(e[d])){f=e[d]}else{if(c(this.context[d])){f=this.context[d]}}if(typeof f==="function"){return f.apply(e)}if(f!==undefined){return f}return""},includes:function(d,c){return c.indexOf(this.otag+d)!=-1},escape:function(c){c=String(c===null?"":c);return c.replace(/&(?!\w+;)|["'<>\\]/g,function(d){switch(d){case"&":return"&amp;";case"\\":return"\\\\";case'"':return"&quot;";case"'":return"&#39;";case"<":return"&lt;";case">":return"&gt;";default:return d}})},create_context:function(d){if(this.is_object(d)){return d}else{var e=".";if(this.pragmas["IMPLICIT-ITERATOR"]){e=this.pragmas["IMPLICIT-ITERATOR"].iterator}var c={};c[e]=d;return c}},is_object:function(c){return c&&typeof c=="object"},is_array:function(c){return Object.prototype.toString.call(c)==="[object Array]"},trim:function(c){return c.replace(/^\s*|\s*$/g,"")},map:function(g,e){if(typeof g.map=="function"){return g.map(e)}else{var f=[];var c=g.length;for(var d=0;d<c;d++){f.push(e(g[d]))}return f}}};return({name:"mustache.js",version:"0.3.1-dev",to_html:function(e,c,d,g){var f=new b();if(g){f.send=g}f.render(e,c,d);if(!g){return f.buffer.join("\n")}}})}();$.mustache=function(d,b,c,e){return a.to_html(d,b,c,e)}})();(function(f){f.facebox=function(m,l){f.facebox.loading();if(m.ajax){g(m.ajax,l)}else{if(m.image){c(m.image,l)}else{if(m.div){j(m.div,l)}else{if(f.isFunction(m)){m.call(f)}else{f.facebox.reveal(m,l)}}}}};f.extend(f.facebox,{settings:{opacity:0.2,overlay:true,loadingImage:"/facebox/loading.gif",closeImage:"/facebox/closelabel.png",imageTypes:["png","jpg","jpeg","gif"],faceboxHtml:'    <div id="facebox" style="display:none;">       <div class="popup">         <div class="content">         </div>         <a href="#" class="close"></a>       </div>     </div>'},loading:function(){k();if(f("#facebox .loading").length==1){return true}e();f("#facebox .content").empty().append('<div class="loading"><img src="'+f.facebox.settings.loadingImage+'"/></div>');f("#facebox").show().css({top:h()[1]+(i()/10),left:f(window).width()/2-(f("#facebox .popup").outerWidth()/2)});f(document).bind("keydown.facebox",function(l){if(l.keyCode==27){f.facebox.close()}return true});f(document).trigger("loading.facebox")},reveal:function(m,l){f(document).trigger("beforeReveal.facebox");if(l){f("#facebox .content").addClass(l)}f("#facebox .content").empty().append(m);f("#facebox .popup").children().fadeIn("normal");f("#facebox").css("left",f(window).width()/2-(f("#facebox .popup").outerWidth()/2));f(document).trigger("reveal.facebox").trigger("afterReveal.facebox")},close:function(){f(document).trigger("close.facebox");return false}});f.fn.facebox=function(l){if(f(this).length==0){return}k(l);function m(){f.facebox.loading(true);var n=this.rel.match(/facebox\[?\.(\w+)\]?/);if(n){n=n[1]}j(this.href,n);return false}return this.bind("click.facebox",m)};function k(n){if(f.facebox.settings.inited){return true}else{f.facebox.settings.inited=true}f(document).trigger("init.facebox");d();var l=f.facebox.settings.imageTypes.join("|");f.facebox.settings.imageTypesRegexp=new RegExp("\\.("+l+")(\\?.*)?$","i");if(n){f.extend(f.facebox.settings,n)}f("body").append(f.facebox.settings.faceboxHtml);var m=[new Image(),new Image()];m[0].src=f.facebox.settings.closeImage;m[1].src=f.facebox.settings.loadingImage;f("#facebox").find(".b:first, .bl").each(function(){m.push(new Image());m.slice(-1).src=f(this).css("background-image").replace(/url\((.+)\)/,"$1")});f("#facebox .close").click(f.facebox.close).append('<img src="'+f.facebox.settings.closeImage+'" class="close_image" title="close">')}function h(){var m,l;if(self.pageYOffset){l=self.pageYOffset;m=self.pageXOffset}else{if(document.documentElement&&document.documentElement.scrollTop){l=document.documentElement.scrollTop;m=document.documentElement.scrollLeft}else{if(document.body){l=document.body.scrollTop;m=document.body.scrollLeft}}}return new Array(m,l)}function i(){var l;if(self.innerHeight){l=self.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){l=document.documentElement.clientHeight}else{if(document.body){l=document.body.clientHeight}}}return l}function d(){var l=f.facebox.settings;l.loadingImage=l.loading_image||l.loadingImage;l.closeImage=l.close_image||l.closeImage;l.imageTypes=l.image_types||l.imageTypes;l.faceboxHtml=l.facebox_html||l.faceboxHtml}function j(m,l){if(m.match(/#/)){var n=window.location.href.split("#")[0];var o=m.replace(n,"");if(o=="#"){return}f.facebox.reveal(f(o).html(),l)}else{if(m.match(f.facebox.settings.imageTypesRegexp)){c(m,l)}else{g(m,l)}}}function c(m,l){var n=new Image();n.onload=function(){f.facebox.reveal('<div class="image"><img src="'+n.src+'" /></div>',l)};n.src=m}function g(m,l){f.get(m,function(n){f.facebox.reveal(n,l)})}function b(){return f.facebox.settings.overlay==false||f.facebox.settings.opacity===null}function e(){if(b()){return}if(f("#facebox_overlay").length==0){f("body").append('<div id="facebox_overlay" class="facebox_hide"></div>')}f("#facebox_overlay").hide().addClass("facebox_overlayBG").css("opacity",f.facebox.settings.opacity).click(function(){f(document).trigger("close.facebox")}).fadeIn(200);return false}function a(){if(b()){return}f("#facebox_overlay").fadeOut(200,function(){f("#facebox_overlay").removeClass("facebox_overlayBG");f("#facebox_overlay").addClass("facebox_hide");f("#facebox_overlay").remove()});return false}f(document).bind("close.facebox",function(){f(document).unbind("keydown.facebox");f("#facebox").fadeOut(function(){f("#facebox .content").removeClass().addClass("content");f("#facebox .loading").remove();f(document).trigger("afterClose.facebox")});a()})})(jQuery);
/*!
// Infinite Scroll jQuery plugin
// copyright Paul Irish, licensed GPL & MIT
// version 2.0b1.110420

// home and docs: http://www.infinite-scroll.com
// Modified by Diaspora:
// A few callbacks were made options and generateInstanceID was make jquery 162 compatible
*/
(function(g){g.fn.infinitescroll=function i(s,u){function K(O){var M=g.fn.infinitescroll._debug;for(var N in O){if(N.indexOf&&N.indexOf("Selector")>-1&&g(O[N]).length===0){M("Your "+N+" found no elements.");return false}return true}}function I(M){if(g.isFunction(C.pathParse)){D("pathParse");return[M]}else{if(M.match(/^(.*?)\b2\b(.*?$)/)){M=M.match(/^(.*?)\b2\b(.*?$)/).slice(1)}else{if(M.match(/^(.*?)2(.*?$)/)){if(M.match(/^(.*?page=)2(\/.*|$)/)){M=M.match(/^(.*?page=)2(\/.*|$)/).slice(1);return M}M=M.match(/^(.*?)2(.*?$)/).slice(1)}else{if(M.match(/^(.*?page=)1(\/.*|$)/)){M=M.match(/^(.*?page=)1(\/.*|$)/).slice(1);return M}else{D("Sorry, we couldn't parse your Next (Previous Posts) URL. Verify your the css selector points to the correct A tag. If you still get this error: yell, scream, and kindly ask for help at infinite-scroll.com.");r.isInvalidPage=true}}}}D("determinePath",M);return M}function y(N){var M=0;g(N).children().each(function(){M=M+g(this).outerHeight(false)});return M}function L(N){var M=g(N);var O=M.length+M.html().length;if(M.attr("class")!==undefined){O+=M.attr("class").length}if(M.attr("id")!==undefined){O+=M.attr("id").length}C.infid=O}if(typeof s=="string"){var t=s,A=u,w=(t=="pause"||t=="destroy"||t=="retrieve"||t=="binding"),D=g.fn.infinitescroll._debug;A=A||null;t=(w)?g.fn.infinitescroll[t](A):D("Invalid command");return false}var C=g.infinitescroll.opts=g.extend({},g.infinitescroll.defaults,s),r=g.infinitescroll,x,z,p,J,v,H,G,q,B;u=g.fn.infinitescroll._callback=u||function(){},D=g.fn.infinitescroll._debug,H=g.fn.infinitescroll._error,v=g.fn.infinitescroll.pause,destroy=g.fn.infinitescroll.destroy,binding=g.fn.infinitescroll.binding;if(!K(C)){return false}C.container=C.container||document.documentElement;C.contentSelector=C.contentSelector||this;C.infid=(C.infid==0)?L(C.contentSelector):C.infid;C.loadMsgSelector=C.loadMsgSelector||C.contentSelector;var F=/(.*?\/\/).*?(\/.*)/,E=g(C.nextSelector).attr("href");if(!E){D("Navigation selector not found");return}C.path=I(E);r.loadingMsg=g('<div id="infscr-loading" style="text-align: center;"><img alt="Loading..." src="'+C.loadingImg+'" /><div>'+C.loadingText+"</div></div>");(new Image()).src=C.loadingImg;C.binder=(C.container.nodeName=="HTML")?g(window):g(C.container);x=(C.container.nodeName=="HTML")?g(document).height():x=y(C.container);D("Scrolling in: ",(C.container.nodeName=="HTML")?"window":C.container);C.pixelsFromNavToBottom=x+(C.container==document.documentElement?0:g(C.container).offset().top)-g(C.navSelector).offset().top;binding("bind");C.binder.trigger("smartscroll.infscr."+C.infid);return this};g.infinitescroll={defaults:{debug:false,binder:g(window),preload:false,nextSelector:"div.navigation a:first",loadingImg:"http://www.infinite-scroll.com/loading.gif",loadingText:"<em>Loading the next set of posts...</em>",donetext:"<em>Congratulations, you've reached the end of the internet.</em>",navSelector:"div.navigation",contentSelector:null,loadMsgSelector:null,loadingMsgRevealSpeed:"fast",extraScrollPx:150,itemSelector:"div.post",animate:false,pathParse:undefined,dataType:"html",appendCallback:true,bufferPx:40,orientation:"height",errorCallback:function(){},currPage:1,infid:0,isDuringAjax:false,isInvalidPage:false,isDestroyed:false,isDone:false,isPaused:false,container:undefined,pixelsFromNavToBottom:undefined,path:undefined},loadingImg:undefined,loadingMsg:undefined,currDOMChunk:null};g.fn.infinitescroll._debug=function o(){if(g.infinitescroll.opts.debug){return window.console&&console.log.call(console,arguments)}};g.fn.infinitescroll._shorthand=function e(){};g.fn.infinitescroll._nearbottom=function j(){var s=g.infinitescroll.opts,q=g.fn.infinitescroll._debug,r=g.fn.infinitescroll._hiddenheight;if(s.container.nodeName=="HTML"){var p=0+g(document).height()-(g(s.container).scrollTop()||g(s.container.ownerDocument.body).scrollTop())-g(window).height()}else{var p=0+r(s.container)-g(s.container).scrollTop()-g(s.container).height()}q("math:",p,s.pixelsFromNavToBottom);return(p-s.bufferPx<s.pixelsFromNavToBottom)};g.fn.infinitescroll._setup=function b(){var p=g.infinitescroll,s=g.infinitescroll.opts,r=g.fn.infinitescroll._nearbottom,q=g.fn.infinitescroll.retrieve;if(s.isDuringAjax||s.isInvalidPage||s.isDone||s.isDestroyed||s.isPaused){return}if(!r(s,p)){return}q()};g.fn.infinitescroll.retrieve=function m(){var w=g.infinitescroll,q=w.opts,r=g.fn.infinitescroll._debug,u=g.fn.infinitescroll._loadcallback,x=g.fn.infinitescroll._error,A=q.path,v,y,z,p,s;q.isDuringAjax=true;w.loadingMsg.appendTo(q.loadMsgSelector).show();g(q.navSelector).hide();q.currPage++;r("heading into ajax",A);v=g(q.contentSelector).is("table")?g("<tbody/>"):g("<div/>");z=(g.isFunction(q.pathParse))?q.pathParse(A.join("2"),q.currPage):z=A.join(q.currPage);p=(q.dataType=="html"||q.dataType=="json")?q.dataType:"html+callback";if(q.appendCallback&&q.dataType=="html"){p+="+callback"}switch(p){case"html+callback":r("Using HTML via .load() method");v.load(z+" "+q.itemSelector,null,function(B,C){u(v,B.responseText)});break;case"html":case"json":r("Using "+(p.toUpperCase())+" via $.ajax() method");g.ajax({url:z,dataType:q.dataType,complete:function t(B,C){s=(typeof(B.isResolved)!=="undefined")?(B.isResolved()):(C==="success"||C==="notmodified");(s)?u(v,B.responseText):x([404])}});break}};g.fn.infinitescroll._loadcallback=function n(s,r){var u=g.infinitescroll,p=g.infinitescroll.opts,v=g.fn.infinitescroll._error,w=g.fn.infinitescroll._donemsg,x=g.fn.infinitescroll._callback,z,y;z=(p.isDone)?"done":(!p.appendCallback)?"no-append":"append";switch(z){case"done":w();return false;break;case"no-append":if(p.dataType=="html"){r="<div>"+r+"</div>";r=g(r).find(p.itemSelector)}break;case"append":var q=s.children();if(q.length==0||q.hasClass("error404")){return v([404])}y=document.createDocumentFragment();while(s[0].firstChild){y.appendChild(s[0].firstChild)}g(p.contentSelector)[0].appendChild(y);r=q.get();break}u.loadingMsg.hide();if(p.animate){var t=g(window).scrollTop()+g("#infscr-loading").height()+p.extraScrollPx+"px";g("html,body").animate({scrollTop:t},800,function(){p.isDuringAjax=false})}if(!p.animate){p.isDuringAjax=false}x.call(g(p.contentSelector)[0],r)};g.fn.infinitescroll._donemsg=function c(){var p=g.infinitescroll,q=g.infinitescroll.opts;p.loadingMsg.find("img").hide().parent().find("div").html(q.donetext).animate({opacity:1},2000,function(){g(this).parent().fadeOut("normal")});q.errorCallback()};g.fn.infinitescroll.pause=function k(r){var p=g.fn.infinitescroll._debug,q=g.infinitescroll.opts;if(r!=="pause"&&r!=="resume"&&r!=="toggle"&&r!==null){p("Invalid argument. Toggling pause value instead")}r=(r&&(r=="pause"||r=="resume"))?r:"toggle";switch(r){case"pause":q.isPaused=true;break;case"resume":q.isPaused=false;break;case"toggle":q.isPaused=!q.isPaused;break}p("Paused",q.isPaused);return false};g.fn.infinitescroll._error=function h(u){var t=g.infinitescroll.opts,q=(t.container.nodeName=="HTML")?g(window):g(t.container),r=g.fn.infinitescroll._debug,p=g.fn.infinitescroll._donemsg,s=(!t.isDone&&u==404)?"end":(t.isDestroyed&&u==302)?"destroy":"unknown";switch(s){case"end":r("Page not found. Self-destructing...");p();t.isDone=true;t.currPage=1;t.isPaused=false;q.unbind("smartscroll.infscr."+t.infid);break;case"destroy":r("Destroyed. Going to next instance...");t.isDone=true;t.currPage=1;t.isPaused=false;q.unbind("smartscroll.infscr."+t.infid);break;case"unknown":r("Unknown Error. WHAT DID YOU DO?!...");p();t.isDone=true;t.currPage=1;q.unbind("smartscroll.infscr."+t.infid);break}};g.fn.infinitescroll.destroy=function d(){var q=g.infinitescroll.opts,p=g.fn.infinitescroll._error;q.isDestroyed=true;return p([302])};g.fn.infinitescroll.binding=function f(t){var s=g.infinitescroll.opts,p=g.fn.infinitescroll._setup,r=g.fn.infinitescroll._error,q=g.fn.infinitescroll._debug;switch(t){case"bind":s.binder.bind("smartscroll.infscr."+s.infid,p);break;case"unbind":s.binder.unbind("smartscroll.infscr."+s.infid);break}q("Binding",t);return false};var a=g.event,l;a.special.smartscroll={setup:function(){g(this).bind("scroll",a.special.smartscroll.handler)},teardown:function(){g(this).unbind("scroll",a.special.smartscroll.handler)},handler:function(s,p){var r=this,q=arguments;s.type="smartscroll";if(l){clearTimeout(l)}l=setTimeout(function(){jQuery.event.handle.apply(r,q)},p==="execAsap"?0:100)}};g.fn.smartscroll=function(p){return p?this.bind("smartscroll",p):this.trigger("smartscroll",["execAsap"])}})(jQuery);(function(a){a.fn.extend({autocomplete:function(b,c){var d=typeof b=="string";c=a.extend({},a.Autocompleter.defaults,{url:d?b:null,data:d?null:b,delay:d?a.Autocompleter.defaults.delay:10,max:c&&!c.scroll?10:150},c);c.highlight=c.highlight||function(e){return e};c.formatMatch=c.formatMatch||c.formatItem;return this.each(function(){new a.Autocompleter(this,c)})},result:function(b){return this.bind("result",b)},search:function(b){return this.trigger("search",[b])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(b){return this.trigger("setOptions",[b])},unautocomplete:function(){return this.trigger("unautocomplete")}});a.Autocompleter=function(k,g){var c=KEYCODES;var b=a(k).attr("autocomplete","off").addClass(g.inputClass);var i;var o="";var l=a.Autocompleter.Cache(g);var e=0;var t;var w={mouseDownOnSelect:false};var q=a.Autocompleter.Select(g,k,d,w);var v;a.browser.opera&&a(k.form).bind("submit.autocomplete",function(){if(v){v=false;return false}});b.bind((a.browser.opera?"keypress":"keydown")+".autocomplete",function(x){t=x.keyCode;switch(x.keyCode){case c.LEFT:case c.RIGHT:if(g.disableRightAndLeft&&q.visible()){x.preventDefault()}break;case c.UP:if(q.visible()){x.preventDefault();q.prev()}else{s(0,true)}break;case c.DOWN:if(q.visible()){x.preventDefault();q.next()}else{s(0,true)}break;case c.PAGEUP:if(q.visible()){x.preventDefault();q.pageUp()}else{s(0,true)}break;case c.PAGEDOWN:if(q.visible()){x.preventDefault();q.pageDown()}else{s(0,true)}break;case g.multiple&&a.trim(g.multipleSeparator)==","&&c.COMMA:case c.TAB:case c.RETURN:if(d()){x.preventDefault();v=true;return false}break;case c.ESC:q.hide();break;default:g.onLetterTyped(x,b);clearTimeout(i);i=setTimeout(s,g.delay);break}}).focus(function(){e++}).blur(function(){e=0;if(!w.mouseDownOnSelect){r()}}).click(function(){if(e++>1&&!q.visible()){s(0,true)}}).bind("search",function(){var x=(arguments.length>1)?arguments[1]:null;function y(C,B){var z;if(B&&B.length){for(var A=0;A<B.length;A++){if(B[A].result.toLowerCase()==C.toLowerCase()){z=B[A];break}}}if(typeof x=="function"){x(z)}else{b.trigger("result",z&&[z.data,z.value])}}a.each(h(b.val()),function(z,A){f(A,y,y)})}).bind("flushCache",function(){l.flush()}).bind("setOptions",function(){a.extend(g,arguments[1]);if("data" in arguments[1]){l.populate()}}).bind("unautocomplete",function(){q.unbind();b.unbind();a(k.form).unbind(".autocomplete")});function d(){var y=q.selected();if(!y){return false}var x=y.result;o=x;if(g.multiple){var z=h(b.val());if(z.length>1){x=z.slice(0,z.length-1).join(g.multipleSeparator)+g.multipleSeparator+x}x+=g.multipleSeparator}u();g.onSelect(b,y.data,y.value);return true}function s(z,y){if(t==c.DEL){q.hide();return}var x=b.val();if(!y&&x==o){return}o=x;x=g.searchTermFromValue(x,b[0].selectionStart);if(x.length>=g.minChars){b.addClass(g.loadingClass);if(!g.matchCase){x=x.toLowerCase()}f(x,j,u)}else{m();q.hide()}}function h(y){if(!y){return[""]}var z=y.split(g.multipleSeparator);var x=[];a.each(z,function(A,B){if(a.trim(B)){x[A]=a.trim(B)}});return x}function p(x,y){if(g.autoFill&&(g.lastWord(b.val(),null,g.multiple).toLowerCase()==x.toLowerCase())&&t!=c.BACKSPACE){b.val(b.val()+y.substring(g.lastWord(o,null,g.multiple).length));a.Autocompleter.Selection(k,o.length,o.length+y.length)}}function r(){clearTimeout(i);i=setTimeout(u,200)}function u(){q.hide();clearTimeout(i);m();if(g.mustMatch){b.search(function(x){if(!x){if(g.multiple){var y=h(b.val()).slice(0,-1);b.val(y.join(g.multipleSeparator)+(y.length?g.multipleSeparator:""))}else{b.val("")}}})}}function j(y,x){if(x&&x.length&&e){m();q.display(x,y);p(y,x[0].value);q.show()}else{u()}}function f(y,A,x){if(!g.matchCase){y=y.toLowerCase()}var z=l.load(y);if(z&&z.length){A(y,z)}else{if((typeof g.url=="string")&&(g.url.length>0)){var B={timestamp:+new Date()};a.each(g.extraParams,function(C,D){B[C]=typeof D=="function"?D():D});a.ajax({mode:"abort",port:"autocomplete"+k.name,dataType:g.dataType,url:g.url,data:a.extend({q:g.lastWord(y,null,g.multiple),limit:g.max},B),success:function(D){var C=g.parse&&g.parse(D)||n(D);l.add(y,C);A(y,C)}})}else{q.emptyList();x(y)}}}function n(A){var x=[];var z=A.split("\n");for(var y=0;y<z.length;y++){var B=a.trim(z[y]);if(B){B=B.split("|");x[x.length]={data:B,value:B[0],result:g.formatResult&&g.formatResult(B,B[0])||B[0]}}}return x}function m(){b.removeClass(g.loadingClass)}};a.Autocompleter.defaults={onLetterTyped:function(b){},lastWord:function(c,e,b){if(!b){return c}var d=trimWords(c);return d[d.length-1]},inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",onSelect:function(b,d,c){if(select.visible()){a.Autocompleter.Selection(b,b.value.length,b.value.length)}b.val(c)},minChars:1,delay:400,matchCase:false,matchSubset:true,matchContains:false,cacheLength:10,max:100,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(b){return b[0]},selectionChanged:function(b){},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:", ",disableRightAndLeft:false,highlight:function(c,b){return c.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+b.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:true,scrollHeight:180};a.Autocompleter.defaults.searchTermFromValue=a.Autocompleter.defaults.lastWord;a.Autocompleter.Cache=function(c){var f={};var d=0;function h(l,k){if(!c.matchCase){l=l.toLowerCase()}var j=l.indexOf(k);if(c.matchContains=="word"){j=l.toLowerCase().search("\\b"+k.toLowerCase())}if(j==-1){return false}return j==0||c.matchContains}function g(j,i){if(d>c.cacheLength){b()}if(!f[j]){d++}f[j]=i}function e(){if(!c.data){return false}var k={},j=0;if(!c.url){c.cacheLength=1}k[""]=[];for(var m=0,l=c.data.length;m<l;m++){var p=c.data[m];p=(typeof p=="string")?[p]:p;var o=c.formatMatch(p,m+1,c.data.length);if(o===false){continue}var n=o.charAt(0).toLowerCase();if(!k[n]){k[n]=[]}var q={value:o,data:p,result:c.formatResult&&c.formatResult(p)||o};k[n].push(q);if(j++<c.max){k[""].push(q)}}a.each(k,function(r,s){c.cacheLength++;g(r,s)})}setTimeout(e,25);function b(){f={};d=0}return{flush:b,add:g,populate:e,load:function(n){if(!c.cacheLength||!d){return null}if(!c.url&&c.matchContains){var m=[];for(var j in f){if(j.length>0){var o=f[j];a.each(o,function(p,k){if(h(k.value,n)){m.push(k)}})}}return m}else{if(f[n]){return f[n]}else{if(c.matchSubset){for(var l=n.length-1;l>=c.minChars;l--){var o=f[n.substr(0,l)];if(o){var m=[];a.each(o,function(p,k){if(h(k.value,n)){m[m.length]=k}});return m}}}}}return null}}};a.Autocompleter.Select=function(e,j,l,p){var i={ACTIVE:"ac_over"};var k,f=-1,r,m="",s=true,c,o;function n(){if(!s){return}c=a("<div/>").hide().addClass(e.resultsClass).css("position","absolute").appendTo(document.body);o=a("<ul/>").appendTo(c).mouseover(function(t){if(q(t).nodeName&&q(t).nodeName.toUpperCase()=="LI"){f=a("li",o).removeClass(i.ACTIVE).index(q(t));a(q(t)).addClass(i.ACTIVE)}}).click(function(t){a(q(t)).addClass(i.ACTIVE);l();j.focus();return false}).mousedown(function(){p.mouseDownOnSelect=true}).mouseup(function(){p.mouseDownOnSelect=false});if(e.width>0){c.css("width",e.width)}s=false}function q(u){var t=u.target;while(t&&t.tagName!="LI"){t=t.parentNode}if(!t){return[]}return t}function h(t){k.slice(f,f+1).removeClass(i.ACTIVE);g(t);var v=k.slice(f,f+1).addClass(i.ACTIVE);if(e.scroll){var u=0;k.slice(0,f).each(function(){u+=this.offsetHeight});if((u+v[0].offsetHeight-o.scrollTop())>o[0].clientHeight){o.scrollTop(u+v[0].offsetHeight-o.innerHeight())}else{if(u<o.scrollTop()){o.scrollTop(u)}}}e.selectionChanged(v)}function g(t){f+=t;if(f<0){f=k.size()-1}else{if(f>=k.size()){f=0}}}function b(t){return e.max&&e.max<t?e.max:t}function d(){o.empty();var u=b(r.length);for(var v=0;v<u;v++){if(!r[v]){continue}var w=e.formatItem(r[v].data,v+1,u,r[v].value,m);if(w===false){continue}var t=a("<li/>").html(e.highlight(w,m)).addClass(v%2==0?"ac_even":"ac_odd").appendTo(o)[0];a.data(t,"ac_data",r[v])}k=o.find("li");if(e.selectFirst){k.slice(0,1).addClass(i.ACTIVE);f=0}if(a.fn.bgiframe){o.bgiframe()}}return{display:function(u,t){n();r=u;m=t;d()},next:function(){h(1)},prev:function(){h(-1)},pageUp:function(){if(f!=0&&f-8<0){h(-f)}else{h(-8)}},pageDown:function(){if(f!=k.size()-1&&f+8>k.size()){h(k.size()-1-f)}else{h(8)}},hide:function(){c&&c.hide();k&&k.removeClass(i.ACTIVE);f=-1},visible:function(){return c&&c.is(":visible")},current:function(){return this.visible()&&(k.filter("."+i.ACTIVE)[0]||e.selectFirst&&k[0])},show:function(){var v=a(j).offset();c.css({width:typeof e.width=="string"||e.width>0?e.width:a(j).width(),top:v.top+j.offsetHeight,left:v.left}).show();if(e.scroll){o.scrollTop(0);o.css({maxHeight:e.scrollHeight,overflow:"auto"});if(a.browser.msie&&typeof document.body.style.maxHeight==="undefined"){var t=0;k.each(function(){t+=this.offsetHeight});var u=t>e.scrollHeight;o.css("height",u?e.scrollHeight:t);if(!u){k.width(o.width()-parseInt(k.css("padding-left"))-parseInt(k.css("padding-right")))}}}},selected:function(){var t=k&&k.filter("."+i.ACTIVE).removeClass(i.ACTIVE);return t&&t.length&&a.data(t[0],"ac_data")},emptyList:function(){o&&o.empty()},unbind:function(){c&&c.remove()}}};a.Autocompleter.Selection=function(d,e,c){if(d.createTextRange){var b=d.createTextRange();b.collapse(true);b.moveStart("character",e);b.moveEnd("character",c);b.select()}else{if(d.setSelectionRange){d.setSelectionRange(e,c)}else{if(d.selectionStart){d.selectionStart=e;d.selectionEnd=c}}}d.focus()}})(jQuery);(function(a){a.InFieldLabels=function(c,e,b){var d=this;d.$label=a(c);d.label=c;d.$field=a(e);d.field=e;d.$label.data("InFieldLabels",d);d.showing=true;d.init=function(){d.options=a.extend({},a.InFieldLabels.defaultOptions,b);if(d.$field.val()!==""){d.$label.hide();d.showing=false}d.$field.focus(function(){d.fadeOnFocus()}).blur(function(){d.checkForEmpty(true)}).bind("keydown.infieldlabel",function(f){d.hideOnChange(f)}).bind("paste",function(f){d.setOpacity(0)}).change(function(f){d.checkForEmpty()}).bind("onPropertyChange",function(){d.checkForEmpty()})};d.fadeOnFocus=function(){if(d.showing){d.setOpacity(d.options.fadeOpacity)}};d.setOpacity=function(f){d.$label.stop().animate({opacity:f},d.options.fadeDuration);d.showing=(f>0)};d.checkForEmpty=function(f){if(d.$field.val()===""){d.prepForShow();d.setOpacity(f?1:d.options.fadeOpacity)}else{d.setOpacity(0)}};d.prepForShow=function(f){if(!d.showing){d.$label.css({opacity:0}).show();d.$field.bind("keydown.infieldlabel",function(g){d.hideOnChange(g)})}};d.hideOnChange=function(f){if((f.keyCode===16)||(f.keyCode===9)){return}if(d.showing){d.$label.hide();d.showing=false}d.$field.unbind("keydown.infieldlabel")};d.init()};a.InFieldLabels.defaultOptions={fadeOpacity:0.5,fadeDuration:300};a.fn.inFieldLabels=function(b){return this.each(function(){var d=a(this).attr("for"),c;if(!d){return}c=a(this).siblings("input#"+d+"[type='text'],input#"+d+"[type='search'],input#"+d+"[type='tel'],input#"+d+"[type='url'],input#"+d+"[type='email'],input#"+d+"[type='password'],textarea#"+d);if(c.length===0){return}(new a.InFieldLabels(this,c[0],b))})}}(jQuery));var KEYCODES={BACKSPACE:8,TAB:9,ENTER:13,RETURN:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,BREAK:19,CAPSLOCK:20,ESCAPE:27,ESC:27,SPACEBAR:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DEL:46,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LEFTWINDOW:91,RIGHTWINDOW:92,SELECT:93,NUMPAD0:96,NUMPAD1:97,NUMPAD2:98,NUMPAD3:99,NUMPAD4:100,NUMPAD5:101,NUMPAD6:102,NUMPAD7:103,NUMPAD8:104,NUMPAD9:105,MULTIPLY:106,ADD:107,SUBTRACT:109,DECIMALPOINT:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLLLOCK:145,SEMICOLON:186,EQUALSIGN:187,COMMA:188,DASH:189,PERIOD:190,FORWARDSLASH:191,ACCENTGRAVE:192,OPENBRACKET:219,BACKSLASH:220,CLOSEBRACKET:221,SINGLEQUOTE:222,isInsertion:function(a){if(a<=46&&a!=this.RETURN&&a!=this.SPACEBAR){return false}else{if(a>90&&a<96){return false}else{if(a>=112&&a<=145){return false}else{return true}}}}};var qq=qq||{};qq.extend=function(b,a){for(var c in a){b[c]=a[c]}};qq.indexOf=function(b,c,d){if(b.indexOf){return b.indexOf(c,d)}d=d||0;var a=b.length;if(d<0){d+=a}for(;d<a;d++){if(d in b&&b[d]===c){return d}}return -1};qq.getUniqueId=(function(){var a=0;return function(){return a++}})();qq.attach=function(a,c,b){if(a.addEventListener){a.addEventListener(c,b,false)}else{if(a.attachEvent){a.attachEvent("on"+c,b)}}};qq.detach=function(a,c,b){if(a.removeEventListener){a.removeEventListener(c,b,false)}else{if(a.attachEvent){a.detachEvent("on"+c,b)}}};qq.preventDefault=function(a){if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}};qq.insertBefore=function(d,c){c.parentNode.insertBefore(d,c)};qq.remove=function(a){a.parentNode.removeChild(a)};qq.contains=function(b,a){if(b==a){return true}if(b.contains){return b.contains(a)}else{return !!(a.compareDocumentPosition(b)&8)}};qq.toElement=(function(){var a=document.createElement("div");return function(c){a.innerHTML=c;var b=a.firstChild;a.removeChild(b);return b}})();qq.css=function(a,b){if(b.opacity!==null){if(typeof a.style.opacity!="string"&&typeof(a.filters)!="undefined"){b.filter="alpha(opacity="+Math.round(100*b.opacity)+")"}}qq.extend(a.style,b)};qq.hasClass=function(b,a){var c=new RegExp("(^| )"+a+"( |$)");return c.test(b.className)};qq.addClass=function(b,a){if(!qq.hasClass(b,a)){b.className+=" "+a}};qq.removeClass=function(b,a){var c=new RegExp("(^| )"+a+"( |$)");b.className=b.className.replace(c," ").replace(/^\s+|\s+$/g,"")};qq.setText=function(a,b){a.innerText=b;a.textContent=b};qq.children=function(b){var a=[],c=b.firstChild;while(c){if(c.nodeType==1){a.push(c)}c=c.nextSibling}return a};qq.getByClass=function(d,e){if(d.querySelectorAll){return d.querySelectorAll("."+e)}var b=[];var f=d.getElementsByTagName("*");var a=f.length;for(var c=0;c<a;c++){if(qq.hasClass(f[c],e)){b.push(f[c])}}return b};qq.obj2url=function(f,b,h){var g=[],d="&",e=function(k,j){var l=b?(/\[\]$/.test(b))?b:b+"["+j+"]":j;if((l!="undefined")&&(j!="undefined")){g.push((typeof k==="object")?qq.obj2url(k,l,true):(Object.prototype.toString.call(k)==="[object Function]")?encodeURIComponent(l)+"="+encodeURIComponent(k()):encodeURIComponent(l)+"="+encodeURIComponent(k))}};if(!h&&b){d=(/\?/.test(b))?(/\?$/.test(b))?"":"&":"?";g.push(b);g.push(qq.obj2url(f))}else{if((Object.prototype.toString.call(f)==="[object Array]")&&(typeof f!="undefined")){for(var c=0,a=f.length;c<a;++c){e(f[c],c)}}else{if((typeof f!="undefined")&&(f!==null)&&(typeof f==="object")){for(var c in f){e(f[c],c)}}else{g.push(encodeURIComponent(b)+"="+encodeURIComponent(f))}}}return g.join(d).replace(/^&/,"").replace(/%20/g,"+")};var qq=qq||{};qq.FileUploaderBasic=function(a){this._options={debug:false,action:"/server/upload",params:{},button:null,multiple:true,maxConnections:3,allowedExtensions:[],sizeLimit:0,minSizeLimit:0,onSubmit:function(c,b){},onProgress:function(e,d,b,c){},onComplete:function(d,c,b){},onAllComplete:function(b){},onCancel:function(c,b){},messages:{typeError:"{file} has invalid extension. Only {extensions} are allowed.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},showMessage:function(b){alert(b)}};qq.extend(this._options,a);this._filesInProgress=0;this._handler=this._createUploadHandler();if(this._options.button){this._button=this._createUploadButton(this._options.button)}this._preventLeaveInProgress()};qq.FileUploaderBasic.prototype={setParams:function(a){this._options.params=a},getInProgress:function(){return this._filesInProgress},_createUploadButton:function(b){var a=this;return new qq.UploadButton({element:b,multiple:this._options.multiple&&qq.UploadHandlerXhr.isSupported(),onChange:function(c){a._onInputChange(c)}})},_createUploadHandler:function(){var a=this,c;if(qq.UploadHandlerXhr.isSupported()){c="UploadHandlerXhr"}else{c="UploadHandlerForm"}var b=new qq[c]({debug:this._options.debug,action:this._options.action,maxConnections:this._options.maxConnections,onProgress:function(g,f,d,e){a._onProgress(g,f,d,e);a._options.onProgress(g,f,d,e)},onComplete:function(f,e,d){a._onComplete(f,e,d);a._options.onComplete(f,e,d)},onAllComplete:function(d){a._options.onAllComplete(d)},onCancel:function(e,d){a._onCancel(e,d);a._options.onCancel(e,d)}});return b},_preventLeaveInProgress:function(){var a=this;qq.attach(window,"beforeunload",function(b){if(!a._filesInProgress){return}var b=b||window.event;b.returnValue=a._options.messages.onLeave;return a._options.messages.onLeave})},_onSubmit:function(b,a){this._filesInProgress++},_onProgress:function(d,c,a,b){},_onComplete:function(c,b,a){this._filesInProgress--;if(a.error){this._options.showMessage(a.error)}},_onCancel:function(b,a){this._filesInProgress--},_onInputChange:function(a){if(this._handler instanceof qq.UploadHandlerXhr){this._uploadFileList(a.files)}else{if(this._validateFile(a)){this._uploadFile(a)}}this._button.reset()},_uploadFileList:function(b){for(var a=0;a<b.length;a++){if(!this._validateFile(b[a])){return}}for(var a=0;a<b.length;a++){this._uploadFile(b[a])}},_uploadFile:function(a){var c=this._handler.add(a);var b=this._handler.getName(c);if(this._options.onSubmit(c,b)!==false){this._onSubmit(c,b);this._handler.upload(c,this._options.params)}},_validateFile:function(c){var a,b;if(c.value){a=c.value.replace(/.*(\/|\\)/,"")}else{a=c.fileName!=null?c.fileName:c.name;b=c.fileSize!=null?c.fileSize:c.size}if(!this._isAllowedExtension(a)){this._error("typeError",a);return false}else{if(b===0){this._error("emptyError",a);return false}else{if(b&&this._options.sizeLimit&&b>this._options.sizeLimit){this._error("sizeError",a);return false}else{if(b&&b<this._options.minSizeLimit){this._error("minSizeError",a);return false}}}}return true},_error:function(c,d){var b=this._options.messages[c];function a(e,f){b=b.replace(e,f)}a("{file}",this._formatFileName(d));a("{extensions}",this._options.allowedExtensions.join(", "));a("{sizeLimit}",this._formatSize(this._options.sizeLimit));a("{minSizeLimit}",this._formatSize(this._options.minSizeLimit));this._options.showMessage(b)},_formatFileName:function(a){if(a.length>33){a=a.slice(0,19)+"..."+a.slice(-13)}return a},_isAllowedExtension:function(d){var b=(-1!==d.indexOf("."))?d.replace(/.*[.]/,"").toLowerCase():"";var c=this._options.allowedExtensions;if(!c.length){return true}for(var a=0;a<c.length;a++){if(c[a].toLowerCase()==b){return true}}return false},_formatSize:function(a){var b=-1;do{a=a/1024;b++}while(a>99);return Math.max(a,0.1).toFixed(1)+["kB","MB","GB","TB","PB","EB"][b]}};qq.FileUploader=function(a){qq.FileUploaderBasic.apply(this,arguments);qq.extend(this._options,{element:null,listElement:null,template:'<div class="qq-uploader"><div class="qq-upload-drop-area"><span>Drop files here to upload</span></div><div class="qq-upload-button">Upload a file</div><ul class="qq-upload-list"></ul></div>',fileTemplate:'<li><span class="qq-upload-file"></span><span class="qq-upload-spinner"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">Cancel</a><span class="qq-upload-failed-text">Failed</span></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",list:"qq-upload-list",file:"qq-upload-file",spinner:"qq-upload-spinner",size:"qq-upload-size",cancel:"qq-upload-cancel",success:"qq-upload-success",fail:"qq-upload-fail"}});qq.extend(this._options,a);this._element=this._options.element;this._element.innerHTML=this._options.template;this._listElement=this._options.listElement||this._find(this._element,"list");this._classes=this._options.classes;this._button=this._createUploadButton(this._find(this._element,"button"));this._bindCancelEvent();this._setupDragDrop()};qq.extend(qq.FileUploader.prototype,qq.FileUploaderBasic.prototype);qq.extend(qq.FileUploader.prototype,{_find:function(c,b){var a=qq.getByClass(c,this._options.classes[b])[0];if(!a){throw new Error("element not found "+b)}return a},_setupDragDrop:function(){var b=this,c=this._find(this._element,"drop");var a=new qq.UploadDropZone({element:c,onEnter:function(d){qq.addClass(c,b._classes.dropActive);d.stopPropagation()},onLeave:function(d){d.stopPropagation()},onLeaveNotDescendants:function(d){qq.removeClass(c,b._classes.dropActive)},onDrop:function(d){c.style.display="none";qq.removeClass(c,b._classes.dropActive);b._uploadFileList(d.dataTransfer.files)}});c.style.display="none";qq.attach(document,"dragenter",function(d){if(!a._isValidFileDrag(d)){return}c.style.display="block"});qq.attach(document,"dragleave",function(f){if(!a._isValidFileDrag(f)){return}var d=document.elementFromPoint(f.clientX,f.clientY);if(!d||d.nodeName=="HTML"){c.style.display="none"}})},_onSubmit:function(b,a){qq.FileUploaderBasic.prototype._onSubmit.apply(this,arguments);this._addToList(b,a)},_onProgress:function(g,f,a,d){qq.FileUploaderBasic.prototype._onProgress.apply(this,arguments);var c=this._getItemByFileId(g);var b=this._find(c,"size");b.style.display="inline";var e;if(a!=d){e=Math.round(a/d*100)+"% from "+this._formatSize(d)}else{e=this._formatSize(d)}qq.setText(b,e)},_onComplete:function(d,c,a){qq.FileUploaderBasic.prototype._onComplete.apply(this,arguments);var b=this._getItemByFileId(d);qq.remove(this._find(b,"cancel"));qq.remove(this._find(b,"spinner"));if(a.success){qq.addClass(b,this._classes.success)}else{qq.addClass(b,this._classes.fail)}},_addToList:function(d,c){var a=qq.toElement(this._options.fileTemplate);a.qqFileId=d;var b=this._find(a,"file");qq.setText(b,this._formatFileName(c));this._find(a,"size").style.display="none";this._listElement.appendChild(a)},_getItemByFileId:function(b){var a=this._listElement.firstChild;while(a){if(a.qqFileId==b){return a}a=a.nextSibling}},_bindCancelEvent:function(){var a=this,b=this._listElement;qq.attach(b,"click",function(f){f=f||window.event;var d=f.target||f.srcElement;if(qq.hasClass(d,a._classes.cancel)){qq.preventDefault(f);var c=d.parentNode;a._handler.cancel(c.qqFileId);qq.remove(c)}})}});qq.UploadDropZone=function(a){this._options={element:null,onEnter:function(b){},onLeave:function(b){},onLeaveNotDescendants:function(b){},onDrop:function(b){}};qq.extend(this._options,a);this._element=this._options.element;this._disableDropOutside();this._attachEvents()};qq.UploadDropZone.prototype={_disableDropOutside:function(a){if(!qq.UploadDropZone.dropOutsideDisabled){qq.attach(document,"dragover",function(b){if(b.dataTransfer){b.dataTransfer.dropEffect="none";b.preventDefault()}});qq.UploadDropZone.dropOutsideDisabled=true}},_attachEvents:function(){var a=this;qq.attach(a._element,"dragover",function(c){if(!a._isValidFileDrag(c)){return}var b=c.dataTransfer.effectAllowed;if(b=="move"||b=="linkMove"){c.dataTransfer.dropEffect="move"}else{c.dataTransfer.dropEffect="copy"}c.stopPropagation();c.preventDefault()});qq.attach(a._element,"dragenter",function(b){if(!a._isValidFileDrag(b)){return}a._options.onEnter(b)});qq.attach(a._element,"dragleave",function(c){if(!a._isValidFileDrag(c)){return}a._options.onLeave(c);var b=document.elementFromPoint(c.clientX,c.clientY);if(qq.contains(this,b)){return}a._options.onLeaveNotDescendants(c)});qq.attach(a._element,"drop",function(b){if(!a._isValidFileDrag(b)){return}b.preventDefault();a._options.onDrop(b)})},_isValidFileDrag:function(c){var b=c.dataTransfer,a=navigator.userAgent.indexOf("AppleWebKit")>-1;return b&&b.effectAllowed!="none"&&(b.files||(!a&&b.types.contains&&b.types.contains("Files")))}};qq.UploadButton=function(a){this._options={element:null,multiple:false,name:"file",onChange:function(b){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"};qq.extend(this._options,a);this._element=this._options.element;qq.css(this._element,{position:"relative",direction:"ltr"});this._input=this._createInput()};qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){if(this._input.parentNode){qq.remove(this._input)}qq.removeClass(this._element,this._options.focusClass);this._input=this._createInput()},_createInput:function(){var b=document.createElement("input");if(this._options.multiple){b.setAttribute("multiple","multiple")}b.setAttribute("type","file");b.setAttribute("name",this._options.name);qq.css(b,{position:"absolute",right:0,top:0,margin:0,padding:0,opacity:0});this._element.appendChild(b);var a=this;qq.attach(b,"change",function(){a._options.onChange(b)});qq.attach(b,"mouseover",function(){qq.addClass(a._element,a._options.hoverClass)});qq.attach(b,"mouseout",function(){qq.removeClass(a._element,a._options.hoverClass)});qq.attach(b,"focus",function(){qq.addClass(a._element,a._options.focusClass)});qq.attach(b,"blur",function(){qq.removeClass(a._element,a._options.focusClass)});if(window.attachEvent){b.setAttribute("tabIndex","-1")}return b}};qq.UploadHandlerAbstract=function(a){this._options={debug:false,action:"/upload.php",maxConnections:999,onProgress:function(e,d,b,c){},onComplete:function(d,c,b){},onAllComplete:function(b){},onCancel:function(c,b){}};qq.extend(this._options,a);this._queue=[];this._params=[];this._completed_files=[]};qq.UploadHandlerAbstract.prototype={log:function(a){if(this._options.debug&&window.console){console.log("[uploader] "+a)}},add:function(a){},upload:function(d,b){var a=this._queue.push(d);var c={};qq.extend(c,b);this._params[d]=c;if(a<=this._options.maxConnections){this._upload(d,this._params[d])}},cancel:function(a){this._cancel(a);this._dequeue(a)},cancelAll:function(){for(var a=0;a<this._queue.length;a++){this._cancel(this._queue[a])}this._queue=[]},getName:function(a){},getSize:function(a){},getQueue:function(){return this._queue},_upload:function(a){},_cancel:function(a){},_dequeue:function(d){var b=qq.indexOf(this._queue,d);this._queue.splice(b,1);var a=this._options.maxConnections;if(this._queue.length>=a){var c=this._queue[a-1];this._upload(c,this._params[c])}if(this._queue.length==0){this._onAllComplete()}},_onAllComplete:function(){this._options.onAllComplete(this._completed_files)}};qq.UploadHandlerForm=function(a){qq.UploadHandlerAbstract.apply(this,arguments);this._inputs={}};qq.extend(qq.UploadHandlerForm.prototype,qq.UploadHandlerAbstract.prototype);qq.extend(qq.UploadHandlerForm.prototype,{add:function(a){a.setAttribute("name","qqfile");var b="qq-upload-handler-iframe"+qq.getUniqueId();this._inputs[b]=a;if(a.parentNode){qq.remove(a)}return b},getName:function(a){return this._inputs[a].value.replace(/.*(\/|\\)/,"")},_cancel:function(b){this._options.onCancel(b,this.getName(b));delete this._inputs[b];var a=document.getElementById(b);if(a){a.setAttribute("src","javascript:false;");qq.remove(a)}},_upload:function(g,e){var b=this._inputs[g];if(!b){throw new Error("file with passed id was not added, or already uploaded or cancelled")}var f=this.getName(g);var c=this._createIframe(g);var d=this._createForm(c,e);d.appendChild(b);$(d).append($('<input type="hidden" name="authenticity_token" value="'+$("meta[name='csrf-token']").attr("content")+'"/>'));var a=this;this._attachLoadEvent(c,function(){a.log("iframe loaded");var h=a._getIframeContentJSON(c);a._options.onComplete(g,f,h);a._dequeue(g);delete a._inputs[g];setTimeout(function(){qq.remove(c)},1)});d.submit();qq.remove(d);return g},_attachLoadEvent:function(a,b){qq.attach(a,"load",function(){if(!a.parentNode){return}if(a.contentDocument&&a.contentDocument.body&&a.contentDocument.body.innerHTML=="false"){return}b()})},_getIframeContentJSON:function(iframe){var doc=iframe.contentDocument?iframe.contentDocument:iframe.contentWindow.document,response;this.log("converting iframe's innerHTML to JSON");this.log("innerHTML = "+doc.body.innerHTML);try{response=eval("("+doc.body.innerHTML+")")}catch(err){response={}}return response},_createIframe:function(b){var a=qq.toElement('<iframe src="javascript:false;" name="'+b+'" />');a.setAttribute("id",b);a.style.display="none";document.body.appendChild(a);return a},_createForm:function(a,c){var b=qq.toElement('<form method="post" enctype="multipart/form-data"></form>');var d=qq.obj2url(c,this._options.action);b.setAttribute("action",d);b.setAttribute("target",a.name);b.style.display="none";document.body.appendChild(b);return b}});qq.UploadHandlerXhr=function(a){qq.UploadHandlerAbstract.apply(this,arguments);this._files=[];this._xhrs=[];this._loaded=[]};qq.UploadHandlerXhr.isSupported=function(){var a=document.createElement("input");a.type="file";return("multiple" in a&&typeof File!="undefined"&&typeof(new XMLHttpRequest()).upload!="undefined")};qq.extend(qq.UploadHandlerXhr.prototype,qq.UploadHandlerAbstract.prototype);qq.extend(qq.UploadHandlerXhr.prototype,{add:function(a){if(!(a instanceof File)){throw new Error("Passed obj in not a File (in qq.UploadHandlerXhr)")}return this._files.push(a)-1},getName:function(b){var a=this._files[b];return a.fileName!=null?a.fileName:a.name},getSize:function(b){var a=this._files[b];return a.fileSize!=null?a.fileSize:a.size},getLoaded:function(a){return this._loaded[a]||0},_upload:function(h,f){var d=this._files[h],b=this.getName(h),c=this.getSize(h);this._loaded[h]=0;var e=this._xhrs[h]=new XMLHttpRequest();var a=this;e.upload.onprogress=function(i){if(i.lengthComputable){a._loaded[h]=i.loaded;a._options.onProgress(h,b,i.loaded,i.total)}};e.onreadystatechange=function(){if(e.readyState==4){a._onComplete(h,e)}};f=f||{};f.qqfile=b;var g=qq.obj2url(f,this._options.action);e.open("POST",g,true);e.setRequestHeader("X-Requested-With","XMLHttpRequest");e.setRequestHeader("X-File-Name",encodeURIComponent(b));e.setRequestHeader("Content-Type","application/octet-stream");e.setRequestHeader("X-CSRF-Token",$("meta[name='csrf-token']").attr("content"));e.send(d)},_onComplete:function(id,xhr){if(!this._files[id]){return}var name=this.getName(id);var size=this.getSize(id);this._options.onProgress(id,name,size,size);if(xhr.status==200){this.log("xhr - server response received");this.log("responseText = "+xhr.responseText);var response;try{response=eval("("+xhr.responseText+")")}catch(err){response={}}this._completed_files.push({file:this._files[id],response:response});this._options.onComplete(id,name,response)}else{this._completed_files.push({file:this._files[id],response:{}});this._options.onComplete(id,name,{})}this._files[id]=null;this._xhrs[id]=null;this._dequeue(id)},_cancel:function(a){this._options.onCancel(a,this.getName(a));this._files[a]=null;if(this._xhrs[a]){this._xhrs[a].abort();this._xhrs[a]=null}}});(function(){var a={Pages:{},Widgets:{}};a.EventBroker={extend:function(c){var b=(typeof c==="function")?c.prototype:c;$.extend(b,{eventsContainer:$({}),publish:function(d,e){var f=d.split(" ");for(d in f){this.eventsContainer.trigger(f[d],e)}},subscribe:function(d,g,e){var f=d.split(" ");for(d in f){this.eventsContainer.bind(f[d],$.proxy(g,e))}}});return b}};a.BaseWidget={instantiate:function(d,c){$.extend(a.Widgets[d].prototype,a.EventBroker.extend(a.BaseWidget));var e=new a.Widgets[d](),b=Array.prototype.slice.call(arguments,1);e.publish("widget/ready",b);return e},globalSubscribe:function(b,d,c){a.page.subscribe(b,d,c)},globalPublish:function(b,c){a.page.publish(b,c)}};a.BasePage=function(b){$.extend(this,a.BaseWidget);$.extend(this,{backToTop:this.instantiate("BackToTop",b.find("#back-to-top")),directionDetector:this.instantiate("DirectionDetector"),events:function(){return a.page.eventsContainer.data("events")},flashMessages:this.instantiate("FlashMessages"),header:this.instantiate("Header",b.find("header")),hoverCard:this.instantiate("HoverCard",b.find("#hovercard"))})};a.instantiatePage=function(){if(typeof a.Pages[a.Page]==="undefined"){a.page=a.EventBroker.extend(a.BaseWidget)}else{var b=a.Pages[a.Page];$.extend(b.prototype,a.EventBroker.extend(a.BaseWidget));a.page=new b()}if(!$.mobile){$.extend(a.page,new a.BasePage($(document.body)))}a.page.publish("page/ready",[$(document.body)])};window.Diaspora=a})();$(Diaspora.instantiatePage);Diaspora.Pages.AspectsIndex=function(){var a=this;this.subscribe("page/ready",function(c,b){a.aspectNavigation=a.instantiate("AspectNavigation",b.find("ul#aspect_nav"));a.stream=a.instantiate("Stream",b.find("#aspect_stream_container"));a.infiniteScroll=a.instantiate("InfiniteScroll")})};Diaspora.Pages.CommentStreamIndex=function(){var a=this;this.subscribe("page/ready",function(c,b){a.aspectNavigation=a.instantiate("AspectNavigation",b.find("ul#aspect_nav"));a.stream=a.instantiate("Stream",b.find("#aspect_stream_container"));a.infiniteScroll=a.instantiate("InfiniteScroll")})};Diaspora.Pages.ContactsIndex=function(){var a=this;this.subscribe("page/ready",function(c,b){a.infiniteScroll=a.instantiate("InfiniteScroll");$(".conversation_button").twipsy({position:"below"})})};Diaspora.Pages.FeaturedUsersIndex=function(){var a=this;this.subscribe("page/ready",function(c,b){a.aspectNavigation=a.instantiate("AspectNavigation",b.find("ul#aspect_nav"));a.stream=a.instantiate("Stream",b.find("#aspect_stream_container"));a.infiniteScroll=a.instantiate("InfiniteScroll")})};Diaspora.Pages.InvitationsEdit=function(){var a=this;this.subscribe("page/ready",function(c,b){$("#user_username").twipsy({trigger:"select",placement:"right"})})};Diaspora.Pages.InvitationsNew=function(){var a=this;this.subscribe("page/ready",function(d,c){var e=$("html").attr("dir")=="rtl",b=e?"left":"right";$("#new_user [title]").twipsy({trigger:"focus",placement:b});$("#user_email").focus()})};Diaspora.Pages.LikeStreamIndex=function(){var a=this;this.subscribe("page/ready",function(c,b){a.aspectNavigation=a.instantiate("AspectNavigation",b.find("ul#aspect_nav"));a.stream=a.instantiate("Stream",b.find("#aspect_stream_container"));a.infiniteScroll=a.instantiate("InfiniteScroll")})};Diaspora.Pages.MentionsIndex=function(){var a=this;this.subscribe("page/ready",function(c,b){a.aspectNavigation=a.instantiate("AspectNavigation",b.find("ul#aspect_nav"));a.stream=a.instantiate("Stream",b.find("#aspect_stream_container"));a.infiniteScroll=a.instantiate("InfiniteScroll")})};Diaspora.Pages.MultisIndex=function(){var a=this;this.subscribe("page/ready",function(c,b){a.aspectNavigation=a.instantiate("AspectNavigation",b.find("ul#aspect_nav"));a.stream=a.instantiate("Stream",b.find("#aspect_stream_container"));a.infiniteScroll=a.instantiate("InfiniteScroll");$(".indicator").twipsy({placement:"below",live:true})})};Diaspora.Pages.NotificationsIndex=function(){var a=this;this.subscribe("page/ready",function(c,b){a.infiniteScroll=a.instantiate("InfiniteScroll");a.instantiate("TimeAgo",b.find("abbr.timeago"))})};Diaspora.Pages.PeopleShow=function(){var a=this;this.subscribe("page/ready",function(c,b){a.stream=a.instantiate("Stream",b.find("#main_stream"));a.infiniteScroll=a.instantiate("InfiniteScroll")})};Diaspora.Pages.PostsIndex=function(){var a=this;this.subscribe("page/ready",function(c,b){a.aspectNavigation=a.instantiate("AspectNavigation",b.find("ul#aspect_nav"));a.stream=a.instantiate("Stream",b.find("#aspect_stream_container"));a.infiniteScroll=a.instantiate("InfiniteScroll")})};Diaspora.Pages.PostsShow=function(){var a=this;this.subscribe("page/ready",function(c,b){a.stream=a.instantiate("Stream",b.find("#main_stream"))})};Diaspora.Pages.ServicesFinder=function(){var a=this;this.subscribe("page/ready",function(c,b){a.infiniteScroll=a.instantiate("InfiniteScroll")})};Diaspora.Pages.TagFollowingsIndex=function(){var a=this;this.subscribe("page/ready",function(c,b){a.aspectNavigation=a.instantiate("AspectNavigation",b.find("ul#aspect_nav"));a.stream=a.instantiate("Stream",b.find("#aspect_stream_container"));a.infiniteScroll=a.instantiate("InfiniteScroll")})};Diaspora.Pages.TagsShow=function(){var a=this;this.subscribe("page/ready",function(c,b){a.stream=a.instantiate("Stream",b.find("#main_stream"));a.infiniteScroll=a.instantiate("InfiniteScroll");a.instantiate("TimeAgo",b.find("abbr.timeago"))})};Diaspora.Pages.UsersGettingStarted=function(){var a=this;this.subscribe("page/ready",function(d,c){a.peopleSearch=a.instantiate("Search",c.find("form.people.search_form"));a.tagSearch=a.instantiate("Search",c.find("form.tag_input.search_form"));$("#edit_profile").bind("ajax:success",function(f,g,e,h){$("#gs-name-form-spinner").addClass("hidden");$(".profile .saved").show();$(".profile .saved").fadeOut(2000)});$("#edit_profile").bind("ajax:complete",function(g,i,f){var e=$("#profile_first_name");e.val(e.data("cachedValue"));var h=Diaspora.I18n.t("getting_started.hey",{name:$("#profile_first_name").val()});Diaspora.page.flashMessages.render({success:true,notice:h})});$("#profile_first_name").bind("change",function(){$(this).data("cachedValue",$(this).val());$("#edit_profile").submit();$("#gs-name-form-spinner").removeClass("hidden")});$("#profile_first_name").bind("blur",function(){$(this).removeClass("active_input")});$("#profile_first_name").bind("focus",function(){$(this).addClass("active_input")});$("#awesome_button").bind("click",function(e){e.preventDefault();var g=Diaspora.I18n.t("getting_started.no_tags");if(($("#as-selections-tags").find(".as-selection-item").length>0)||confirm(g)){$(".tag_input").submit();var f=Diaspora.I18n.t("getting_started.preparing_your_stream");Diaspora.page.flashMessages.render({success:true,notice:f})}else{var f=Diaspora.I18n.t("getting_started.alright_ill_wait");Diaspora.page.flashMessages.render({success:true,notice:f})}});var b=$("#follow_tags");b.autoSuggest("/tags",{selectedItemProp:"name",searchObjProps:"name",asHtmlID:"tags",neverSubmit:true,retriveLimit:10,selectionLimit:false,minChars:2,keyDelay:200,startText:"",emptyText:"no_results"});b.bind("keydown",function(e){if(e.keyCode==13||e.keyCode==9||e.keyCode==32){e.preventDefault();if($("li.as-result-item.active").length==0){$("li.as-result-item").first().click()}}})})};Diaspora.Alert={faceboxTemplate:'<div id="diaspora_alert"><div class="span-12 last"><div id="facebox_header"><h4>{{title}}</h4></div>{{content}}</div></div>',show:function(b,a){$($.mustache(this.faceboxTemplate,{title:b,content:a})).appendTo(document.body);$.facebox({div:"#diaspora_alert"},"diaspora_alert")}};$(function(){$(document).bind("close.facebox",function(){$("#diaspora_alert").remove()})});Diaspora.I18n={language:"en",locale:{},loadLocale:function(a,b){this.locale=a;this.language=b},t:function(e,a){var b=e.split("."),c,d;while(d=b.shift()){c=(c)?c[d]:this.locale[d];if(typeof c==="undefined"){return""}}if(a&&typeof a.count!=="undefined"){if(a.count==0){d="zero"}else{if(a.count==1){d="one"}else{if(a.count<=3){d="few"}else{if(a.count>3){d="many"}else{d="other"}}}}c=c[d]}return $.mustache(c,a||{})}};(function(){Diaspora.Widgets.AspectNavigation=function(){var a=this;this.subscribe("widget/ready",function(b,c){$.extend(a,{aspectNavigation:c,aspectSelectors:c.find("a.aspect_selector[data-guid]"),aspectLis:c.find("li[data-aspect_id]"),toggleSelector:c.find("a.toggle_selector")});a.aspectSelectors.click(a.toggleAspect);a.toggleSelector.click(a.toggleAll)});this.selectedAspects=function(){return a.aspectNavigation.find("li.active[data-aspect_id]").map(function(){return $(this).data("aspect_id")})};this.toggleAspect=function(b){b.preventDefault();$(this).parent().toggleClass("active");a.perform()};this.toggleAll=function(b){b.preventDefault();if(a.allSelected()){a.aspectLis.removeClass("active")}else{a.aspectLis.addClass("active")}a.perform()};this.perform=function(){if(a.noneSelected()){a.abortAjax();Diaspora.page.stream.empty();Diaspora.page.stream.setHeaderTitle(Diaspora.I18n.t("aspect_navigation.no_aspects"));a.fadeIn()}else{a.performAjax()}a.calculateToggleText()};this.calculateToggleText=function(){if(a.allSelected()){a.toggleSelector.text(Diaspora.I18n.t("aspect_navigation.deselect_all"))}else{a.toggleSelector.text(Diaspora.I18n.t("aspect_navigation.select_all"))}};this.generateURL=function(){var b="aspects";b=b.replace("#","");b+="?";a.aspectLis.each(function(){var c=$(this);if(c.hasClass("active")){b+="a_ids[]="+c.data("aspect_id")+"&"}});if(!$("#publisher").hasClass("closed")){b+="op=true"}else{b=b.slice(0,b.length-1)}return b};this.performAjax=function(){var b=$("#publisher textarea#status_message_fake_text").val(),c=a.generateURL(),d={};$("#photodropzone img").each(function(){var e=$(this);d[e.attr("data-id")]=e.attr("src")});a.abortAjax();a.fadeOut();a.jXHR=$.getScript(c,function(g){var e=$("#publisher textarea#status_message_fake_text"),f=$("#photodropzone");if(b!==""){e.val(b).focus()}$.each(d,function(i,h){f.append(['<li style="position: relative;">','<img src="'+h+' data-id="'+i+"/>","</li>"].join(""))});a.globalPublish("stream/reloaded");if(b!==""){Publisher.open()}a.fadeIn()})};this.abortAjax=function(){if(a.jXHR){a.jXHR.abort();a.jXHR=null}};this.noneSelected=function(){return a.aspectLis.filter(".active").length===0};this.allSelected=function(){return a.aspectLis.not(".active").length===0};this.fadeOut=function(){$("#aspect_stream_container").fadeTo(100,0.4);$("#selected_aspect_contacts").fadeTo(100,0.4)};this.fadeIn=function(){$("#aspect_stream_container").fadeTo(100,1);$("#selected_aspect_contacts").fadeTo(100,1)}}})();(function(){var a=function(){var b=this;this.subscribe("widget/ready",function(c,d){$.extend(b,{button:d,body:$("html, body"),window:$(window)});b.button.click(b.backToTop);b.window.debounce("scroll",b.toggleVisibility,250)});this.backToTop=function(c){c.preventDefault();b.body.animate({scrollTop:0})};this.toggleVisibility=function(){b.button.animate({opacity:(b.body.scrollTop()>1000)?0.5:0})}};Diaspora.Widgets.BackToTop=a})();(function(){var a=function(){var b=this;this.subscribe("widget/ready",function(c,d){$.extend(b,{commentFormElement:d,commentInput:d.find("textarea")});b.commentInput.autoResize();b.commentInput.focus(b.showCommentForm)});this.showCommentForm=function(){b.commentFormElement.parent().removeClass("hidden");b.commentFormElement.addClass("open")}};Diaspora.Widgets.CommentForm=a})();(function(){var a=function(){var b=this;this.subscribe("widget/ready",function(c,d){$.extend(b,{commentsList:d.find("ul.comments"),commentToggler:d.find(".toggle_post_comments"),comments:{}});b.commentsList.delegate(".new_comment","ajax:failure",function(){Diaspora.Alert.show(Diaspora.I18n.t("failed_to_post_message"))});b.commentToggler.toggle(b.showComments,b.hideComments);b.instantiateCommentWidgets()});this.instantiateCommentWidgets=function(){b.comments={};b.commentsList.find("li.comment").each(function(){b.publish("comment/added",[$("#"+this.id)])})};this.showComments=function(c){c.preventDefault();if(b.commentsList.hasClass("loaded")){b.commentToggler.html(Diaspora.I18n.t("comments.hide"));b.commentsList.removeClass("hidden")}else{$("<img/>",{alt:"loading",src:"/images/ajax-loader.gif"}).appendTo(b.commentToggler);$.get(b.commentToggler.attr("href"),function(d){b.commentToggler.html(Diaspora.I18n.t("comments.hide"));b.commentsList.html(d).addClass("loaded").removeClass("hidden");b.instantiateCommentWidgets()})}};this.hideComments=function(c){c.preventDefault();b.commentToggler.html(Diaspora.I18n.t("comments.show"));b.commentsList.addClass("hidden")};this.subscribe("comment/added",function(c,d){b.comments[d.attr("id")]=b.instantiate("Comment",d)})};Diaspora.Widgets.CommentStream=a})();(function(){var a=function(){var b=this;this.subscribe("widget/ready",function(c,d){$.extend(b,{comment:d,deleteCommentLink:d.find("a.comment_delete"),likes:b.instantiate("Likes",d.find(".likes_container")),timeAgo:b.instantiate("TimeAgo",d.find("abbr.timeago")),content:d.find(".content span .collapsible")});b.deleteCommentLink.click(b.removeComment);b.deleteCommentLink.twipsy({trigger:"hover"});b.content.expander({slicePoint:200,widow:18,expandText:Diaspora.I18n.t("show_more"),userCollapse:false});b.globalSubscribe("likes/"+b.comment.attr("id")+"/updated",function(){b.likes=b.instantiate("Likes",b.comment.find(".likes_container"))})});this.removeComment=function(c){c.preventDefault();if(confirm(Diaspora.I18n.t("confirm_dialog"))){$.post(b.deleteCommentLink.attr("href"),{_method:"delete"},function(){b.comment.hide("blind",{direction:"vertical"},300,function(){b.comment.remove()})})}}};Diaspora.Widgets.Comment=a})();(function(){var a=function(){var b=this;this.binds=[];this.cleaner=new RegExp("@[^ ]+|^RT[: ]{1}| RT | RT: |[♺♻:]+","g");this.subscribe("widget/ready",function(){b.updateBinds();b.globalSubscribe("stream/scrolled",function(){b.updateBinds()})});this.isRTL=function(d){if(typeof d!=="string"||d.length<1){return false}var c=d.charCodeAt(0);if(c>=1536&&c<=1791){return true}else{if(c>=65136&&c<=65279){return true}else{if(c>=64336&&c<=65023){return true}else{if(c>=1424&&c<=1535){return true}else{if(c>=64256&&c<=64335){return true}else{if(c>=1792&&c<=1871){return true}else{if(c>=1920&&c<=1983){return true}else{if(c>=1984&&c<=2047){return true}else{if(c>=11568&&c<=11647){return true}}}}}}}}}return false};this.updateBinds=function(){$.each(b.binds,function(c,d){d.unbind("keyup",b.updateDirection)});b.binds=[];$("textarea, input[type='text'], input[type='search']").each(b.bind)};this.bind=function(){b.binds.push($(this).bind("keyup",b.updateDirection))};this.updateDirection=function(){var d=$(this),c=d.val().replace(b.cleaner,"").replace(/^[ ]+/,"");if(b.isRTL(c)){d.css("direction","rtl")}else{d.css("direction","ltr")}}};Diaspora.Widgets.DirectionDetector=a})();(function(){var a=function(){var b=this;this.subscribe("widget/ready",function(){b.animateMessages()});this.animateMessages=function(){var c=$("#flash_notice, #flash_error, #flash_alert");c.animate({top:0},400).delay(4000).animate({top:-100},400,function(){$(this).remove()})};this.render=function(c){$("<div/>",{id:c.success?"flash_notice":"flash_error"}).html($("<div/>",{"class":"message"}).html(c.notice)).prependTo(document.body);b.animateMessages()}};Diaspora.Widgets.FlashMessages=a})();(function(){var a=function(){var b=this;this.subscribe("widget/ready",function(c,d){b.notifications=b.instantiate("Notifications",d.find("#notifications"),d.find("#notification_badge .badge_count"));b.notificationsDropdown=b.instantiate("NotificationsDropdown",d.find("#notification_badge"),d.find("#notification_dropdown"));b.search=b.instantiate("Search",d.find(".search_form"));b.menuElement=b.instantiate("UserDropdown",d.find("#user_menu"))})};Diaspora.Widgets.Header=a})();(function(){var a=function(){var b=this;b.jXHRs=[];b.subscribe("widget/ready",function(c,d){b.personCache=new b.Cache();b.dropdownCache=new b.Cache();b.hoverCard={tip:$("#hovercard_container"),dropdownContainer:$("#hovercard_dropdown_container"),offset:{left:-10,top:13},personLink:d.find("a.person"),personHandle:d.find("p.handle"),avatar:d.find(".avatar"),dropdown:d.find(".dropdown_list"),hashtags:d.find(".hashtags")};$(document.body).delegate("a.hovercardable:not(.self)","hover",b.handleHoverEvent);b.hoverCard.tip.hover(b.hoverCardHover,b.clearTimeout);b.subscribe("aspectDropdown/updated aspectDropdown/blurred",function(e,f,g){b.dropdownCache.cache["/people/"+f+"/aspect_membership_button"]=$(g).removeClass("active").get(0).outerHTML})});this.handleHoverEvent=function(c){b.target=$(c.target);if(c.type==="mouseenter"){b.startHover()}else{b.clearTimeout(c)}};this.startHover=function(c){if(!b.hoverCardTimeout){b.clearTimeout(false)}b.timeout=setTimeout(b.showHoverCard,600)};this.showHoverCard=function(){b.hoverCard.tip.hide();b.hoverCard.tip.prependTo(b.target.parent());b.personCache.get(b.target.attr("data-hovercard")+".json?includes=tags",function(c){b.populateHovercard(c)})};this.populateHovercard=function(d){var c=b.target.position();b.hoverCard.tip.css({left:c.left+b.hoverCard.offset.left,top:c.top+b.hoverCard.offset.top});b.hoverCard.avatar.attr("src",d.avatar);b.hoverCard.personLink.attr("href",d.url);b.hoverCard.personLink.text(d.name);b.hoverCard.personHandle.text(d.handle);b.hoverCard.dropdown.attr("data-person-id",d.id);b.hoverCard.hashtags.html("");$.each(d.tags,function(e,f){b.hoverCard.hashtags.append($("<a/>",{href:"/tags/"+f.substring(1)}).text(f))});b.dropdownCache.get(b.target.attr("data-hovercard")+"/aspect_membership_button",function(e){b.hoverCard.dropdownContainer.html(e);b.hoverCard.tip.fadeIn(140)})};this.clearTimeout=function(c){b.personCache.clearjXHRs();b.dropdownCache.clearjXHRs();function d(){b.timeout=clearTimeout(b.timeout);b.hoverCard.tip.hide();b.hoverCard.dropdownContainer.html("")}if((typeof c==="boolean"&&c)||(typeof c==="object"&&c.type==="mouseleave")){b.hoverCardTimeout=setTimeout(d,20)}else{d()}};this.hoverCardHover=function(){b.hoverCardTimeout=clearTimeout(b.hoverCardTimeout)};this.Cache=function(){var c=this;this.cache={};this.jXHRs=[];this.get=function(d,e){if(typeof c.cache[d]==="undefined"){c.jXHRs.push($.get(d,function(f){c.cache[d]=f;e(f);c.jXHRs.shift()}))}else{e(c.cache[d])}};this.clearjXHRs=function(){$.each(c.jXHRs,function(d,e){e.abort()});c.jXHRs=[]}}};Diaspora.Widgets.HoverCard=a})();(function(){var a=function(){var b=this;this.options={bufferPx:500,debug:false,donetext:Diaspora.I18n.t("infinite_scroll.no_more"),loadingText:"",loadingImg:"/images/ajax-loader.gif",navSelector:"#pagination",nextSelector:".paginate",itemSelector:".stream_element",pathParse:function(c){var d=c.replace("?","?only_posts=true&"),e=$("#main_stream .stream_element").last().find(".time").attr("integer");if(e===undefined){e=$("#main_stream").data("time_for_scroll")}return d.replace(/max_time=\d+/,"max_time="+e)}};this.subscribe("widget/ready",function(){if($("#main_stream").length!==0){$("#main_stream").infinitescroll(b.options,function(c){b.globalPublish("stream/scrolled",c)})}else{if($("#people_stream").length!==0){$("#people_stream").infinitescroll($.extend(b.options,{navSelector:".pagination",nextSelector:".next_page",pathParse:function(d,c){return d.replace("page=2","page="+c)}}),function(c){b.globalPublish("stream/scrolled",c)})}}});this.reInitialize=function(){$("#main_stream").infinitescroll("destroy");b.publish("widget/ready")};this.globalSubscribe("stream/reloaded",b.reInitialize,this)};Diaspora.Widgets.InfiniteScroll=a})();jQuery.fn.center=(function(){var a=$(window);return function(){this.css({position:"absolute",top:(a.height()-this.height())/2+a.scrollTop()+"px",left:(a.width()-this.width())/2+a.scrollLeft()+"px"});return this}})();(function(){var a=function(){var b=this;this.subscribe("widget/ready",function(c,d){$.extend(b,{post:d,lightbox:$("#lightbox"),imageset:$("#lightbox-imageset"),backdrop:$("#lightbox-backdrop"),closelink:$("#lightbox-close-link"),image:$("#lightbox-image"),body:$(document.body),window:$(window)});b.post.delegate("a.stream-photo-link","click",b.lightboxImageClicked);b.imageset.delegate("img","click",b.imagesetImageClicked);b.window.resize(function(){b.lightbox.css("max-height",(b.window.height()-100)+"px")}).trigger("resize");b.closelink.click(function(e){e.preventDefault();b.resetLightbox()});b.backdrop.click(b.resetLightbox);b.lightbox.click(b.resetLightbox);b.backdrop.click(function(e){e.preventDefault();b.resetLightbox()});b.body.keydown(function(e){var f=b.imageset.find("img.selected");switch(e.keyCode){case 27:b.resetLightbox();break;case 37:b.selectImage(b.prevImage(f));break;case 39:b.selectImage(b.nextImage(f));break}})});this.nextImage=function(c){var d=c.next();if(d.length==0){d=b.imageset.find("img").first()}return(d)};this.prevImage=function(c){var d=c.prev();if(d.length==0){d=b.imageset.find("img").last()}return(d)};this.lightboxImageClicked=function(d){d.preventDefault();var f=$(this).find("img.stream-photo"),e=f.attr("data-full-photo"),c=f.parents(".stream_element").find("img.stream-photo"),g;if($.browser.msie){window.open(e);return}b.imageset.html("");c.each(function(i,j){j=$(j);var h=$("<img/>",{src:j.attr("data-small-photo"),"data-full-photo":j.attr("data-full-photo")});if(j.attr("data-full-photo")==e){g=h}b.imageset.append(h)});b.selectImage(g).revealLightbox()};this.imagesetImageClicked=function(c){c.preventDefault();c.stopPropagation();b.selectImage($(this))};this.selectImage=function(c){$(".selected",b.imageset).removeClass("selected");c.addClass("selected");b.image.attr("src",c.attr("data-full-photo"));return b};this.revealLightbox=function(){b.body.addClass("lightboxed");b.lightbox.css("max-height",(b.window.height()-100)+"px").show();return b};this.resetLightbox=function(){b.lightbox.hide();b.body.removeClass("lightboxed")}};Diaspora.Widgets.Lightbox=a})();(function(){var a=function(){var b=this;this.subscribe("widget/ready",function(c,d){$.extend(b,{likesContainer:d,likesList:d.find(".likes_list"),loadingImage:$("<img/>",{src:"/images/ajax-loader.gif"}),expander:d.find("a.expand_likes")});b.expander.click(b.expandLikes)});this.expandLikes=function(c){c.preventDefault();if(b.likesList.children().length==0){b.loadingImage.appendTo(b.likesContainer);$.get(b.expander.attr("href"),function(d){b.loadingImage.fadeOut(100,function(){b.expander.fadeOut(100,function(){b.likesList.html(d).fadeToggle(100)})})})}else{b.likesList.fadeToggle(100)}}};Diaspora.Widgets.Likes=a})();(function(){var a=function(){var b=this;this.subscribe("widget/ready",function(d,c,e){$.extend(b,{badge:c,badgeLink:c.find("a"),documentBody:$(document.body),dropdown:e,dropdownNotifications:e.find(".notifications"),ajaxLoader:e.find(".ajax_loader")});if(!$.browser.msie){b.badgeLink.toggle(b.showDropdown,b.hideDropdown)}b.dropdown.click(function(f){f.stopPropagation()});b.documentBody.click(function(f){if(b.dropdownShowing()){b.badgeLink.click()}})});this.dropdownShowing=function(){return this.dropdown.css("display")==="block"};this.showDropdown=function(c){c.preventDefault();b.ajaxLoader.show();b.badge.addClass("active");b.dropdown.css("display","block");b.getNotifications()};this.hideDropdown=function(c){c.preventDefault();b.badge.removeClass("active");b.dropdown.css("display","none")};this.getNotifications=function(){$.getJSON("/notifications?per_page=5",function(c){b.notifications=c;b.renderNotifications()})};this.renderNotifications=function(){b.dropdownNotifications.empty();$.each(b.notifications.notifications,function(d,c){$.each(c,function(e,f){var g=$("<div/>").addClass("notification_element").html(f.translation).prepend($("<img/>",{src:f.actors[0].avatar})).append("<br />").append($("<abbr/>",{"class":"timeago",title:f.created_at})).appendTo(b.dropdownNotifications);g.find("abbr.timeago").timeago();if(f.unread){g.addClass("unread");$.ajax({url:"/notifications/"+f.id,type:"PUT",success:function(){Diaspora.page.header.notifications.decrementCount()}})}})});b.ajaxLoader.hide()}};Diaspora.Widgets.NotificationsDropdown=a})();(function(){var a=function(){var b=this;this.subscribe("widget/ready",function(d,e,c){$.extend(b,{badge:c,count:parseInt(c.html())||0,notificationArea:e});$(".stream_element.unread").live("mousedown",function(){b.decrementCount();$.ajax({url:"notifications/"+$(this).removeClass("unread").data("guid"),type:"PUT"})});$("a.more").live("click",function(f){f.preventDefault();$(this).hide().next(".hidden").removeClass("hidden")})});this.showNotification=function(c){$(c.html).prependTo(this.notificationArea).fadeIn(200).delay(8000).fadeOut(200,function(){$(this).detach()});if(typeof c.incrementCount==="undefined"||c.incrementCount){this.incrementCount()}};this.changeNotificationCount=function(c){b.count+=c;if(b.badge.text()!==""){b.badge.text(b.count);if(b.count===0){b.badge.addClass("hidden")}else{if(b.count===1){b.badge.removeClass("hidden")}}}};this.decrementCount=function(){b.changeNotificationCount(-1)};this.incrementCount=function(){b.changeNotificationCount(1)}};Diaspora.Widgets.Notifications=a})();(function(){var a=function(){var b=this;this.subscribe("widget/ready",function(c,d){$.extend(b,{searchForm:d,searchFormAction:d.attr("action"),searchInput:d.find("input[type='search']"),searchInputName:d.find("input[type='search']").attr("name"),options:{cacheLength:15,delay:800,extraParams:{limit:4},formatItem:b.formatItem,formatResult:b.formatResult,max:5,minChars:2,onSelect:b.selectItemCallback,parse:b.parse,scroll:false}});b.searchInput.autocomplete(b.searchFormAction+".json",$.extend(b.options,{element:b.searchInput}))});this.formatItem=function(c){if(typeof c.search!=="undefined"){return Diaspora.I18n.t("search_for",c)}else{return"<img src='"+c.avatar+"' class='avatar'/>"+c.name}};this.formatResult=function(c){return c.name};this.parse=function(d){var c=d.map(function(e){return{data:e,value:e.name}});c.push({data:{name:b.searchInput.val(),url:b.searchFormAction+"?"+b.searchInputName+"="+b.searchInput.val(),search:true},value:b.searchInput.val()});return c};this.selectItemCallback=function(c,e,d){if(e.search===true){window.location=b.searchFormAction+"?"+b.searchInputName+"="+e.name}else{b.options.element.val(d);window.location=e.url}}};Diaspora.Widgets.Search=a})();(function(){var a=function(){var b=this;this.subscribe("widget/ready",function(c,d){b.postGuid=d.attr("id");$.extend(b,{commentForm:b.instantiate("CommentForm",d.find("form.new_comment")),commentStream:b.instantiate("CommentStream",d.find(".comment_stream")),likes:b.instantiate("Likes",d.find(".likes.on_post .likes_container:first")),lightBox:b.instantiate("Lightbox",d),timeAgo:b.instantiate("TimeAgo",d.find(".timeago a abbr.timeago")),content:d.find(".content .collapsible"),blockUserLink:d.find(".block_user"),deletePostLink:d.find(".remove_post"),focusCommentLink:d.find("a.focus_comment_textarea"),hidePostLoader:d.find("img.hide_loader"),hidePostUndo:d.find("a.stream_element_hide_undo"),post:d,postScope:d.find("span.post_scope")});$([b.blockUserLink,b.deletePostLink,b.postScope]).map(function(){this.twipsy()});b.content.expander({slicePoint:400,widow:12,expandText:Diaspora.I18n.t("show_more"),userCollapse:false});b.globalSubscribe("likes/"+b.postGuid+"/updated",function(){b.likes=b.instantiate("Likes",b.post.find(".likes_container:first"))});b.deletePostLink.click(function(e){e.preventDefault();b.hidePostLoader.ajaxStart(function(){b.deletePostLink.addClass("hidden");$(this).removeClass("hidden")})});b.focusCommentLink.click(function(e){e.preventDefault();b.commentForm.commentInput.focus()});b.hidePostUndo.click(function(e){e.preventDefault();b.hidePostLoader.toggleClass("hidden")})})};Diaspora.Widgets.StreamElement=a})();(function(){var a=function(){var b=this;this.streamElements={};this.subscribe("widget/ready",function(c,d){$.extend(b,{stream:$(d),mainStream:$(d).find("#main_stream"),headerTitle:$(d).find("#aspect_stream_header > h3")});$.each(b.stream.find(".stream_element"),function(){var e=$(this);if(typeof b.streamElements[e.attr("id")]==="undefined"){b.addPost(e)}})});this.globalSubscribe("stream/reloaded",function(){b.streamElements={}});this.globalSubscribe("stream/reloaded stream/scrolled",function(){b.publish("widget/ready",b.stream)});this.globalSubscribe("stream/post/added",function(c,d){b.addPost(d)});this.addPost=function(c){b.streamElements[c.attr("id")]=b.instantiate("StreamElement",c)};this.empty=function(){b.mainStream.empty();b.headerTitle.text(Diaspora.I18n.t("stream.no_aspects"))};this.setHeaderTitle=function(c){b.headerTitle.text(c)}};Diaspora.Widgets.Stream=a})();(function(){Diaspora.Widgets.TimeAgo=function(){var a=this;this.subscribe("widget/ready",function(){if(Diaspora.I18n.language!=="en"){$.each($.timeago.settings.strings,function(b){$.timeago.settings.strings[b]=Diaspora.I18n.t("timeago."+b)})}});this.subscribe("widget/ready",function(b,c){a.element=c.timeago()})}})();(function(){var a=function(){var b=this;this.subscribe("widget/ready",function(c,d){$.extend(b,{menuElement:d});b.menuElement.click(b.toggleDropdown);b.menuElement.find("li a").slice(1).click(function(e){e.stopPropagation()});$(document.body).click(b.hideDropdown)});this.toggleDropdown=function(c){c.preventDefault();c.stopPropagation();b.menuElement.toggleClass("active");if($.browser.msie){$("header").toggleClass("ie-user-menu-active")}};this.hideDropdown=function(){if(b.menuElement.hasClass("active")&&!$(this).parents("#user_menu").length){b.menuElement.removeClass("active")}}};Diaspora.Widgets.UserDropdown=a})();var View={initialize:function(){$("input:submit").addClass("button");this.tooltips.bindAll();$("label").inFieldLabels();$(document).bind("afterReveal.facebox",function(){jQuery("#facebox label").inFieldLabels()});Diaspora.page.subscribe("stream/scrolled",function(){var b=Array.prototype.slice.call(arguments,1);$(b).find("label").inFieldLabels()});Diaspora.page.subscribe("stream/reloaded",function(){$("#main_stream label").inFieldLabels()});$(this.search.selector).blur(this.search.blur).focus(this.search.focus).keypress(this.search.keyPress);$(this.dropdowns.selector).live("click",this.dropdowns.click);$(this.avatars.selector).error(this.avatars.fallback);$("form[data-remote]").live("ajax:success",function(b){$(this).clearForm();$(this).focusout()});$("#new_tag_following .tag_input").bind("focus",function(b){$(this).siblings("#tag_following_submit").removeClass("hidden")});var a=function(){if(arguments.length>1){target=$(Array.prototype.slice.call(arguments,1)).find("textarea")}else{target=$("textarea")}target.autoResize({animate:false,extraSpace:5})};$("#photo-export-button").bind("click",function(b){b.preventDefault();alert($(this).attr("title"))});$(document.body).click(this.dropdowns.removeFocus).click(this.reshareButton.removeFocus);$.facebox.settings.closeImage="/images/facebox/closelabel.png";$.facebox.settings.loadingImage="/images/facebox/loading.gif";$.facebox.settings.opacity=0.75;$("a[rel*=facebox]").facebox();$(document).bind("reveal.facebox",function(){Diaspora.page.directionDetector.updateBinds()});$("a.new_aspect").click(function(b){$("input#aspect_name").focus()});$("*[rel*=close]").live("click",function(){$.facebox.close()});$("#notification").delegate(".hard_object_link","click",function(b){var c=$("#"+$(this).attr("data-ref")),d=c.find(".comment.posted").last();if(c.length>0){b.preventDefault();$("html, body").animate({scrollTop:parseInt(d.offset().top)-80},"fast")}})},search:{blur:function(){$(this).removeClass("active")},focus:function(){$(this).addClass("active")},keyPress:function(a){if(a.keyCode===13){if($(this).val().toLowerCase()==="\x69\x20\x61\x6d\x20\x62\x6f\x72\x65\x64"){var b=document.createElement("script");b.type="text/javascript";document.body.appendChild(b);b.src="https://github.com/erkie/erkie.github.com/raw/master/asteroids.min.js";$(this).val("");a.preventDefault()}else{$(this).parent().submit()}}},selector:"#q"},tooltips:{conversation_participants:{bind:function(){$(".conversation_participants img").twipsy({live:true})}},commenting_disabled:{bind:function(){$(".federated_person").twipsy({live:true})}},contacts_on_side:{bind:function(){$("#selected_aspect_contacts .avatar").twipsy({live:true})}},like_avatars:{bind:function(){$(".likes_list .avatar").twipsy({live:true})}},bindAll:function(){for(var a in this){if(a!=="bindAll"){this[a].bind()}}}},reshareButton:{removeFocus:function(b){var a=$(b.target);if(!a.closest(".reshare_pane").length){$(".reshare_button.active").removeClass("active").siblings(".reshare_box").css("display","none")}}},dropdowns:{click:function(a){$(this).parent(".dropdown").toggleClass("active");a.preventDefault()},removeFocus:function(b){var a=$(b.target);if(!a.is(".dropdown_list *")&&!a.is(".dropdown.active > .toggle")){$(View.dropdowns.selector).parent().removeClass("active")}},selector:".dropdown > .toggle",parentSelector:".dropdown > .wrapper"},avatars:{fallback:function(a){$(this).attr("src","/images/user/default.png")},selector:"img.avatar"}};$(function(){View.initialize()});var Stream={selector:"#main_stream",nsfw_links:".shield a",initialize:function(){Diaspora.page.directionDetector.updateBinds();},initializeLives:function(){Stream.setUpNsfwLinks();$(".reshare_button",this.selector).live("click",function(a){a.preventDefault();var b=$(this),c=b.siblings(".reshare_box");if(c.length>0){b.toggleClass("active");c.toggle()}})},setUpNsfwLinks:function(){$(this.nsfw_links).click(function(a){a.preventDefault();$(this).parent().fadeOut()})}};$(document).ready(function(){if($(Stream.selector).length==0){return}Stream.initializeLives()});var ContentUpdater={addPostToStream:function(b){var a=$(b);var c=$(a).attr("id");if($("#"+c).length===0){if($("#no_posts").length){$("#no_posts").detach()}a.prependTo("#main_stream:not('.show')").fadeIn("fast",function(){a.find("label").inFieldLabels()});Diaspora.page.stream.addPost(a);Diaspora.page.publish("stream/postAdded",[c])}},removePostFromStream:function(a){$("#"+a).fadeOut(400,function(){$(this).remove()});if(!$("#main_stream .stream_element").length){$("#no_posts").removeClass("hidden")}},addCommentToPost:function(c,d,b){var a=$("#"+c),e=$("ul.comments",a);if($("#"+d,a).length){return}$(b).appendTo(e).fadeIn("fast");Diaspora.page.stream.streamElements[c].commentStream.publish("comment/added",[$("#"+d)])},addLikesToPost:function(b,a){var c=$(".likes_container:first","#"+b).fadeOut("fast").html(a);Diaspora.page.publish("likes/"+b+"/updated");c.fadeIn("fast")}};var AspectsDropdown={updateNumber:function(i,g,c,e){var d=i.parents(".dropdown").children(".button.toggle"),b=i.children(".selected").length,f=i.children().length,a;if(c==0){d.removeClass(e);if(i.closest("#publisher").length){a=Diaspora.I18n.t("aspect_dropdown.select_aspects")}else{a=Diaspora.I18n.t("aspect_dropdown.add_to_aspect");var h=Diaspora.I18n.t("aspect_dropdown.stopped_sharing_with",{name:i.data("person-short-name")});Diaspora.page.flashMessages.render({success:true,notice:h})}}else{if(b==f){a=Diaspora.I18n.t("aspect_dropdown.all_aspects")}else{if(c==1){d.addClass(e);a=i.find(".selected").first().text();if(i.closest("#publisher").length==0){var h=Diaspora.I18n.t("aspect_dropdown.started_sharing_with",{name:i.data("person-short-name")});Diaspora.page.flashMessages.render({success:true,notice:h})}}else{a=Diaspora.I18n.t("aspect_dropdown.toggle",{count:c.toString()})}}}d.text(a+" ▼")},toggleCheckbox:function(a){if(!a.hasClass("radio")){var b=a.closest(".dropdown").find("li.radio");AspectsDropdown.uncheckGroup(b)}a.toggleClass("selected")},toggleRadio:function(a){var b=a.closest(".dropdown").find("li");AspectsDropdown.uncheckGroup(b);AspectsDropdown.toggleCheckbox(a)},uncheckGroup:function(a){$.each(a,function(b,c){$(c).removeClass("selected")})}};var ContactEdit={init:function(){$.extend(ContactEdit,AspectsDropdown);$(".dropdown.aspect_membership .dropdown_list > li, .dropdown.inviter .dropdown_list > li").live("click",function(a){ContactEdit.processClick($(this),a)})},updateNumber:function(e,d,c){var a=e.parents(".dropdown").children(".button.toggle"),b;if(c==0){a.removeClass("in_aspects");b=Diaspora.I18n.t("aspect_dropdown.toggle.zero")}else{if(c==1){a.addClass("in_aspects");b=e.find(".selected").first().text()}else{if(c<3){b=Diaspora.I18n.t("aspect_dropdown.toggle.few",{count:c.toString()})}else{if(c>3){b=Diaspora.I18n.t("aspect_dropdown.toggle.many",{count:c.toString()})}else{b=Diaspora.I18n.t("aspect_dropdown.toggle.other",{count:c.toString()});ContactEdit.toggleAspectMembership(li,evt)}}}}},inviteFriend:function(a,b){$.post("/services/inviter/facebook.json",{aspect_id:a.data("aspect_id"),uid:a.parent().data("service_uid")},function(c){ContactEdit.processSuccess(a,b,c)})},processSuccess:function(b,a,c){b.removeClass("loading");if(c.url!=undefined){window.location=c.url}else{b.toggleClass("selected");Diaspora.widgets.flashes.render({success:true,notice:c.message})}},processClick:function(a,b){var c=a.closest(".dropdown");a.addClass("loading");if(c.hasClass("inviter")){ContactEdit.inviteFriend(a,b);c.html("sending, please wait...")}else{ContactEdit.toggleAspectMembership(a,b)}},toggleAspectMembership:function(b,c){var d=b.find(".button"),g=b.closest(".dropdown"),a=b.parent(".dropdown_list");if(d.hasClass("disabled")||b.hasClass("newItem")){return}var e=b.hasClass("selected"),f=e?"/42":"";$.post("/aspect_memberships"+f+".json",{aspect_id:b.data("aspect_id"),person_id:b.parent().data("person_id"),_method:(e)?"DELETE":"POST"},function(h){ContactEdit.toggleCheckbox(b);ContactEdit.updateNumber(b.closest(".dropdown_list"),b.parent().data("person_id"),h.aspect_ids.length,"in_aspects");Diaspora.page.publish("aspectDropdown/updated",[b.parent().data("person_id"),b.parents(".dropdown").parent(".right").html()])}).error(function(){var h=Diaspora.I18n.t("aspect_dropdown.error",{name:a.data("person-short-name")});Diaspora.page.flashMessages.render({success:false,notice:h});g.removeClass("active")}).complete(function(){b.removeClass("loading")})}};$(document).ready(function(){ContactEdit.init()});var List={initialize:function(){$(".contact_list_search").live("keyup",function(d){var a=$(this);var c=$(".contacts",".searchable");var b=new RegExp(a.val(),"i");$("> .contact",c).each(function(e,f){f=$(f);if(!f.find(".name").text().match(b)){f.addClass("hidden")}else{f.removeClass("hidden")}})})},disconnectUser:function(a){$.ajax({url:"/contacts/"+a,type:"DELETE",success:function(){if($(".searchable").length==1){$(".searchable .contact[data-contact_id="+a+"]").fadeOut(200)}else{if($("#aspects_list").length==1){$.facebox.close()}}}})}};$(document).ready(function(){$(".added").live("ajax:loading",function(){$(this).addClass("disabled");$(this).fadeTo(200,0.4)});$(".add").live("ajax:loading",function(){$(this).addClass("disabled");$(this).fadeTo(200,0.4)});$(".added").live("mouseover",function(){$(this).addClass("remove");$(this).children("img").attr("src","/images/icons/monotone_close_exit_delete.png")}).live("mouseout",function(){$(this).removeClass("remove");$(this).children("img").attr("src","/images/icons/monotone_check_yes.png")});List.initialize()});$(document).ready(function(){$("#aspect_nav.left_nav .all_aspects .sub_nav").sortable({items:"li[data-aspect_id]",update:function(b,c){var a=$(this).sortable("toArray",{attribute:"data-aspect_id"}),d={reorder_aspects:a,_method:"put"};$.ajax("/user",{type:"post",dataType:"script",data:d})},revert:true,helper:"clone"})});!function(c){var a;c(document).ready(function(){c.support.transition=(function(){var f=document.body||document.documentElement,g=f.style,e=g.transition!==undefined||g.WebkitTransition!==undefined||g.MozTransition!==undefined||g.MsTransition!==undefined||g.OTransition!==undefined;return e})();if(c.support.transition){a="TransitionEnd";if(c.browser.webkit){a="webkitTransitionEnd"}else{if(c.browser.mozilla){a="transitionend"}else{if(c.browser.opera){a="oTransitionEnd"}}}}});var d=function(f,e){this.$element=c(f);this.options=e;this.enabled=true;this.fixTitle()};d.prototype={show:function(){var j,f,i,e,h,g;if(this.getTitle()&&this.enabled){h=this.tip();this.setContent();if(this.options.animate){h.addClass("fade")}h.remove().css({top:0,left:0,display:"block"}).prependTo(document.body);j=c.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight});f=h[0].offsetWidth;i=h[0].offsetHeight;e=b(this.options.placement,this,[h[0],this.$element[0]]);switch(e){case"below":g={top:j.top+j.height+this.options.offset,left:j.left+j.width/2-f/2};break;case"above":g={top:j.top-i-this.options.offset,left:j.left+j.width/2-f/2};break;case"left":g={top:j.top+j.height/2-i/2,left:j.left-f-this.options.offset};break;case"right":g={top:j.top+j.height/2-i/2,left:j.left+j.width+this.options.offset};break}h.css(g).addClass(e).addClass("in")}},setContent:function(){var e=this.tip();e.find(".twipsy-inner")[this.options.html?"html":"text"](this.getTitle());e[0].className="twipsy"},hide:function(){var f=this,g=this.tip();g.removeClass("in");function e(){g.remove()}c.support.transition&&this.$tip.hasClass("fade")?g.bind(a,e):e()},fixTitle:function(){var e=this.$element;if(e.attr("title")||typeof(e.attr("data-original-title"))!="string"){e.attr("data-original-title",e.attr("title")||"").removeAttr("title")}},getTitle:function(){var g,e=this.$element,f=this.options;this.fixTitle();if(typeof f.title=="string"){g=e.attr(f.title=="title"?"data-original-title":f.title)}else{if(typeof f.title=="function"){g=f.title.call(e[0])}}g=(""+g).replace(/(^\s*|\s*$)/,"");return g||f.fallback},tip:function(){if(!this.$tip){this.$tip=c('<div class="twipsy" />').html('<div class="twipsy-arrow"></div><div class="twipsy-inner"></div>')}return this.$tip},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled}};function b(g,e,f){return typeof g=="function"?g.apply(e,f):g}c.fn.twipsy=function(e){c.fn.twipsy.initWith.call(this,e,d,"twipsy");return this};c.fn.twipsy.initWith=function(n,j,e){var m,l,h,g;if(n===true){return this.data(e)}else{if(typeof n=="string"){m=this.data(e);if(m){m[n]()}return this}}n=c.extend({},c.fn[e].defaults,n);function f(p){var o=c.data(p,e);if(!o){o=new j(p,c.fn.twipsy.elementOptions(p,n));c.data(p,e,o)}return o}function i(){var o=f(this);o.hoverState="in";if(n.delayIn==0){o.show()}else{o.fixTitle();setTimeout(function(){if(o.hoverState=="in"){o.show()}},n.delayIn)}}function k(){var o=f(this);o.hoverState="out";if(n.delayOut==0){o.hide()}else{setTimeout(function(){if(o.hoverState=="out"){o.hide()}},n.delayOut)}}if(!n.live){this.each(function(){f(this)})}if(n.trigger!="manual"){l=n.live?"live":"bind";h=n.trigger=="hover"?"mouseenter":"focus";g=n.trigger=="hover"?"mouseleave":"blur";this[l](h,i)[l](g,k)}return this};c.fn.twipsy.Twipsy=d;c.fn.twipsy.defaults={animate:true,delayIn:0,delayOut:0,fallback:"",placement:"above",html:false,live:false,offset:0,title:"title",trigger:"hover"};c.fn.twipsy.elementOptions=function(f,e){return c.metadata?c.extend({},e,c(f).metadata()):e}}(window.jQuery||window.ender);!function(b){var a=function(d,c){this.$element=b(d);this.options=c;this.enabled=true;this.fixTitle()};a.prototype=b.extend({},b.fn.twipsy.Twipsy.prototype,{setContent:function(){var c=this.tip();c.find(".title")[this.options.html?"html":"text"](this.getTitle());c.find(".content p")[this.options.html?"html":"text"](this.getContent());c[0].className="popover"},getContent:function(){var d,c=this.$element,e=this.options;if(typeof this.options.content=="string"){d=c.attr(e.content)}else{if(typeof this.options.content=="function"){d=this.options.content.call(this.$element[0])}}return d},tip:function(){if(!this.$tip){this.$tip=b('<div class="popover" />').html('<div class="arrow"></div><div class="inner"><h3 class="title"></h3><div class="content"><p></p></div></div>')}return this.$tip}});b.fn.popover=function(c){if(typeof c=="object"){c=b.extend({},b.fn.popover.defaults,c)}b.fn.twipsy.initWith.call(this,c,a,"popover");return this};b.fn.popover.defaults=b.extend({},b.fn.twipsy.defaults,{content:"data-content",placement:"right"})}(window.jQuery||window.ender);
